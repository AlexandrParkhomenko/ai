<html><head>
<!-- This page was generated by CAT-SOOP 14.0.0.dev144.  miau. -->
<meta charset="utf-8">
<title>6.036 Spring 2019</title>
<link href="data:image/gif;base64,R0lGODlhEAAQAKEAAAAAAAAzZv///wAAACH5BAEKAAMALAAAAAAQABAAAAIynI85oL3A3IFARFehlcvW3XyaR5XiJ6Tqmo6sOsZoS2viets0XJ+vzCoFXS8Yw4SkDAoAOw==" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/themes/base.css" rel="stylesheet" type="text/css">
<!-- librejs compatibility -->
<script>
    /*
    @licstart  The following is the entire license notice for the JavaScript
    code in this page.

    The Javascript on this page is part of CAT-SOOP
    Copyright (C) 2011-2019 by The CAT-SOOP Developers <catsoop-dev@mit.edu>

    The Javascript code on this page is free software: you can redistribute it
    and/or modify it under the terms of the GNU Affero General Public License
    as published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.  This code is distributed
    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE.  See the full text of the license for
    more details (https://www.gnu.org/licenses/agpl-3.0.en.html).

    As additional permission under GNU AGPL version 3 section 7, you may
    distribute non-source (e.g., minimized or compacted) forms of that code
    without the copy of the GNU AGPL normally required by section 4, provided
    you include this license notice and a URL through which recipients can
    access the Corresponding Source.

    @licend  The above is the entire license notice for the JavaScript code in
    this page.
    */
    </script>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    document.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });
    </script>
<!-- load in katex and mathjax, and CAT-SOOP-specific math rendering  -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css">
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/mathjax/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/cs_math.js" type="text/javascript"></script>
<!-- Syntax Highlighting -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/highlight/cs_highlight.pack.min.js" type="text/javascript"></script>
<script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
<style>
      :root {
        --cs-base-bg-color: #00bfff;
        --cs-light-bg-color: #32cbff;
        --cs-base-font-color: #ffffff;
        --cs-light-font-color: #000;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.3/iframeResizer.contentWindow.min.js" type="text/javascript"></script><link href="/queue/fall18/css/queue.css" rel="stylesheet">
<!--JS for questions-->
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script>
<meta content="width=device-width, initial-scale=1" name="viewport">
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/mode-python.js"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body style="margin: 0px;">
<header id="cs_header" style="display: none;">
<div class="nav-container">
<div class="cs_header_text"><a href="https://introml_oll.odl.mit.edu/cat-soop/6.036"></a></div>
<a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<center><h1></h1></center>
<p>In this homework, we will explore training methods for neural networks. A code and data folder that will be useful for doing this homework can be found <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/code_for_hw8.zip"><strong>here</strong></a>. </p>
<p>Note that problem 2 (OPTIONAL) has you extend your homework 7 framework for building neural networks. The code for this problem is included in the file <code>code_for_hw8_oop.py</code> and you have to copy in your implementation from homework 7 to complement it. </p>
<p>For the rest of the problems (3-5), we will start using "state of the art" tools (Keras and Tensorflow) for building neural network models, as they are computationally efficient and allow us to easily and rapidly build models of varying complexity. The code for these problems is in the file <code>code_for_hw8_keras.py</code>. </p>
<p>Alternatively, you can use the <a href="https://colab.research.google.com/drive/1ZPA1lCA45rzIHR0OqTXiOiSxPN_6vDgD"><strong>colab notebook</strong></a> which contains the code for all the problems in the same notebook. (If clicking on the link opens a grey window, try opening it in a new tab.)</p>
<a class="anchor" name="catsoop_section_1"></a><h2>1) Batch Normalization</h2>
<p>Batch normalization is discussed in the <a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week7/neural_networks_2/2">lecture notes</a> as a good way of doing regularization in large networks. The authors of the <a href="http:///arxiv.org/abs/1502.03167">paper</a> that proposed the batch normalization technique argued that it mitigates the effects of the internal covariate shift issue, which is also discussed in the notes. We encourage you to read that section of the notes before attempting the problem. </p>
<p>Let notation <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">W^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> indicate the matrix of weights at the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer of our neural network. The <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer takes in <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^{l-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> activations from the previous layer and produces <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> outputs. In this problem, we will always use mini-batch gradient descent during training, with a mini-batch size of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span>. </p>
<p>We now investigate the internal covariate shift problem and how batch normalization generally helps train neural network models. </p>
<p><b>1A)</b> Based on your reading of the lecture notes, choose the true statements about the internal covariate shift issue and the concept of batch normalization:

<!--START question q000000 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000000" style="position: static">
<div id="q000000_rendered_question">
Mark all that are True. <table border="0">
<tbody><tr><td align="center"><input name="q000000_opt0" type="checkbox" value="0"></td><td>(1) The internal covariate shift problem can arise at the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer of a neural network, due to the changing weights in the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer.</td></tr>
<tr><td align="center"><input name="q000000_opt1" type="checkbox" value="1"></td><td>(2) The first layer of neurons experiences the the worst internal covariate shift out of all layers, because backpropagation occurs all the way from the final to the first layer.</td></tr>
<tr><td align="center"><input checked="" name="q000000_opt2" type="checkbox" value="2"></td><td>(3) Batch normalization can help prevent outputs of neurons from becoming extremely large or extremely small</td></tr>
<tr><td align="center"><input checked="" name="q000000_opt3" type="checkbox" value="3"></td><td>(4) Batch normalization can be particularly helpful when we are using sigmoid units in the hidden layers.</td></tr>
</tbody></table><input id="q000000" name="q000000" type="hidden" value="{&quot;q000000_opt2&quot;:true,&quot;q000000_opt3&quot;:true}">
<script type="text/javascript">
var q000000_selected = {'q000000_opt2': true,'q000000_opt3': true};
document.getElementById("q000000").value = JSON.stringify(q000000_selected);
document.querySelectorAll("input[type=checkbox][name^=q000000_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000000_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000000").value = JSON.stringify(q000000_selected);
    });
});
</script>
</div><div>
<span id="q000000_buttons">
<button class="submit btn btn-catsoop" id="q000000_submit" onclick="catsoop.submit('q000000');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000000_viewanswer" onclick="catsoop.viewanswer('q000000');" style="margin-top: 10px;">View Answer</button></span><span id="q000000_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000000_loading_wrapper">
<span id="q000000_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000000_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000000_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000000_solution_container">
<div id="q000000_solution">
</div>
<div id="q000000_solution_explanation">
</div>
</div>
<div id="q000000_message">
<script type="text/javascript">document.getElementById("q000000_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000000 -->
<p><b>1B)</b> We now investigate techniques we might use to better train our neural networks, including potentially getting rid of the internal covariate shift issue.
<!--START question q000001 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
Mark all that are True. <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000001_opt0" type="checkbox" value="0"></td><td>Technique 1. Internal covariate shift is no longer a problem if we optimize the weights of our neural network layer by layer, starting from the input layer, and going all the way to the output layer. When updating weights of a layer, all other weights are kept fixed.</td></tr>
<tr><td align="center"><input name="q000001_opt1" type="checkbox" value="1"></td><td>Technique 2. If technique 1 did not take a lot of time, we would have always used it, because it eliminates internal covariate shift and therefore guarantees that our network will perform well.</td></tr>
<tr><td align="center"><input name="q000001_opt2" type="checkbox" value="2"></td><td>Technique 3. It would help in training a neural network if we took <em>all</em> <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^{l-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> x <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span> inputs going to to the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer, find the mean and variance of this whole set of scalars and normalize them. We could do the same for all layers of the network.</td></tr>
<tr><td align="center"><input name="q000001_opt3" type="checkbox" value="3"></td><td>Technique 4. It would help in training a neural network if we took <em>all</em> <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span> inputs going to the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer through <em>one</em> of the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^{l-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> input connections, find the mean and variance of this set of scalars and normalize them. We could then do the same for all input connections of all layers of the network.</td></tr>
</tbody></table><input id="q000001" name="q000001" type="hidden" value="{&quot;q000001_opt0&quot;:true}">
<script type="text/javascript">
var q000001_selected = {'q000001_opt0': true};
document.getElementById("q000001").value = JSON.stringify(q000001_selected);
document.querySelectorAll("input[type=checkbox][name^=q000001_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000001_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000001").value = JSON.stringify(q000001_selected);
    });
});
</script>
</div><div>
<span id="q000001_buttons">
<button class="submit btn btn-catsoop" id="q000001_submit" onclick="catsoop.submit('q000001');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000001_viewanswer" onclick="catsoop.viewanswer('q000001');" style="margin-top: 10px;">View Answer</button></span><span id="q000001_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000001_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message">
<script type="text/javascript">document.getElementById("q000001_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000001 -->
<p>For the following questions, we will present some results obtained using neural networks built from our modular framework that we implemented in homework 7. We will analyze those results to draw conclusions later. Any one of our models is trained and tested on the MNIST training and validation data sets. <a href="http://yann.lecun.com/exdb/mnist/">MNIST</a> is a very well-studied  data set of 28x28 images of isolated digits (0-9), each pixel value in the range 0-255.  There are 60,000 training images and 10,000 validation images. Our networks will take an image as input and try to predict the corresponding digit. Our results are obtained using only images of digits <code>0</code> and <code>1</code>. Later in problem 5, we will look at the complete MNIST problem and we will try to achieve close to state-of-the-art performance on the whole data set.</p>
<p>We use the following core neural network in this problem (using our implementation of modules from homework 7):
<br> <code>nn_core = Sequential([Linear(A, 32), ReLU(), Linear(32, 4), ReLU(), Linear(4,B), ReLU(), SoftMax()], NLL())</code></p>
<p><b>1C)</b> Choose the values of <code>A</code> and <code>B</code> that yield a neural network model with an appropriate number of inputs and outputs for the task at hand, based on the description given above.
<!--START question q000002 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
Enter a python list of 2 values: [A, B]: <input id="q000002" name="q000002" size="50" type="text" value="[784,2]">
</div><div>
<span id="q000002_buttons">
<button class="submit btn btn-catsoop" id="q000002_submit" onclick="catsoop.submit('q000002');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000002_viewanswer" onclick="catsoop.viewanswer('q000002');" style="margin-top: 10px;">View Answer</button></span><span id="q000002_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000002_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message">
<script type="text/javascript">document.getElementById("q000002_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000002 -->
<p><br>In the table below, we summarize the results of some experiments which we already ran for you. We specify our models used, which are <code>nn_core</code> instances, or slight modifications of those, which include batch normalization layers <code>BatchNorm</code>:</p>
<p><code>nn_bn_1 = Sequential([Linear(A, 32), BatchNorm(32), ReLU(), Linear(32, 4), BatchNorm(4), ReLU(), Linear(4,B), ReLU(), SoftMax()], NLL())</code></p>
<p><code>nn_bn_2 = Sequential([Linear(A, 32), ReLU(), BatchNorm(32), Linear(32, 4), ReLU(), BatchNorm(4), Linear(4,B), ReLU(), SoftMax()], NLL())</code></p>
<p>Note that in the notation above, <code>BatchNorm(k)</code> indicates a batch normalization layer with <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span></span> input connections <em>into</em> the <code>BatchNorm</code> module, and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span></span> output connections to the next module in the Sequential object. <b>If you are interested in implementing batch normalization for the modular framework that we have been developing since homework 7, you can attempt problem 2 which is optional</b>.</p>
<p>We also specify our chosen learning rates in the table. All experiments were done using mini-batch gradient descent during training and the number of number of iterations of backpropagation used was <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>400</mn></mrow><annotation encoding="application/x-tex">400</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span>. The last column gives the accuracies obtained by our models at test time, when evaluated on the MNIST validation set. Based on our discussion in 1A), <a href="https://stackoverflow.com/questions/4359959/overflow-in-exp-in-scipy-numpy-in-python">overflow/undeflow</a> are potential issues we may face if the weights or outputs of our neural networks become too big/small inside numpy arrays. This would prevent us from getting any test accuracy and in those cases, we simply report '--' as the obtained accuracy.</p>
<table style="margin-left:auto; margin-right:auto;">
<tbody><tr>
<th style="text-align: center">#</th>
<th style="text-align: center">Model used</th>
<th style="text-align: center">Learning rate</th>
<th style="text-align: center">Test accuracy</th>
</tr>
<tr>
<td style="text-align: center">1</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #FFAFAF; text-align: center">1e-8</td>
<td style="text-align: center">0.593</td>
</tr>
<tr>
<td style="text-align: center">2</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #FFAFAF; text-align: center">1e-8</td>
<td style="text-align: center">0.401</td>
</tr>
<tr>
<td style="text-align: center">3</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #FFAFAF; text-align: center">1e-8</td>
<td style="text-align: center">0.423</td>
</tr>
<tr>
<td style="text-align: center">4</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #99FFFF; text-align: center">1e-7</td>
<td style="text-align: center">0.623</td>
</tr>
<tr>
<td style="text-align: center">5</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #99FFFF; text-align: center">1e-7</td>
<td style="text-align: center">0.415</td>
</tr>
<tr>
<td style="text-align: center">6</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #99FFFF; text-align: center">1e-7</td>
<td style="text-align: center">0.434</td>
</tr>
<tr>
<td style="text-align: center">7</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #B2FF66; text-align: center">1e-6</td>
<td style="text-align: center">0.420</td>
</tr>
<tr>
<td style="text-align: center">8</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #B2FF66; text-align: center">1e-6</td>
<td style="text-align: center">0.502</td>
</tr>
<tr>
<td style="text-align: center">9</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #B2FF66; text-align: center">1e-6</td>
<td style="text-align: center">0.531</td>
</tr>
<tr>
<td style="text-align: center">10</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #E5CCFF; text-align: center">1e-5</td>
<td style="text-align: center">--</td>
</tr>
<tr>
<td style="text-align: center">11</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #E5CCFF; text-align: center">1e-5</td>
<td style="text-align: center">0.651</td>
</tr>
<tr>
<td style="text-align: center">12</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #E5CCFF; text-align: center">1e-5</td>
<td style="text-align: center">0.784</td>
</tr>
<tr>
<td style="text-align: center">13</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #FFCC99; text-align: center">1e-4</td>
<td style="text-align: center">--</td>
</tr>
<tr>
<td style="text-align: center">14</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #FFCC99; text-align: center">1e-4</td>
<td style="text-align: center">--</td>
</tr>
<tr>
<td style="text-align: center">15</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #FFCC99; text-align: center">1e-4</td>
<td style="text-align: center">0.997</td>
</tr>
<tr>
<td style="text-align: center">16</td>
<td style="text-align: center">nn_core</td>
<td style="background-color: #FFFF99; text-align: center">1e-3</td>
<td style="text-align: center">--</td>
</tr>
<tr>
<td style="text-align: center">17</td>
<td style="text-align: center">nn_bn_1</td>
<td style="background-color: #FFFF99; text-align: center">1e-3</td>
<td style="text-align: center">--</td>
</tr>
<tr>
<td style="text-align: center">18</td>
<td style="text-align: center">nn_bn_2</td>
<td style="background-color: #FFFF99; text-align: center">1e-3</td>
<td style="text-align: center">--</td>
</tr>
</tbody></table>
<p><b>1D)</b> Choose conclusions that you are able to draw from the experiment results above. Note that these conclusions are specific to this problem instance are may not be generally true.</p>
<p>
<!--START question q000003 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000003" style="position: static">
<div id="q000003_rendered_question">
Mark all that are supported by your findings. <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000003_opt0" type="checkbox" value="0"></td><td>(1) <code>BatchNorm</code> layers placed <em>after</em> the ReLU non-linearities allow better accuracies to emerge, versus placing them <em>before</em> the ReLU non-linearities.</td></tr>
<tr><td align="center"><input name="q000003_opt1" type="checkbox" value="1"></td><td>(2) Based on the results obtained when using a learning rate of 1e-8, we can affirm that <code>BatchNorm</code> layers are useless.</td></tr>
<tr><td align="center"><input name="q000003_opt2" type="checkbox" value="2"></td><td>(3) <code>BatchNorm</code> layers always seem to improve test performance.</td></tr>
<tr><td align="center"><input name="q000003_opt3" type="checkbox" value="3"></td><td>(4) <code>BatchNorm</code> allows these neural networks to perform much better at lower learning rates.</td></tr>
<tr><td align="center"><input checked="" name="q000003_opt4" type="checkbox" value="4"></td><td>(5) <code>BatchNorm</code> stabilizes training at higher learning rates by preventing some of the overflow/underflow issues that we encounter when not using it.</td></tr>
<tr><td align="center"><input checked="" name="q000003_opt5" type="checkbox" value="5"></td><td>(6) <code>BatchNorm</code> helps our models reach the highest achievable accuracies much faster than when not using <code>BatchNorm</code>.</td></tr>
<tr><td align="center"><input name="q000003_opt6" type="checkbox" value="6"></td><td>(7) Thanks to its stabilizing properties, <code>BatchNorm</code> allows any learning rate to be used without any problem.</td></tr>
</tbody></table><input id="q000003" name="q000003" type="hidden" value="{&quot;q000003_opt5&quot;:true,&quot;q000003_opt4&quot;:true,&quot;q000003_opt0&quot;:true}">
<script type="text/javascript">
var q000003_selected = {'q000003_opt5': true,'q000003_opt4': true,'q000003_opt0': true};
document.getElementById("q000003").value = JSON.stringify(q000003_selected);
document.querySelectorAll("input[type=checkbox][name^=q000003_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000003_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000003").value = JSON.stringify(q000003_selected);
    });
});
</script>
</div><div>
<span id="q000003_buttons">
<button class="submit btn btn-catsoop" id="q000003_submit" onclick="catsoop.submit('q000003');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000003_viewanswer" onclick="catsoop.viewanswer('q000003');" style="margin-top: 10px;">View Answer</button></span><span id="q000003_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000003_loading_wrapper">
<span id="q000003_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000003_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000003_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000003_solution_container">
<div id="q000003_solution">
</div>
<div id="q000003_solution_explanation">
</div>
</div>
<div id="q000003_message">
<script type="text/javascript">document.getElementById("q000003_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000003 -->
<a class="anchor" name="catsoop_section_2"></a><h2>2) Implementing Mini-batch Gradient Descent and Batch Normalization (OPTIONAL)</h2>
<p><script src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/showhide.js" type="text/javascript"></script>
<script type="text/javascript">
asw02 = add_showhide_ws("optional_ws_02");
</script></p>
<button style="font-size: 24px;" id="optional_ws_02_button">Show optional content</button><div id="optional_ws_02" style="display: none;">
<p>Last week we implemented a framework for building neural networks from scratch. We trained our models using <em>stochastic</em> gradient descent. In this problem, we explore how we can implement batch normalization as a module <code>BatchNorm</code> in our framework. It is the same module which you analyzed in problem 1. </p>
<p>Key to the concept of batch normalization is the doing gradient descent on batches of data. So we instead of using last week's stochastic gradient descent, we will first implement the <em>mini-batch</em> gradient descent method <code>mini_gd</code>, which is a hybrid between <em>stochastic</em> gradient descent and <em>batch</em> gradient descent. The lecture notes on <a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week7/neural_networks_2/1?activate_block_id=block-v1%3AMITx%2B6.036%2B2019_Spring%2Btype%40vertical%2Bblock%40neural_networks_2_optimizing_neural_network_parameters_vert"> optimizing neural network parameters</a> are helpful for this part.</p>
<p>In <em>mini-batch</em> gradient descent, for a mini-batch of size <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span>, we select <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span> distinct data points uniformly at random from the data set and update the network weights based only on their contributions to the gradient:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mo>:</mo><mo>=</mo><mi>W</mi><mo>−</mo><mi>η</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi mathvariant="normal">∇</mi><mi>W</mi></msub><mi mathvariant="script">L</mi><mo>(</mo><mi>h</mi><mo>(</mo><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo separator="true">;</mo><mi>W</mi><mo>)</mo><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>)</mo>&amp;ThickSpace;&amp;ThickSpace;<mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">W := W - \eta\sum_{i=1}^K \nabla_W \mathcal{L}(h(x^{(i)}; W), y^{(i)})\;\;.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">η</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">.</span></span></span></span></span></div><p></p>
<p>Our <em>mini-batch</em> method <code>mini_gd</code> will be implemented within the <code>Sequential</code> python class (see homework 7 problem 2) and will take the following as inputs:</p>
<ul>
<li><code>X</code>: a standard data array (d by n)</li>
<li><code>y</code>: a standard labels row vector (1 by n)</li>
<li><code>iters</code>: the number of updates to perform on weights <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span></span></span></li>
<li><code>lrate</code>: the learning rate used</li>
<li><code>K</code>: the mini-batch size to be used</li>
</ul>
<p>One call of <code>mini_gd</code> should call <code>Sequential.backward</code> for back-propagation and <code>Sequential.step</code> for updating the weights, for a total of <code>iters</code> times, using <code>lrate</code> as the learning rate. As in our implementation of <code>sgd</code> from homework 7, we compute the predicted output for a mini-batch of data with the <code>Sequential.forward</code> method. We compute the loss between our predictions and the true labels using the assigned <code>Sequential.loss</code> method. (Note that in homework 7, <code>Sequential.step</code> was called <code>Sequential.sgd_step</code>. While the functionality of the step function is the same, it has been renamed for convenience. The same is true for the <code>module.step</code> function of each module we implemented, where applicable.)</p>
<p>For picking <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span> unique data points at random from our large data-set for each mini-batch, we will implement the following strategy: we will first shuffle our data points <code>X</code> (and associated labels <code>y</code>). Then, we get <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>n</mi><mi>k</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{n}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04039em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.695392em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> (rounded down to the nearest integer) different mini-batches by grouping each <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span> consecutive points from this shuffled array. If we end up iterating over all the points but need more mini-batches, we will repeat the shuffling and the batching process.</p>
<p><b>2A)</b>You need to fill in the missing code below. We have implemented the shuffling of indices and have provided you with the outer and inner loops.</p>
<p>
<!--START question network -->
</p><div class="question question-pythoncode" id="cs_qdiv_network" style="position: static">
<div id="network_rendered_question">
<div class="ace_editor_wrapper" id="containernetwork" style="height: 600px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editornetwork" name="editornetwork" style="font-size: 16px; height: 600px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 0px; top: 0px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 638px; width: 46px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div><div class="ace_gutter-cell " style="height: 19px;">9</div><div class="ace_gutter-cell " style="height: 19px;">10</div><div class="ace_gutter-cell " style="height: 19px;">11</div><div class="ace_gutter-cell " style="height: 19px;">12</div><div class="ace_gutter-cell " style="height: 19px;">13</div><div class="ace_gutter-cell " style="height: 19px;">14</div><div class="ace_gutter-cell " style="height: 19px;">15</div><div class="ace_gutter-cell " style="height: 19px;">16</div><div class="ace_gutter-cell " style="height: 19px;">17</div><div class="ace_gutter-cell " style="height: 19px;">18</div><div class="ace_gutter-cell " style="height: 19px;">19</div><div class="ace_gutter-cell " style="height: 19px;">20</div><div class="ace_gutter-cell " style="height: 19px;">21</div><div class="ace_gutter-cell " style="height: 19px;">22</div><div class="ace_gutter-cell " style="height: 19px;">23</div><div class="ace_gutter-cell " style="height: 19px;">24</div><div class="ace_gutter-cell " style="height: 19px;">25</div><div class="ace_gutter-cell " style="height: 19px;">26</div><div class="ace_gutter-cell " style="height: 19px;">27</div><div class="ace_gutter-cell " style="height: 19px;">28</div><div class="ace_gutter-cell " style="height: 19px;">29</div><div class="ace_gutter-cell " style="height: 19px;">30</div><div class="ace_gutter-cell " style="height: 19px;">31</div><div class="ace_gutter-cell " style="height: 19px;">32</div><div class="ace_gutter-cell " style="height: 19px;">33</div></div><div class="ace_gutter-active-line" style="top: 912px; height: 19px;"></div></div><div class="ace_scroller" style="left: 46px; right: 14px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 744px; height: 638px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">import</span> <span class="ace_identifier">math</span> <span class="ace_keyword">as</span> <span class="ace_identifier">m</span> </div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">Sequential</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">modules</span>, <span class="ace_identifier">loss</span><span class="ace_paren ace_rparen">)</span>:            </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">modules</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">loss</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">mini_gd</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">X</span>, <span class="ace_identifier">Y</span>, <span class="ace_identifier">iters</span>, <span class="ace_identifier">lrate</span>, <span class="ace_identifier">notif_each</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">None</span>, <span class="ace_identifier">K</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">10</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">D</span>, <span class="ace_identifier">N</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">X</span>.<span class="ace_identifier">shape</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">seed</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">num_updates</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">indices</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">arange</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">N</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">while</span> <span class="ace_identifier">num_updates</span> <span class="ace_keyword ace_operator">&lt;</span> <span class="ace_identifier">iters</span>:</div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">shuffle</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">indices</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">X</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">X</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">indices</span><span class="ace_paren ace_rparen">]</span>  <span class="ace_comment"># Your code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">Y</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Y</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">indices</span><span class="ace_paren ace_rparen">]</span>  <span class="ace_comment"># Your code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#X = X_i[:,:K]</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#Y = Y_i[:,:K]</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">j</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">m</span>.<span class="ace_identifier">floor</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">N</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">K</span><span class="ace_paren ace_rparen">))</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">num_updates</span> <span class="ace_keyword ace_operator">&gt;=</span> <span class="ace_identifier">iters</span>: <span class="ace_keyword">break</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Implement the main part of mini_gd here</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Your code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">X_i</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">X</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">j</span><span class="ace_paren ace_rparen">]</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">(</span><span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">Y_i</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">Y</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">j</span><span class="ace_paren ace_rparen">]</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">(</span><span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">Ypred</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">self</span>.<span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">X_i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">loss</span>.<span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Ypred</span>,<span class="ace_identifier">Y_i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#cur_loss=self.loss.backward(Ypred,Y)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#print("cur_loss",cur_loss)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#print("Ypred",Ypred)</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 912px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 931px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 46px; right: 14px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 744px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="network" name="network" type="hidden" value="import math as m 

class Sequential:
    def __init__(self, modules, loss):            
        self.modules = modules
        self.loss = loss

    def mini_gd(self, X, Y, iters, lrate, notif_each=None, K=10):
        D, N = X.shape

        np.random.seed(0)
        num_updates = 0
        indices = np.arange(N)
        while num_updates < iters:

            np.random.shuffle(indices)
            X = X[:,indices]  # Your code
            Y = Y[:,indices]  # Your code
            #X = X_i[:,:K]
            #Y = Y_i[:,:K]

            for j in range(m.floor(N/K)):
                if num_updates >= iters: break

                # Implement the main part of mini_gd here
                # Your code
                X_i=X[:,j].reshape(-1,1)
                Y_i=Y[:,j].reshape(-1,1)
                Ypred=self.forward(X_i)
                self.loss.forward(Ypred,Y_i)
                #cur_loss=self.loss.backward(Ypred,Y)
                #print(&quot;cur_loss&quot;,cur_loss)
                #print(&quot;Ypred&quot;,Ypred)
                
                self.backward(self.loss.backward()) #(Ypred-Y) 
                self.step(lrate)
                
                num_updates += 1

    def forward(self, Xt):                        
        for m in self.modules: Xt = m.forward(Xt)
        return Xt

    def backward(self, delta):                   
        for m in self.modules[::-1]: delta = m.backward(delta)

    def step(self, lrate):    
        for m in self.modules: m.step(lrate)
">
<input id="network_log" name="network_log" type="hidden">
<script type="text/javascript">
    var lognetwork = new Array();
    var editornetwork = ace.edit("editornetwork");
    editornetwork.setTheme("ace/theme/textmate");
    editornetwork.getSession().setMode("ace/mode/python");
    editornetwork.setShowFoldWidgets(false);
    editornetwork.setValue('import math as m \n\nclass Sequential:\n    def __init__(self, modules, loss):            \n        self.modules = modules\n        self.loss = loss\n\n    def mini_gd(self, X, Y, iters, lrate, notif_each=None, K=10):\n        D, N = X.shape\n\n        np.random.seed(0)\n        num_updates = 0\n        indices = np.arange(N)\n        while num_updates < iters:\n\n            np.random.shuffle(indices)\n            X = X[:,indices]  # Your code\n            Y = Y[:,indices]  # Your code\n            #X = X_i[:,:K]\n            #Y = Y_i[:,:K]\n\n            for j in range(m.floor(N/K)):\n                if num_updates >= iters: break\n\n                # Implement the main part of mini_gd here\n                # Your code\n                X_i=X[:,j].reshape(-1,1)\n                Y_i=Y[:,j].reshape(-1,1)\n                Ypred=self.forward(X_i)\n                self.loss.forward(Ypred,Y_i)\n                #cur_loss=self.loss.backward(Ypred,Y)\n                #print("cur_loss",cur_loss)\n                #print("Ypred",Ypred)\n                \n                self.backward(self.loss.backward()) #(Ypred-Y) \n                self.step(lrate)\n                \n                num_updates += 1\n\n    def forward(self, Xt):                        \n        for m in self.modules: Xt = m.forward(Xt)\n        return Xt\n\n    def backward(self, delta):                   \n        for m in self.modules[::-1]: delta = m.backward(delta)\n\n    def step(self, lrate):    \n        for m in self.modules: m.step(lrate)\n')
    document.getElementById("network").value = editornetwork.getValue();
    editornetwork.on("change",function(e){
        editornetwork.getSession().setUseSoftTabs(true);
        document.getElementById("network").value = editornetwork.getValue();
    });
    editornetwork.clearSelection()
    editornetwork.getSession().setUseSoftTabs(true);
    editornetwork.on("paste",function(txt){editornetwork.getSession().setUseSoftTabs(false);});
    editornetwork.getSession().setTabSize(4);
    editornetwork.setFontSize("16px");
    document.getElementById("containernetwork").style.height = "600px";
    document.getElementById("editornetwork").style.height = "600px";
    editornetwork.resize(true);
</script>
</div><div>
<span id="network_buttons">
<button class="check btn btn-catsoop" id="network_check" onclick="catsoop.check('network');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="network_submit" onclick="catsoop.submit('network');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="network_viewanswer" onclick="catsoop.viewanswer('network');" style="margin-top: 10px;">View Answer</button></span><span id="network_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'network',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'network',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="network_loading_wrapper">
<span id="network_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="network_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="network_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="network_solution_container">
<div id="network_solution">
</div>
<div id="network_solution_explanation">
</div>
</div>
<div id="network_message">
<script type="text/javascript">document.getElementById("network_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<br>&nbsp;Your score on your most recent submission was: 100.00%
<br><button onclick="if(this.nextSibling.style.display === 'none'){this.nextSibling.style.display = 'block';}else{this.nextSibling.style.display = 'none';}">Show/Hide Detailed Results</button><div class="response" id="network_result_showhide" style="display:none"><h2>Test Results:</h2>
<center><h3>Test 01</h3>
<i></i></center><p></p>
The test case was:<br>
<p><tt>#Your Code Here<br>ans=mini_gd_test()</tt></p>
<p>Our solution produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2135277785917356, 0.3134623323741288, 0.6226041915014946], [1.5619867343396823, 1.3409023370712878, -0.7373527346854926], [-0.0034077676350015877, 0.002882915659847258, -0.0067323162181672875]], [[0.9209784298040289, 0.3285285389739783], [0.5160411090271754, 1.342813821346548], [1.068164913833217, -0.5541614525126095], [-0.0040873354972869895, 0.0040873354972869895]]]</tt></font></p>
<p>Your submission produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2135277785917356, 0.3134623323741288, 0.6226041915014946], [1.5619867343396823, 1.3409023370712878, -0.7373527346854926], [-0.0034077676350015877, 0.002882915659847258, -0.0067323162181672875]], [[0.9209784298040289, 0.3285285389739783], [0.5160411090271754, 1.342813821346548], [1.068164913833217, -0.5541614525126095], [-0.0040873354972869895, 0.0040873354972869895]]]</tt></font><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAABQVBMVEUAAAAGDQAAAAAAAAAAAAAAAAAAAACGqlBIfBNciiZGeg9Eeg5Feg5Gew9CdgpCdgxDehJvmDN1nj9plTVWhRtOgRlMfxZjkS5Geg9EeA5Geg5HfBBHew5GeQ5Cdg1CeAxDegtHgACVtmV+pURPgBp4oEBEeQx+o0p8oklFeg5YiCJIfRFEdQ5GehBHeg9CdwtEdQxEeg5Fdw5DeQ1Eegs2YQlCdwpCeAxDeQ0PHgBGdA9AdgkAAAAAAAARIgChwGKPs0qjwXKStUyFqD6CqDfJ3p+91Ji00XqlwmypyGihwGiauluWtlicwFKXulGTuEmMr0WOs0OKr0CGrDuEqjrR46zC2Ji+1ZC804640oK1z4CxzHywynqsx3enw3WYuWidvF+fwlqgxFePsFWSs1KIrE2Wu0uOr0qGqkeCpj50nDHRgoCJAAAAP3RSTlMABA0HEgoQ/ff17+jbxi8nDvz39vb29fTy7dPQoJeLVRUJ/f39+vn49/f118jAvrKWcW9jWllJQjkiIRwZFg8RajNxAAAA+klEQVQY06XQ1bLCMBAGYNJCHXfnuLtrFXc5gru+/wMQhhZouWRvMvNt/kx2dbvUC+V/3tY9OhZzX5i0HDqNxn/aRo2aXb/JXtR+p2HjfjUb5xmg1kfyL9v9d76q1UK1kqPaSWAFy1TQVs+zvCci4wd9fA8PE9HM5Rvkg5JlcJ68iuh8OFtkcb/ywrUtlUscUTfniaKQIlaj0AdsoZTuH2aEUsceXM/AuNNcmcsIZW7otWwsIuCacBVJqgycYdWPwx7rWJQKVu0y3n0OUZyemVUIAPp9S8wcIQRBDCgAsqIGBNM/eS/fPr/02KKx5IXDBixsfV2OwCYERebVjyGAvqhE3QAAAABJRU5ErkJggg=="></p>
</div></div>
</div>
<!--END question network -->
<p><b>2B)</b> We are now ready to implement batch normalization into our neural network framework! Our module <code>BatchNorm</code> will sit between consecutive layers of neurons, such as the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layers, acting as a "corrector" which allows <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">W^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> to change freely, producing outputs <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Z</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">Z^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span>, but then the module corrects the internal covariate shift induced in the signals before they reach the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer, converting <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Z</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">Z^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> to <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi>Z</mi><mo stretchy="true">^</mo></mover><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\widehat{Z}^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.92333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span>. </p>
<p>The following is a summmary what is described in the <a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week7/neural_networks_2/2">lecture notes</a>, and it should guide your implementation of the module. </p>
<p>Any normalization between the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">l^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layers is done <em>separately</em> for each of the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> input connections leading to the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer. We handle a mini-batch of data of size <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span>, and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Z</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">Z^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">n^l \times K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span></span>, and the output <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi>Z</mi><mo stretchy="true">^</mo></mover><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\widehat{Z}^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.92333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> is of the same shape. </p>
<p>We first compute <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> <em>batchwise</em> means and
standard deviations.  Let <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>μ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\mu^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04355em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> be the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector (<code>self.mus</code> in the code) where
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>μ</mi><mi>i</mi><mi>l</mi></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>K</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup>&amp;ThickSpace;&amp;ThickSpace;<mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mu^l_i = \frac{1}{K} \sum_{j = 1}^K Z^l_{ij}\;\;,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14611em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mpunct">,</span></span></span></span></span></div>
and let <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\sigma^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> be the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector of standard deviations where
<div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>σ</mi><mi>i</mi><mi>l</mi></msubsup><mo>=</mo><msqrt><mrow><mfrac><mn>1</mn><mi>K</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mo>(</mo><msubsup><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt>&amp;ThickSpace;&amp;ThickSpace;<mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sigma^l_i = \sqrt{\frac{1}{K} \sum_{j = 1}^K (Z^l_{ij} - \mu_i)^2}\;\;.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14611em; vertical-align: -0.247em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.46986em; vertical-align: -1.41378em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05609em;"><span class="svg-align" style="top: -5.42986em;"><span class="pstrut" style="height: 5.42986em;"></span><span class="mord" style="padding-left: 1.056em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830908em;"><span class="" style="top: -2.42314em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.740108em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.01609em;"><span class="pstrut" style="height: 5.42986em;"></span><span class="hide-tail" style="min-width: 0.742em; height: 3.50986em;"><svg width="400em" height="3.5098630000000006em" viewBox="0 0 400000 3509" preserveAspectRatio="xMinYMin slice"><path d="M702 80H400000v40H742v3375l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">.</span></span></span></span></span></div>
Note that in the code <code>self.vars</code> is the variance, or element-wise square of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mi>l</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sigma^l.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><p></p>
<p>The normalized data <code>self.norm</code> is now the matrix <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Z</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88333em; vertical-align: 0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.88333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.80333em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span></span></span></span></span>, where
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>Z</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>=</mo><mfrac><mrow><msubsup><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>−</mo><msubsup><mi>μ</mi><mi>i</mi><mi>l</mi></msubsup></mrow><mrow><msubsup><mi>σ</mi><mi>i</mi><mi>l</mi></msubsup><mo>+</mo><mi>ϵ</mi></mrow></mfrac>&amp;ThickSpace;&amp;ThickSpace;<mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\overline{Z}^l_{ij} = \frac{Z^l_{ij} - \mu^l_i}{\sigma^l_i + \epsilon}\;\;,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.50545em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.88333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.80333em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.12234em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.33623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.63165em; vertical-align: -0.997772em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.63388em;"><span class="" style="top: -2.27909em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830908em;"><span class="" style="top: -2.42314em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">ϵ</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.78477em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.44134em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.997772em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mpunct">,</span></span></span></span></span></div>
and where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span> is a very small constant to guard against division by
zero. <p></p>
<p>We define weights <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">G^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> (<code>self.G</code>) and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>B</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">B^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> (<code>self.B</code>), each being an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector, which we use to to shift and scale the outputs:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>Z</mi><mo stretchy="true">^</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>=</mo><msubsup><mi>G</mi><mi>i</mi><mi>l</mi></msubsup><msubsup><mover accent="true"><mi>Z</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow><mi>l</mi></msubsup><mo>+</mo><msubsup><mi>B</mi><mi>i</mi><mi>l</mi></msubsup>&amp;ThickSpace;&amp;ThickSpace;<mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\widehat{Z}^l_{ij} = G^l_i \overline{Z}^l_{ij} + B^l_i\;\;.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.30644em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.50545em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.88333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.80333em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.12234em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="" style="top: -3.33623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.14611em; vertical-align: -0.247em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.453em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">.</span></span></span></span></span></div><p></p>
<p>The outputs are finally ready to be passed to the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(l+1)^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> layer.</p>
<p>A slight warning (that we will not worry about here) about <code>BatchNorm</code> is that during the <em>test</em> phase, if the test mini-batch size is too small (imagine we are deploying a neural network that deals with live video frames), then the lack of samples would cause the freshly-calculated <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>μ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\mu^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04355em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\sigma^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> to be far off from their true values that the module's parameters <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">G^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>B</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">B^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> were trained to be compatible with. To fix that, people usually compute a running average of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>μ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\mu^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04355em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">\sigma^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> during training, to be used at test time. We will assume our test mini-batches are large enough.</p>
<p>In this problem we only implement the <code>BatchNorm.forward</code> and <code>BatchNorm.step</code> methods. We provide you with the implementation for <code>BatchNorm.backward</code> and the lecture notes contain the details of the derivations. You will need to fill in the missing code below.</p>
<p>
<!--START question batch_norm -->
</p><div class="question question-pythoncode" id="cs_qdiv_batch_norm" style="position: static">
<div id="batch_norm_rendered_question">
<div class="ace_editor_wrapper" id="containerbatch_norm" style="height: 800px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorbatch_norm" name="editorbatch_norm" style="font-size: 16px; height: 800px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 0px; top: 0px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 824px; width: 46px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div><div class="ace_gutter-cell " style="height: 19px;">9</div><div class="ace_gutter-cell " style="height: 19px;">10</div><div class="ace_gutter-cell " style="height: 19px;">11</div><div class="ace_gutter-cell " style="height: 19px;">12</div><div class="ace_gutter-cell " style="height: 19px;">13</div><div class="ace_gutter-cell " style="height: 19px;">14</div><div class="ace_gutter-cell " style="height: 19px;">15</div><div class="ace_gutter-cell " style="height: 19px;">16</div><div class="ace_gutter-cell " style="height: 19px;">17</div><div class="ace_gutter-cell " style="height: 19px;">18</div><div class="ace_gutter-cell " style="height: 19px;">19</div><div class="ace_gutter-cell " style="height: 19px;">20</div><div class="ace_gutter-cell " style="height: 19px;">21</div><div class="ace_gutter-cell " style="height: 19px;">22</div><div class="ace_gutter-cell " style="height: 19px;">23</div><div class="ace_gutter-cell " style="height: 19px;">24</div><div class="ace_gutter-cell " style="height: 19px;">25</div><div class="ace_gutter-cell " style="height: 19px;">26</div><div class="ace_gutter-cell " style="height: 19px;">27</div><div class="ace_gutter-cell " style="height: 19px;">28</div><div class="ace_gutter-cell " style="height: 19px;">29</div><div class="ace_gutter-cell " style="height: 19px;">30</div><div class="ace_gutter-cell " style="height: 19px;">31</div><div class="ace_gutter-cell " style="height: 19px;">32</div><div class="ace_gutter-cell " style="height: 19px;">33</div><div class="ace_gutter-cell " style="height: 19px;">34</div><div class="ace_gutter-cell " style="height: 19px;">35</div><div class="ace_gutter-cell " style="height: 19px;">36</div><div class="ace_gutter-cell " style="height: 19px;">37</div><div class="ace_gutter-cell " style="height: 19px;">38</div><div class="ace_gutter-cell " style="height: 19px;">39</div><div class="ace_gutter-cell " style="height: 19px;">40</div><div class="ace_gutter-cell " style="height: 19px;">41</div><div class="ace_gutter-cell " style="height: 19px;">42</div><div class="ace_gutter-cell " style="height: 19px;">43</div><div class="ace_gutter-cell " style="height: 19px;">44</div></div><div class="ace_gutter-active-line" style="top: 817px; height: 19px;"></div></div><div class="ace_scroller" style="left: 46px; right: 14px; bottom: 14px;"><div class="ace_content" style="margin-top: 0px; width: 1260px; height: 824px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">BatchNorm</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Module</span><span class="ace_paren ace_rparen">)</span>:    </div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">m</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">seed</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">eps</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1e-20</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">m</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">m</span>  <span class="ace_comment"># number of input channels</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Init learned shifts and scaling factors</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">B</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">zeros</span><span class="ace_paren ace_lparen">([</span><span class="ace_identifier">self</span>.<span class="ace_identifier">m</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">])</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">G</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">normal</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_constant ace_numeric">1.0</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">m</span> <span class="ace_keyword ace_operator">**</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">.5</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_paren ace_lparen">[</span><span class="ace_identifier">self</span>.<span class="ace_identifier">m</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">])</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Works on m x b matrices of m input channels and b different inputs</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">A</span><span class="ace_paren ace_rparen">)</span>:<span class="ace_comment"># A is m x K: m input channels and mini-batch size K</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Store last inputs and K for next backward() call</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">A</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">A</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">K</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">A</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">]</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">mus</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">mean</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>.<span class="ace_identifier">A</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_support ace_function">vars</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">sqrt</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">np</span>.<span class="ace_identifier">mean</span><span class="ace_paren ace_lparen">((</span><span class="ace_identifier">self</span>.<span class="ace_identifier">A</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">mus</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword ace_operator">**</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">))</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Normalize inputs using their mean and standard deviation</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">norm</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">([(</span><span class="ace_identifier">val</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">mus</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword ace_operator">/</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>.<span class="ace_support ace_function">vars</span><span class="ace_keyword ace_operator">+</span><span class="ace_identifier">self</span>.<span class="ace_identifier">eps</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">for</span> <span class="ace_identifier">val</span> <span class="ace_keyword">in</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">A</span><span class="ace_paren ace_rparen">])</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Return scaled and shifted versions of self.norm</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">G</span><span class="ace_keyword ace_operator">*</span><span class="ace_identifier">self</span>.<span class="ace_identifier">norm</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">B</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">dLdZ</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Re-usable constants</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">std_inv</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">np</span>.<span class="ace_identifier">sqrt</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>.<span class="ace_support ace_function">vars</span><span class="ace_keyword ace_operator">+</span><span class="ace_identifier">self</span>.<span class="ace_identifier">eps</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">A_min_mu</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">A</span><span class="ace_keyword ace_operator">-</span><span class="ace_identifier">self</span>.<span class="ace_identifier">mus</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">dLdnorm</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">dLdZ</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">G</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">dLdVar</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdnorm</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">A_min_mu</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">0.5</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">std_inv</span><span class="ace_keyword ace_operator">**</span><span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">keepdims</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">dLdMu</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdnorm</span><span class="ace_keyword ace_operator">*</span><span class="ace_paren ace_lparen">(</span><span class="ace_keyword ace_operator">-</span><span class="ace_identifier">std_inv</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">keepdims</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_identifier">dLdVar</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">2</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">self</span>.<span class="ace_identifier">K</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">A_min_mu</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">keepdims</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">dLdX</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdnorm</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">std_inv</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdVar</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">2</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">self</span>.<span class="ace_identifier">K</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">A_min_mu</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdMu</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">self</span>.<span class="ace_identifier">K</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">dLdB</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdZ</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">keepdims</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">dLdG</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">dLdZ</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">norm</span>, <span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">keepdims</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">dLdX</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">step</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">lrate</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">B</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">B</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">lrate</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">dLdB</span><span class="ace_paren ace_rparen">)</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">G</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">G</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">lrate</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">dLdG</span><span class="ace_paren ace_rparen">)</span>  <span class="ace_comment"># Your Code</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 817px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 19px; bottom: 14px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 836px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="height: 19px; left: 46px; right: 14px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 1260px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="batch_norm" name="batch_norm" type="hidden" value="class BatchNorm(Module):    
    def __init__(self, m):
        np.random.seed(0)
        self.eps = 1e-20
        self.m = m  # number of input channels
        
        # Init learned shifts and scaling factors
        self.B = np.zeros([self.m, 1])
        self.G = np.random.normal(0, 1.0 * self.m ** (-.5), [self.m, 1])
        
    # Works on m x b matrices of m input channels and b different inputs
    def forward(self, A):# A is m x K: m input channels and mini-batch size K
        # Store last inputs and K for next backward() call
        self.A = A
        self.K = A.shape[1]
        
        self.mus = np.mean(self.A, axis=0)  # Your Code
        self.vars = np.sqrt(np.mean((self.A - self.mus)**2, axis=0))  # Your Code

        # Normalize inputs using their mean and standard deviation
        self.norm = np.array([(val - self.mus)/(self.vars+self.eps) for val in self.A])  # Your Code
            
        # Return scaled and shifted versions of self.norm
        return self.G*self.norm + self.B  # Your Code

    def backward(self, dLdZ):
        # Re-usable constants
        std_inv = 1/np.sqrt(self.vars+self.eps)
        A_min_mu = self.A-self.mus
        
        dLdnorm = dLdZ * self.G
        dLdVar = np.sum(dLdnorm * A_min_mu * -0.5 * std_inv**3, axis=1, keepdims=True)
        dLdMu = np.sum(dLdnorm*(-std_inv), axis=1, keepdims=True) + dLdVar * (-2/self.K) * np.sum(A_min_mu, axis=1, keepdims=True)
        dLdX = (dLdnorm * std_inv) + (dLdVar * (2/self.K) * A_min_mu) + (dLdMu/self.K)
        
        self.dLdB = np.sum(dLdZ, axis=1, keepdims=True)
        self.dLdG = np.sum(dLdZ * self.norm, axis=1, keepdims=True)
        return dLdX

    def step(self, lrate):
        self.B = self.B - (lrate * self.dLdB)  # Your Code
        self.G = self.G - (lrate * self.dLdG)  # Your Code
        return
">
<input id="batch_norm_log" name="batch_norm_log" type="hidden">
<script type="text/javascript">
    var logbatch_norm = new Array();
    var editorbatch_norm = ace.edit("editorbatch_norm");
    editorbatch_norm.setTheme("ace/theme/textmate");
    editorbatch_norm.getSession().setMode("ace/mode/python");
    editorbatch_norm.setShowFoldWidgets(false);
    editorbatch_norm.setValue('class BatchNorm(Module):    \n    def __init__(self, m):\n        np.random.seed(0)\n        self.eps = 1e-20\n        self.m = m  # number of input channels\n        \n        # Init learned shifts and scaling factors\n        self.B = np.zeros([self.m, 1])\n        self.G = np.random.normal(0, 1.0 * self.m ** (-.5), [self.m, 1])\n        \n    # Works on m x b matrices of m input channels and b different inputs\n    def forward(self, A):# A is m x K: m input channels and mini-batch size K\n        # Store last inputs and K for next backward() call\n        self.A = A\n        self.K = A.shape[1]\n        \n        self.mus = np.mean(self.A, axis=0)  # Your Code\n        self.vars = np.sqrt(np.mean((self.A - self.mus)**2, axis=0))  # Your Code\n\n        # Normalize inputs using their mean and standard deviation\n        self.norm = np.array([(val - self.mus)/(self.vars+self.eps) for val in self.A])  # Your Code\n            \n        # Return scaled and shifted versions of self.norm\n        return self.G*self.norm + self.B  # Your Code\n\n    def backward(self, dLdZ):\n        # Re-usable constants\n        std_inv = 1/np.sqrt(self.vars+self.eps)\n        A_min_mu = self.A-self.mus\n        \n        dLdnorm = dLdZ * self.G\n        dLdVar = np.sum(dLdnorm * A_min_mu * -0.5 * std_inv**3, axis=1, keepdims=True)\n        dLdMu = np.sum(dLdnorm*(-std_inv), axis=1, keepdims=True) + dLdVar * (-2/self.K) * np.sum(A_min_mu, axis=1, keepdims=True)\n        dLdX = (dLdnorm * std_inv) + (dLdVar * (2/self.K) * A_min_mu) + (dLdMu/self.K)\n        \n        self.dLdB = np.sum(dLdZ, axis=1, keepdims=True)\n        self.dLdG = np.sum(dLdZ * self.norm, axis=1, keepdims=True)\n        return dLdX\n\n    def step(self, lrate):\n        self.B = self.B - (lrate * self.dLdB)  # Your Code\n        self.G = self.G - (lrate * self.dLdG)  # Your Code\n        return\n')
    document.getElementById("batch_norm").value = editorbatch_norm.getValue();
    editorbatch_norm.on("change",function(e){
        editorbatch_norm.getSession().setUseSoftTabs(true);
        document.getElementById("batch_norm").value = editorbatch_norm.getValue();
    });
    editorbatch_norm.clearSelection()
    editorbatch_norm.getSession().setUseSoftTabs(true);
    editorbatch_norm.on("paste",function(txt){editorbatch_norm.getSession().setUseSoftTabs(false);});
    editorbatch_norm.getSession().setTabSize(4);
    editorbatch_norm.setFontSize("16px");
    document.getElementById("containerbatch_norm").style.height = "800px";
    document.getElementById("editorbatch_norm").style.height = "800px";
    editorbatch_norm.resize(true);
</script>
</div><div>
<span id="batch_norm_buttons">
<button class="check btn btn-catsoop" id="batch_norm_check" onclick="catsoop.check('batch_norm');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="batch_norm_submit" onclick="catsoop.submit('batch_norm');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="batch_norm_viewanswer" onclick="catsoop.viewanswer('batch_norm');" style="margin-top: 10px;">View Answer</button></span><span id="batch_norm_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'batch_norm',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'batch_norm',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="batch_norm_loading_wrapper">
<span id="batch_norm_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="batch_norm_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="batch_norm_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="batch_norm_solution_container">
<div id="batch_norm_solution">
</div>
<div id="batch_norm_solution_explanation">
</div>
</div>
<div id="batch_norm_message">
<script type="text/javascript">document.getElementById("batch_norm_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
<br>&nbsp;Your score on your most recent submission was: 0.00%
<br><button onclick="if(this.nextSibling.style.display === 'none'){this.nextSibling.style.display = 'block';}else{this.nextSibling.style.display = 'none';}">Show/Hide Detailed Results</button><div class="response" id="batch_norm_result_showhide" style="display:none"><h2>Test Results:</h2>
<center><h3>Test 01</h3>
<i></i></center><p></p>
The test case was:<br>
<p><tt>#Your Code Here<br>ans=batch_norm_test()</tt></p>
<p>Our solution produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[-0.005], [0.005000000000000001], [1.245133318305218], [0.28519393347354227]], [[8.104749234290852], [1.6038386114353451], [7.938907809349264], [0.6638539945344964]], [[-0.9999999999937018, 0.9999999999937021], [-0.9999999999246822, 0.9999999999246822]]]</tt></font></p>
<p>Your submission produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[-0.008220541900088611], [0.008220541900088611], [1.2391528343016842], [0.2747333336770533]], [[3.038104368078218, 6.670483477647979], [2.249038114135747, 4.25187250871976]], [[1.0, 1.0], [-1.0, -0.9999999999999998]]]</tt></font><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAA0lBMVEUAAAC/AAC/QEAAAADALS2qCwsAAAAAAAC7Jia3Hx+zGRm4ICCxFBTKQkLJPj68JycEAADMRUXMSEixFRXENjahBwe+KSmuEBDEMTEIAAALAAANAAAAAADGOTm+LCzCMjK1GxuzGRmuDw8AAAAsAADMR0fMSkrEMjLNQEDjbm7gYGDYUVHPRkbKPT3iZGTng4PmfHzld3fkcnLiZmbeW1vVVVXUTU3SSEjIODjpi4voiIjiamrfamrcZGTYW1vcV1faVVXST0/WTk7RTU3QRETlfn4RycE0AAAAKHRSTlMABAQEtrcvD/X19ba29fW2Kvb19fS2rKysJhsWCvX187a2tiER9vWsKh9QBQAAAP9JREFUGNOVzNdygkAYhuEsSChSVSxg1yQsvSliN+r935KL++N46jc7y8vDDF+fj+n3Gai/qqAbP60GQ+u3KlBjW5K3qlplaYB31QinW0Njqu9pGild4HiX4UjRNCXCGb6rlBlNTbJwFytKjMlD1eDnqDlKQzdMkoxcoyYiBN7Bbu6Sgzugte/z0ynfg9Y8nRzOnnc+TKboTWfjo/fvkXMcz9BLZWG1Ltar5yXI6KVX/1ZcBOFS3Pxr7T3RdxzHF2UZokdZCoLAEecIzUWHpEQZcdJmI3HorcDbbW7Jky2rAmWHtmkO9G8yXTdNix+ylHnbWjxdHywsm2cJw1i6Gh6M9B+39Tnr2wAAAABJRU5ErkJggg=="></p>
</div></div>
</div>
<!--END question batch_norm -->
</div><a class="anchor" name="catsoop_section_3"></a><h2>3)  Neural Network Packages </h2>
<p>In the following problems, we will get experience with using a well-known neural network package for classification.</p>
<h2>Keras and Tensorflow</h2>
<p>We will be using <a href="https://keras.io/">Keras</a> to build neural network models.  Keras uses <a href="https://www.tensorflow.org/install/">Tensorflow</a> as the backend (to actually train the models).  You will need to either (a) install both of these on your machine or (b) use the colab notebook, which comes with pre-installed tensorflow and keras, or (c) use the versions we've installed on Athena.  All of these are Python-based installations and we will be using Python3 (see instructions on the Resources/Software tab).</p>
<p>You do not need to understand Tensorflow in detail.  You should however get used to Keras.  You should read some of the documentation, especially the examples.  Given the lectures, homeworks and labs so far, you should be able to understand most of what's in the basic documentation, although there may be some different names for some of the concepts.</p>
<p>Make sure that you read: <em>Getting started: 30 seconds to Keras</em> on <a href="https://keras.io/">the Keras Home page</a> and <em>Guide to the Sequential Model</em> and pay careful attention to the examples.</p>
<p>You should read some details in the following pages:</p>
<ul>
<li><em>Core Layers</em>, read about <code>Dense</code>, <code>Dropout</code> and <code>Flatten</code> layers</li>
<li><em>Convolutional Layers</em>, read about <code>Conv1D</code> and <code>Conv2D</code></li>
<li><em>Pooling Layers</em>, read about <code>MaxPooling2D</code></li>
<li><em>Optimizers</em> read about <code>Adam</code>; we'll use <code>Adam</code> throughout this assignment, this is an adaptive step-size method that is a bit more sophisticated than Adagrad.</li>
<li><em>Losses</em>, read about <code>categorical_crossentropy</code>, this is what we call NLL loss</li>
<li><em>Datasets</em>, we will be using the MNIST dataset.</li>
</ul>
<h2>Basics</h2>
<p><strong>Note that Keras assumes that each data point is a ROW vector and that a data set X with N points with D features is an NxD matrix.  The code we have provided handles this, but you should be aware of this if you want to use the code in the future.</strong></p>
<p>We will be working with two main data sets:</p>
<ol>
<li>A set of relatively simple datasets in 2D</li>
<li>A standard dataset of images of hand-drawn digits (the MNIST data set). </li>
</ol>
<p>These are all classification problems.  Neural networks can be used for regression as well but we'll skip looking at that.</p>
<p>In this assignment we will focus on exploring the choice of network <em>architecture</em>, numbers and types of units and layers.  In particular, we will explore three classes of network architectures:</p>
<ol>
<li>No hidden units - this is essentially a linear classifier.</li>
<li>Fully connected (FC) layer(s) - the standard approach to problems involving heterogeneous data.</li>
<li>Convolutional layer(s) followed by FC layer(s) - a common approach for image data.</li>
</ol>
<p>If you look through the Keras documentation you'll see that there are an enormous number of choices that can be made to define a model.  We're only going to look at a few, in particular:</p>
<ul>
<li>number and type of layers</li>
<li>number and type of units per layer</li>
<li>number of passes over the data (epochs)</li>
</ul>
<p>Here are a few choices that we are <strong>not</strong> going to explore; we'll keep these choices fixed throughout:</p>
<ul>
<li>We'll use 'ReLU' hidden units</li>
<li>We'll use <code>softmax</code> activations on the output and <code>categorical_crossentropy</code> as the loss.</li>
<li>We'll use <code>Adam</code> as the optimizer.  This is a version of SGD that adapts the step size (learning rate) somewhat like Adagrad but a bit more sophisticated.  We will use Adam's default parameters.</li>
<li>For (mini)batch_size, we'll use 32 on MNIST and 1 otherwise.</li>
</ul>
<p>We have provided you a couple of basic functions to experiment with; you mostly have to define layers.  We <strong>strongly</strong> recommend that you do your experiments using the google <a href="https://colab.research.google.com/drive/1ZPA1lCA45rzIHR0OqTXiOiSxPN_6vDgD">colab</a> file to keep track of your results.  Alternatively, write scripts that can be run to produce your results and save them to a file.  Have your script write out the settings for the experiment so that you can remember what they are when you go back to look at them.</p>
<p>For the 2D datasets, we have provided the following function:</p>
<p><code>run_keras_2d(data_name, layers, epochs, split=0.25, display=True, trials=5)</code></p>
<p>where:</p>
<ul>
<li><code>data_name</code> is a string, such as <code>'1'</code>, <code>'2'</code>, etc.</li>
<li><code>layers</code> is a list of Keras layer definitions for a Sequential model, e.g.
<br><code>[Dense(input_dim=2, units=10, activation='relu'), Dense(units=2, activation='softmax')]</code></li>
<li><code>epochs</code> is an integer indicating how many times to go through the data in training</li>
<li><code>split</code> is a fraction of the training data to use for validation if a validation set is not defined</li>
<li><code>display</code> whether to display result plots</li>
<li><code>verbose</code> whether to print loss and accuracy (percent correctly labeled) each epoch</li>
<li><code>trials</code> is an integer indicating how many times to perform the training and testing</li>
</ul>
<h1>2D Data</h1>
<p>The two-class datasets have <code>data_name</code>s: <code>'1'</code>,<code>'2'</code>,<code>'3'</code>,<code>'4'</code>.  Target accuracies (percent correct) on the validation set are (99%, 90.5%, 96%, 94%).</p>
<p>In this problem, try the following 5 architectures, specified by the number of units in the hidden layers:
</p><pre>1: (0), 2: (10), 3: (100), 4: (10, 10), 5: (100, 100))
</pre>
You may find the <code>archs</code> function in the code file to be helpful here.
<p>Some of these questions ask for the "simplest" architecture; the list above is ordered starting with the simplest.</p>
<p><strong>Use 10 epochs of training for each architecture and re-start the training and testing 5 times (i.e., use trials=5), look at the average accuracy on the validation set (reported as "Avg. validation accuracy" at the end of the run).  But, notice the variation in scores across each run.</strong></p>
<p><b>3A)</b> For each two-class 2D dataset, what is the simplest network architecture that can reach the target accuracy on the validation set?
<!--START question q000004 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000004" style="position: static">
<div id="q000004_rendered_question">
Enter a list of four indices from 0 to 5, indicating the simplest architecture or 0 if none works. The architectures can be 1-5. <input id="q000004" name="q000004" size="50" type="text" value="[1,3,1,2]">
</div><div>
<span id="q000004_buttons">
<button class="submit btn btn-catsoop" id="q000004_submit" onclick="catsoop.submit('q000004');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000004_viewanswer" onclick="catsoop.viewanswer('q000004');" style="margin-top: 10px;">View Answer</button></span><span id="q000004_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000004_loading_wrapper">
<span id="q000004_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000004_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000004_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000004_solution_container">
<div id="q000004_solution">
</div>
<div id="q000004_solution_explanation">
</div>
</div>
<div id="q000004_message">
<script type="text/javascript">document.getElementById("q000004_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000004 -->
<p><b>3B)</b> What is the simplest (single) network architecture that can be used to classify <b>all</b> the of the two-class 2D data sets within 1% of the target validation accuracy.
<!--START question q000005 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000005" style="position: static">
<div id="q000005_rendered_question">
Enter one of the architecture indices or 0 if none works: <input id="q000005" name="q000005" size="50" type="text" value="5">
</div><div>
<span id="q000005_buttons">
<button class="submit btn btn-catsoop" id="q000005_submit" onclick="catsoop.submit('q000005');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000005_viewanswer" onclick="catsoop.viewanswer('q000005');" style="margin-top: 10px;">View Answer</button></span><span id="q000005_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000005_loading_wrapper">
<span id="q000005_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000005_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000005_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000005_solution_container">
<div id="q000005_solution">
</div>
<div id="q000005_solution_explanation">
</div>
</div>
<div id="q000005_message">
<script type="text/javascript">document.getElementById("q000005_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000005 -->
<p><b>3C)</b> Train with dataset <code>'3'</code> using architecture (200,200) for 100 epochs; it's fine to do just one trial.  Make sure that you use <code>display=True</code> so you get the plot of "Epoch val_acc vs. acc".  This shows validation accuracy versus training accuracy.  Use <code>verbose=True</code> as well, so you can see the actual numbers, including the loss.  Which of the following statements describe what you see:
<!--START question q000006 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000006" style="position: static">
<div id="q000006_rendered_question">
Mark all that are True. <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000006_opt0" type="checkbox" value="0"></td><td>The training accuracy has an upward trend as epochs increase.</td></tr>
<tr><td align="center"><input name="q000006_opt1" type="checkbox" value="1"></td><td>The training loss flattens out or raises slightly as epochs increase.</td></tr>
<tr><td align="center"><input name="q000006_opt2" type="checkbox" value="2"></td><td>The validation accuracy has an upward trend as epochs increase.</td></tr>
<tr><td align="center"><input checked="" name="q000006_opt3" type="checkbox" value="3"></td><td>The validation accuracy flattens out or drops slightly as epochs increase.</td></tr>
<tr><td align="center"><input name="q000006_opt4" type="checkbox" value="4"></td><td>The validation loss has a downward trend as epochs increase.</td></tr>
</tbody></table><input id="q000006" name="q000006" type="hidden" value="{&quot;q000006_opt3&quot;:true,&quot;q000006_opt0&quot;:true}">
<script type="text/javascript">
var q000006_selected = {'q000006_opt3': true,'q000006_opt0': true};
document.getElementById("q000006").value = JSON.stringify(q000006_selected);
document.querySelectorAll("input[type=checkbox][name^=q000006_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000006_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000006").value = JSON.stringify(q000006_selected);
    });
});
</script>
</div><div>
<span id="q000006_buttons">
<button class="submit btn btn-catsoop" id="q000006_submit" onclick="catsoop.submit('q000006');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000006_viewanswer" onclick="catsoop.viewanswer('q000006');" style="margin-top: 10px;">View Answer</button></span><span id="q000006_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000006_loading_wrapper">
<span id="q000006_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000006_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000006_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000006_solution_container">
<div id="q000006_solution">
</div>
<div id="q000006_solution_explanation">
</div>
</div>
<div id="q000006_message">
<script type="text/javascript">document.getElementById("q000006_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000006 -->
<p><b>3D)</b> You should be able to find epochs when the training loss is dropping but the training accuracy is constant (and non-zero).  What is happening there?
<!--START question q000007 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000007" style="position: static">
<div id="q000007_rendered_question">
Mark all that are True. <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000007_opt0" type="checkbox" value="0"></td><td>The classification boundary has moved toward misclassified points, but has not moved enough to correctly classify them yet.</td></tr>
<tr><td align="center"><input checked="" name="q000007_opt1" type="checkbox" value="1"></td><td>The same percentage of the samples are being correctly classified, but the classifier is more confident on the ones it’s classifying correctly (or less confident on the ones where it’s wrong).</td></tr>
<tr><td align="center"><input name="q000007_opt2" type="checkbox" value="2"></td><td>The neural network is overfitting to the training data.</td></tr>
<tr><td align="center"><input checked="" name="q000007_opt3" type="checkbox" value="3"></td><td>The predictions are getting closer to their actual 0-1 targets without any  changing sides across the 0.5 boundary in the softmax output.</td></tr>
</tbody></table><input id="q000007" name="q000007" type="hidden" value="{&quot;q000007_opt0&quot;:true,&quot;q000007_opt3&quot;:true,&quot;q000007_opt1&quot;:true}">
<script type="text/javascript">
var q000007_selected = {'q000007_opt0': true,'q000007_opt3': true,'q000007_opt1': true};
document.getElementById("q000007").value = JSON.stringify(q000007_selected);
document.querySelectorAll("input[type=checkbox][name^=q000007_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000007_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000007").value = JSON.stringify(q000007_selected);
    });
});
</script>
</div><div>
<span id="q000007_buttons">
<button class="submit btn btn-catsoop" id="q000007_submit" onclick="catsoop.submit('q000007');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000007_viewanswer" onclick="catsoop.viewanswer('q000007');" style="margin-top: 10px;">View Answer</button></span><span id="q000007_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000007_loading_wrapper">
<span id="q000007_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000007_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000007_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000007_solution_container">
<div id="q000007_solution">
</div>
<div id="q000007_solution_explanation">
</div>
</div>
<div id="q000007_message">
<script type="text/javascript">document.getElementById("q000007_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000007 -->
<p><b>3E)</b> What is the average validation accuracy (using <code>split=0.5</code>) for the three-class data set (<code>data_name=3class</code>), for each of the architectures, using 10 epochs and 5 trials as before. 
<br><i>(These experiments are incredibly stochastic in nature. If you are having trouble getting the solution checker to accept your solution, have tried rerunning your experiment, and are confident in your method, post on Piazza, as we continue to tune the checker.)</i>
<!--START question q000008 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000008" style="position: static">
<div id="q000008_rendered_question">
Enter a list of 5 floats (3 decimal places) corresponding to avg. accuracy for each architecture: <input id="q000008" name="q000008" size="50" type="text" value="(0.916, 0.970, 0.962, 0.957, 0.963)">
</div><div>
<span id="q000008_buttons">
<button class="submit btn btn-catsoop" id="q000008_submit" onclick="catsoop.submit('q000008');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000008_viewanswer" onclick="catsoop.viewanswer('q000008');" style="margin-top: 10px;">View Answer</button></span><span id="q000008_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000008',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000008',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000008_loading_wrapper">
<span id="q000008_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000008_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000008_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000008_solution_container">
<div id="q000008_solution">
</div>
<div id="q000008_solution_explanation">
</div>
</div>
<div id="q000008_message">
<script type="text/javascript">document.getElementById("q000008_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000008 -->
<p><b>3F)</b> The decision boundary for the 3class data, using no hidden units (architecture 1) looks like this:
</p><div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/3class_3regions.png" width="50%/">
</center>
</div>
We can see that the decision boundaries are lines, but what do they correspond to?
Let's focus on the decision between class 1 and class 2.  Assume
that <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>W</mi><mn>1</mn><mi>T</mi></msubsup><mi>x</mi><mo>+</mo><msub><mi>W</mi><mn>01</mn></msub></mrow><annotation encoding="application/x-tex">z_1 = W_1^T x + W_{01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08944em; vertical-align: -0.248108em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.45189em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the first input to the softmax module
and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>W</mi><mn>2</mn><mi>T</mi></msubsup><mi>x</mi><mo>+</mo><msub><mi>W</mi><mn>02</mn></msub></mrow><annotation encoding="application/x-tex">z_2 = W_2^T x + W_{02}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08944em; vertical-align: -0.248108em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.45189em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the second input to softmax.  Give an
expression <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo separator="true">;</mo><msub><mi>W</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>W</mi><mn>01</mn></msub><mo separator="true">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>W</mi><mn>02</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">h(x; W_1, W_{01}, W_2, W_{02})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, for the decision boundary
<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h(x)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> between the class 1 and class 2. Remember that you can use <code>@</code> for matrix product, and
you can use <code>transpose(x)</code> to transpose a vector.
<br>
Enter an expression involving <code>x</code>, <code>W_1</code>, <code>W_2</code>, <code>W_01</code>, <code>W_02</code>.  Assume all quantities are column vectors.
<!--START question q000009 -->
<div class="question question-expression" id="cs_qdiv_q000009" style="position: static">
<div id="q000009_rendered_question">
h(x) = <input id="q000009" name="q000009" size="50" type="text" value="(transpose(W_1)@x+W_01) - (transpose(W_2)@x+W_02)">
<span id="imageq000009"></span>
</div><div>
<span id="q000009_buttons">
<button class="check btn btn-catsoop" id="q000009_check" onclick="catsoop.check('q000009');" style="margin-top: 10px;">Check Syntax</button>
<button class="submit btn btn-catsoop" id="q000009_submit" onclick="catsoop.submit('q000009');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000009_viewanswer" onclick="catsoop.viewanswer('q000009');" style="margin-top: 10px;">View Answer</button></span><span id="q000009_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000009',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000009',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000009_loading_wrapper">
<span id="q000009_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000009_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000009_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000009_solution_container">
<div id="q000009_solution">
</div>
<div id="q000009_solution_explanation">
</div>
</div>
<div id="q000009_message">
<script type="text/javascript">document.getElementById("q000009_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<script type="text/javascript">document.getElementById('imageq000009').innerHTML = '';</script>
<div id="exprq000009">Your entry was parsed as:<br><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">W</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><mi>T</mi></msup><mi mathvariant="bold">x</mi><mo>+</mo><msub><mi mathvariant="bold">W</mi><mn>01</mn></msub><mo>−</mo><mrow><mo fence="true">(</mo><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">W</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mi>T</mi></msup><mi mathvariant="bold">x</mi><mo>+</mo><msub><mi mathvariant="bold">W</mi><mn>02</mn></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left({\mathbf{W}_{1}}\right)^T\mathbf{x} + \mathbf{W}_{01} - \left(\left({\mathbf{W}_{2}}\right)^T\mathbf{x} + \mathbf{W}_{02}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.23123em; vertical-align: -0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.01597em;" class="mord mathbf">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.01597em;" class="mord mathbf">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.80002em; vertical-align: -0.65002em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.01597em;" class="mord mathbf">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.01597em;" class="mord mathbf">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></div></div><script type="text/javascript">catsoop.render_all_math(document.getElementById("exprq000009"), true);</script></div>
</div>
<!--END question q000009 -->
<p><b>3G)</b> Using the 3class data with no hidden units and running for 1 trial, use <code>layer.get_weights()</code> to get the weights for the trained softmax layer (the one passed to the <code>run_keras_2d</code> function); this will give you a list with a weight matrix <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span></span></span> and a bias/offset vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">W_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.  Use these values to compute each of the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span></span></span></span></span> values for the following input points :
</p><pre>[[-1,0], [1,0], [0,-11], [0,1], [-1,-1], [-1,1], [1,1], [1,-1]]
</pre>
You will need to seed the numpy random number generator to get comparable results to ours. After importing <code>numpy</code>, but before the first <code>keras</code> import, please uncomment <code>np.random.seed(0)</code>. Now, use these values to compute the class predictions:<br>
<!--START question q000010 -->
<div class="question question-pythonic" id="cs_qdiv_q000010" style="position: static">
<div id="q000010_rendered_question">
Enter a list of 8 class indices (0, 1, 2): <input id="q000010" name="q000010" size="50" type="text" value="[2, 1, 0, 2, 0, 2, 1, 1]">
</div><div>
<span id="q000010_buttons">
<button class="submit btn btn-catsoop" id="q000010_submit" onclick="catsoop.submit('q000010');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000010_viewanswer" onclick="catsoop.viewanswer('q000010');" style="margin-top: 10px;">View Answer</button></span><span id="q000010_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000010',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000010',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000010_loading_wrapper">
<span id="q000010_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000010_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000010_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000010_solution_container">
<div id="q000010_solution">
</div>
<div id="q000010_solution_explanation">
</div>
</div>
<div id="q000010_message">
<script type="text/javascript">document.getElementById("q000010_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000010 -->
<p><b>3H)</b> Here's another decision boundary for the 3class data obtained with lots of hidden units (architecture 5):
</p><div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/3class_5regions.png" width="50%/">
</center>
</div>
<!--START question q000011 -->
<div class="question question-multiplechoice" id="cs_qdiv_q000011" style="position: static">
<div id="q000011_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000011_opt0" type="checkbox" value="0"></td><td>Increasing the complexity of the network enables fitting more complex training data.</td></tr>
<tr><td align="center"><input checked="" name="q000011_opt1" type="checkbox" value="1"></td><td>Increasing the number of training epochs enables fitting more complex training data.</td></tr>
<tr><td align="center"><input checked="" name="q000011_opt2" type="checkbox" value="2"></td><td>Increasing the complexity of the network and increasing the number of training epochs typically leads to plateuing or decreasing validation performance.</td></tr>
</tbody></table><input id="q000011" name="q000011" type="hidden" value="{&quot;q000011_opt0&quot;:true,&quot;q000011_opt1&quot;:true,&quot;q000011_opt2&quot;:true}">
<script type="text/javascript">
var q000011_selected = {'q000011_opt0': true,'q000011_opt1': true,'q000011_opt2': true};
document.getElementById("q000011").value = JSON.stringify(q000011_selected);
document.querySelectorAll("input[type=checkbox][name^=q000011_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000011_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000011").value = JSON.stringify(q000011_selected);
    });
});
</script>
</div><div>
<span id="q000011_buttons">
<button class="submit btn btn-catsoop" id="q000011_submit" onclick="catsoop.submit('q000011');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000011_viewanswer" onclick="catsoop.viewanswer('q000011');" style="margin-top: 10px;">View Answer</button></span><span id="q000011_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000011',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000011',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000011_loading_wrapper">
<span id="q000011_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000011_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000011_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000011_solution_container">
<div id="q000011_solution">
</div>
<div id="q000011_solution_explanation">
</div>
</div>
<div id="q000011_message">
<script type="text/javascript">document.getElementById("q000011_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000011 -->
<a class="anchor" name="catsoop_section_4"></a><h2>4)  Weight sharing (OPTIONAL)</h2>
<p><script src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/showhide.js" type="text/javascript"></script>
<script type="text/javascript">
asw = add_showhide_ws("optional_ws_04");
</script></p>
<button style="font-size: 24px;" id="optional_ws_04_button">Show optional content</button><div id="optional_ws_04" style="display: none;">
<p>In the lab we <em>designed</em> a CNN that can count the number of objects in 1 dimensional images. The model's job was to take in an image and predict the number of objects that are in the image. Recall that each black pixel is represented by a value of 0 and each white pixel is represented by a value of 1. An object is a <b>consecutive sequence of black pixels</b> (<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>'s). For example, the sequence <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0100110</mn></mrow><annotation encoding="application/x-tex">0100110</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span></span></span></span></span> contains three objects. </p>
<p>In this problem we want to see how hard/easy it is to <em>train</em> such a network from data. Our network architecture will be as follows: </p>
<ul>
<li>
<p>The first layer is convolutional and you will implement it using the Keras <code>Conv1D</code> function, with a kernel of size 2 and stride of 1 with ReLu activation.</p>
</li>
<li>
<p>The second layer is a fully connected <code>Dense</code> layer which has a scalar output. </p>
</li>
</ul>
<p>Here is sample usage of the <code>Conv1D</code> and<code>Dense</code> layers. </p>
<p><code>layer1=keras.layers.Conv1D(filters=?, kernel_size=?, strides=?,use_bias=False, activation=?, batch_size=1, input_shape=?, padding='same')</code></p>
<p><code>Dense(units=?, activation=?, use_bias=False)</code></p>
<p>You need to fill in the parameters marked with <code>?</code> based on the problem specifications. Note also that in Keras, depending on your implementation, you may be forced to use <em>three</em> layers to implement such a network, where one intermediary <code>Flatten</code> layer is used to flatten the output of the convolutional layer, before being passed to the dense layer.</p>
<p>Refer to the <a href="https://keras.io/layers/convolutional/">Conv 1D</a>, <a href="https://keras.io/layers/core/">Dense</a> and <a href="https://keras.io/layers/core/#flatten">Flatten</a> descriptions in the Keras documentation to see the available parameter options.</p>
<p>In this exercise, we fix the structure and want to learn the best combination of weights from data. In the homework code, we have provided functions <code>train_neural_counter</code> and <code>get_image_data_1d</code>. You can use them to generate data and train the above neural network in Keras to answer the following questions. We assume that the images in our data set are randomly generated. The probability of a pixel being white is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.1</mn></mrow><annotation encoding="application/x-tex">0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span></span>. We work with mean squared error as the loss function for this problem. We have provided template code in the colab notebook, which you can fill in, to perform the training.</p>
<p><b>4A)</b> For this part, no coding is required. We call a <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> filter an <em>edge detector</em> if it has weights <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[-1,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> or <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[1,-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> (i.e., it can detect a left or right edge in a given image). We call it an <em>averaging filter</em> if takes average of nearby pixels. </p>
<p>Assume for this part only, that the second layer in our network is the sum function (i.e., all of its weights are equal to 1), which of the following filters would yield good "object counting" networks? You may assume that we are working with <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1024</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1024\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> images. </p>
<p>
<!--START question q000012 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000012" style="position: static">
<div id="q000012_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000012_opt0" type="checkbox" value="0"></td><td>Edge detector</td></tr>
<tr><td align="center"><input name="q000012_opt1" type="checkbox" value="1"></td><td>Averaging filter</td></tr>
<tr><td align="center"><input checked="" name="q000012_opt2" type="checkbox" value="2"></td><td>Some proper scaling of the averaging filter</td></tr>
<tr><td align="center"><input checked="" name="q000012_opt3" type="checkbox" value="3"></td><td>Averaging filter+a proper bias term at the output layer</td></tr>
</tbody></table><input id="q000012" name="q000012" type="hidden" value="{&quot;q000012_opt3&quot;:true,&quot;q000012_opt2&quot;:true,&quot;q000012_opt0&quot;:true}">
<script type="text/javascript">
var q000012_selected = {'q000012_opt3': true,'q000012_opt2': true,'q000012_opt0': true};
document.getElementById("q000012").value = JSON.stringify(q000012_selected);
document.querySelectorAll("input[type=checkbox][name^=q000012_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000012_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000012").value = JSON.stringify(q000012_selected);
    });
});
</script>
</div><div>
<span id="q000012_buttons">
<button class="submit btn btn-catsoop" id="q000012_submit" onclick="catsoop.submit('q000012');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000012_viewanswer" onclick="catsoop.viewanswer('q000012');" style="margin-top: 10px;">View Answer</button></span><span id="q000012_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000012',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000012',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000012_loading_wrapper">
<span id="q000012_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000012_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000012_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000012_solution_container">
<div id="q000012_solution">
</div>
<div id="q000012_solution_explanation">
</div>
</div>
<div id="q000012_message">
<script type="text/javascript">document.getElementById("q000012_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000012 -->
<p><b>4B)</b> What is (approximately) the expected loss of the network on <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1024</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1024\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> images if the convolutional layer is an averaging filter and second layer is the sum function (without a bias term)? (Note that you can answer the question theoretically or through coding, depending on your preference.)
<!--START question q000013 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000013" style="position: static">
<div id="q000013_rendered_question">
Enter a number: <input id="q000013" name="q000013" size="50" type="text" value="0.05">
</div><div>
<span id="q000013_buttons"></span><span id="q000013_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000013',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000013',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000013_loading_wrapper">
<span id="q000013_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000013_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000013_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div class="solution" id="q000013_solution_container">
<div id="q000013_solution">
<p>Solution: <tt>100</tt></p><p></p>
</div>
<div id="q000013_solution_explanation"><hr><p><b>Explanation:</b></p> There are two ways to solve this. One is to implement the above network and measure the quadratic loss empirically. You will see that it is close to 100. The other way is to estimate it theoretically. Roughly speaking, the network has a bias equal to the number of white blocks. Since it is rare to have more than two white pixels next to each other, the offset is roughly in the amount of the number of pairs of white pixels, of which there will be around 10 (why?). The square of the bias is 100 and this will dominate the quadratic loss. The code is provided below:
<pre>tsize=1000
imsize=1024
kernel_s=2
batch=1
data=get_image_data_1d(tsize,imsize,0.1)
(X_train,Y_train,X_val,Y_val,X_test,Y_test)=data
layer1=keras.layers.Conv1D(filters=1, kernel_size=kernel_s, strides=stride,use_bias=False,activation='relu',batch_size=batch,input_shape=(imsize,1),padding='same')
layer3=Dense(units=1, activation='linear',use_bias=False)
layers=[layer1,Flatten(),layer3]
model=Sequential()
for layer in layers:
    model.add(layer)
model.compile(loss='mse', optimizer=Adam())    
model.layers[0].set_weights([np.array([1/2,1/2]).reshape(2,1,1)])
model.layers[-1].set_weights([np.ones(imsize).reshape(imsize,1)])
model.evaluate(X_test,Y_test)
</pre>
</div>
</div>
<div id="q000013_message">
<script type="text/javascript">document.getElementById("q000013_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000013 -->
<p><b>4C)</b> Now suppose we add a bias term of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">-10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mord">0</span></span></span></span></span> to the last layer. What is (approximately) the expected quadratic loss? (Note that you can answer the question theoretically or through coding, depending on your preference.)</p>
<p>
<!--START question q000014 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000014" style="position: static">
<div id="q000014_rendered_question">
Enter a number: <input id="q000014" name="q000014" size="50" type="text" value="12">
</div><div>
<span id="q000014_buttons">
<button class="submit btn btn-catsoop" id="q000014_submit" onclick="catsoop.submit('q000014');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000014_viewanswer" onclick="catsoop.viewanswer('q000014');" style="margin-top: 10px;">View Answer</button></span><span id="q000014_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000014',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000014',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000014_loading_wrapper">
<span id="q000014_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000014_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000014_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000014_solution_container">
<div id="q000014_solution">
</div>
<div id="q000014_solution_explanation">
</div>
</div>
<div id="q000014_message">
<script type="text/javascript">document.getElementById("q000014_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000014 -->
<p><b>4D)</b> Averaging type filters are abundant and form a nearly flat valley of local minima for this problem. It is difficult for the network to find alternative solutions on its own. We need to force our way out of these bad minima and towards a better solution, i.e., an edge detector. To force the first layer to behave as an edge detector, we need to choose a proper <strong>kernel regularizer</strong>. Consider the following functions</p>
<p><span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">f_1=\sum_i |w_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04971em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">f_2=\sum_i |w_i^2|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.11382em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -2.44134em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>3</mn></msub><mo>=</mo><mi mathvariant="normal">∣</mi><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">f_3=|\sum_{i} w_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04971em; vertical-align: -0.29971em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span>. Which one of the choices is likely to guide the network to find an edge detector at the convolution layer?</p>
<p>
<!--START question q000015 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000015" style="position: static">
<div id="q000015_rendered_question">
Choose one: 
<select id="q000015" name="q000015">
<option value="-1">--</option>
<option value="0">f1</option>
<option value="1">f2</option>
<option selected="" value="2">f3</option></select>
</div><div>
<span id="q000015_buttons">
<button class="submit btn btn-catsoop" id="q000015_submit" onclick="catsoop.submit('q000015');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000015_viewanswer" onclick="catsoop.viewanswer('q000015');" style="margin-top: 10px;">View Answer</button></span><span id="q000015_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000015',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000015',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000015_loading_wrapper">
<span id="q000015_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000015_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000015_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000015_solution_container">
<div id="q000015_solution">
</div>
<div id="q000015_solution_explanation">
</div>
</div>
<div id="q000015_message">
<script type="text/javascript">document.getElementById("q000015_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000015 -->
<p>Implement your choice of regularizers from above in the code (complete the function <code>filter_reg</code>). Do not allow any bias in the layers for the rest of the problem. The code generates some random test and training data sets and trains the model on these data. Run a few learning trials (5 or more) for each data set and answer the following questions based on the performance of your model.</p>
<p><strong>IMPORTANT</strong>: When implementing <code>filter_reg</code>, you should use the keras backend operations, imported as "K" in the code. So for example, <code>K.sum</code> and <code>K.abs</code>, rather than <code>np.sum</code> and <code>np.abs</code>. This is because the <code>weights</code> argument is NOT a numpy object, but rather an internal Keras object!</p>
<p><b>4E)</b> For <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1024</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1024\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> images and training set of size <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1000</mn></mrow><annotation encoding="application/x-tex">1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span>, is the network <strong>without any regularization</strong> likely to find models that have a mean square error lower than 8 on the test data?
<!--START question q000016 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000016" style="position: static">
<div id="q000016_rendered_question">
Choose one: 
<select id="q000016" name="q000016">
<option value="-1">--</option>
<option value="0">Yes</option>
<option selected="" value="1">No</option></select>
</div><div>
<span id="q000016_buttons">
<button class="submit btn btn-catsoop" id="q000016_submit" onclick="catsoop.submit('q000016');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000016_viewanswer" onclick="catsoop.viewanswer('q000016');" style="margin-top: 10px;">View Answer</button></span><span id="q000016_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000016',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000016',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000016_loading_wrapper">
<span id="q000016_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000016_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000016_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000016_solution_container">
<div id="q000016_solution">
</div>
<div id="q000016_solution_explanation">
</div>
</div>
<div id="q000016_message">
<script type="text/javascript">document.getElementById("q000016_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000016 -->
<p><b>4F)</b> Repeat the same experiment, but now with the regularizer you implemented. Try different regularization parameters. Which choice of regularization parameter gives the best prediction results?
<!--START question q000017 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000017" style="position: static">
<div id="q000017_rendered_question">
Choose one: 
<select id="q000017" name="q000017">
<option value="-1">--</option>
<option value="0">0</option>
<option value="1">1</option>
<option value="2">10</option>
<option selected="" value="3">1000</option></select>
</div><div>
<span id="q000017_buttons">
<button class="submit btn btn-catsoop" id="q000017_submit" onclick="catsoop.submit('q000017');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000017_viewanswer" onclick="catsoop.viewanswer('q000017');" style="margin-top: 10px;">View Answer</button></span><span id="q000017_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000017',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000017',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000017_loading_wrapper">
<span id="q000017_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000017_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000017_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000017_solution_container">
<div id="q000017_solution">
</div>
<div id="q000017_solution_explanation">
</div>
</div>
<div id="q000017_message">
<script type="text/javascript">document.getElementById("q000017_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000017 -->
<p><b>4G)</b> With the above choice of regularization parameter, what is the mean square error of the best network that you find on the test data? Try a few trials (5 or more) for each data test and report the value of the best network.
<!--START question q000018 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000018" style="position: static">
<div id="q000018_rendered_question">
Enter a number: <input id="q000018" name="q000018" size="50" type="text" value="150">
</div><div>
<span id="q000018_buttons"></span><span id="q000018_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000018',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000018',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000018_loading_wrapper">
<span id="q000018_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000018_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000018_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div class="solution" id="q000018_solution_container">
<div id="q000018_solution">
<p>Solution: <tt>0.7</tt></p><p></p>
</div>
<div id="q000018_solution_explanation"><hr><p><b>Explanation:</b></p> This was the number we got averaged across several data sets with the best learned network.
</div>
</div>
<div id="q000018_message">
<script type="text/javascript">document.getElementById("q000018_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000018 -->
<p>We expect the training to be easier when there are fewer parameters to learn. Consider images of size <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">128\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> for the rest of the problem.</p>
<p><b>4H)</b> Instead of resorting to regularization again, we may instead find a way to reduce the number of parameters. What additional layer can you add to the output of the convolution layer to reduce the number of parameters to be learned without losing any relevant information?
<!--START question q000019 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000019" style="position: static">
<div id="q000019_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input name="q000019_opt0" type="checkbox" value="0"></td><td>One dropout layer</td></tr>
<tr><td align="center"><input name="q000019_opt1" type="checkbox" value="1"></td><td>One sparse linear layer</td></tr>
<tr><td align="center"><input name="q000019_opt2" type="checkbox" value="2"></td><td>One convolutional layer</td></tr>
<tr><td align="center"><input name="q000019_opt3" type="checkbox" value="3"></td><td>One max pooling layer with a window of size 4</td></tr>
<tr><td align="center"><input checked="" name="q000019_opt4" type="checkbox" value="4"></td><td>One max pooling layer with a window of size 2</td></tr>
</tbody></table><input id="q000019" name="q000019" type="hidden" value="{&quot;q000019_opt4&quot;:true}">
<script type="text/javascript">
var q000019_selected = {'q000019_opt4': true};
document.getElementById("q000019").value = JSON.stringify(q000019_selected);
document.querySelectorAll("input[type=checkbox][name^=q000019_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000019_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000019").value = JSON.stringify(q000019_selected);
    });
});
</script>
</div><div>
<span id="q000019_buttons">
<button class="submit btn btn-catsoop" id="q000019_submit" onclick="catsoop.submit('q000019');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000019_viewanswer" onclick="catsoop.viewanswer('q000019');" style="margin-top: 10px;">View Answer</button></span><span id="q000019_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000019',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000019',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000019_loading_wrapper">
<span id="q000019_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000019_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000019_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000019_solution_container">
<div id="q000019_solution">
</div>
<div id="q000019_solution_explanation">
</div>
</div>
<div id="q000019_message">
<script type="text/javascript">document.getElementById("q000019_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000019 -->
<p><b>4I)</b> Add the layer you suggested above to your network and run some tests with data sets of size 1000 on <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>128</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">128\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> images.  How many parameters are left to learn with the new structure?</p>
<p>
<!--START question q000020 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000020" style="position: static">
<div id="q000020_rendered_question">
Enter a number: <input id="q000020" name="q000020" size="50" type="text" value="130">
</div><div>
<span id="q000020_buttons"></span><span id="q000020_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000020',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 9 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000020',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 9 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000020_loading_wrapper">
<span id="q000020_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000020_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000020_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div class="solution" id="q000020_solution_container">
<div id="q000020_solution">
<p>Solution: <tt>66</tt></p><p></p>
</div>
<div id="q000020_solution_explanation"><hr><p><b>Explanation:</b></p> There are two parameters in the convolution layer. After pooling there are 64 pixels left.
</div>
</div>
<div id="q000020_message">
<script type="text/javascript">document.getElementById("q000020_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000020 -->
<p><b>4J)</b> Mark your observations on the two structures (not using regularization):
<!--START question q000021 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000021" style="position: static">
<div id="q000021_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000021_opt0" type="checkbox" value="0"></td><td>The overall accuracy improves with pooling compared to the previous structure</td></tr>
<tr><td align="center"><input checked="" name="q000021_opt1" type="checkbox" value="1"></td><td>It is more likely to learn an edge detector on 128 x 1 images with pooling</td></tr>
<tr><td align="center"><input checked="" name="q000021_opt2" type="checkbox" value="2"></td><td>It is more likely to learn a translation invariant network with pooling</td></tr>
<tr><td align="center"><input checked="" name="q000021_opt3" type="checkbox" value="3"></td><td>The old structure is more likely to find an edge detector on 128 x 1 images comparing to 1024x 1 images</td></tr>
</tbody></table><input id="q000021" name="q000021" type="hidden" value="{&quot;q000021_opt1&quot;:true,&quot;q000021_opt3&quot;:true,&quot;q000021_opt0&quot;:true,&quot;q000021_opt2&quot;:true}">
<script type="text/javascript">
var q000021_selected = {'q000021_opt1': true,'q000021_opt3': true,'q000021_opt0': true,'q000021_opt2': true};
document.getElementById("q000021").value = JSON.stringify(q000021_selected);
document.querySelectorAll("input[type=checkbox][name^=q000021_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000021_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000021").value = JSON.stringify(q000021_selected);
    });
});
</script>
</div><div>
<span id="q000021_buttons">
<button class="submit btn btn-catsoop" id="q000021_submit" onclick="catsoop.submit('q000021');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000021_viewanswer" onclick="catsoop.viewanswer('q000021');" style="margin-top: 10px;">View Answer</button></span><span id="q000021_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000021',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 10 in Section 4',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000021',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 10 in Section 4',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000021_loading_wrapper">
<span id="q000021_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000021_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000021_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000021_solution_container">
<div id="q000021_solution">
</div>
<div id="q000021_solution_explanation">
</div>
</div>
<div id="q000021_message">
<script type="text/javascript">document.getElementById("q000021_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000021 -->
</div><a class="anchor" name="catsoop_section_5"></a><h2>5) MNIST (Digit Classification)</h2>
<p>In this section, we'll be looking at the MNIST data set seen already in problem 2. This time, we look at the <em>complete</em> MNIST problem where our networks will take an image of <em>any</em> digit from <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>−</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">0-9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">9</span></span></span></span></span> as input (recall that problem 2 only looked at digits <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>) and try to predict that digit. Note that in general, an image is described as a two-dimensional array of pixels. Here, the image is a <a href="https://en.wikipedia.org/wiki/Grayscale">grayscale</a> image, so each pixel is represented by only one integer value, in the range <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> to <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>255</mn></mrow><annotation encoding="application/x-tex">255</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span></span></span></span></span> (compared to RGB images where each pixel is represented by three integer values, encoding intensity levels in red, green, and blue color channels).</p>
<p>Also, we will now use out-of-the-box neural network implementations using Keras and Tensorflow. State-of-the-art systems have error rates of less that 0.5% percent on this data set (see <a href="http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html#4d4e495354">this list</a>).  We'll be happy with an error rate less than 2% since we don't have all year...</p>
<p>You can access the MNIST data for this problem using:
<br><code>train, validation = get_MNIST_data()</code></p>
<p>You can run the fully connected MNIST model, using:
<br><code>run_keras_fc_mnist(train, validation, layers, epochs, split=0.1, trials=5)</code></p>
<p>And, you can run the CNN MNIST test, using:
<br><code>run_keras_cnn_mnist(train, validation, layers, epochs, split=0.1, trials=5)</code></p>
<p>For all following experiments, please run for 5 trials (use <code>trials=5</code>) and report the average accuracy.</p>
<p>A word of warning, if you have a machine with a single core and/or very little RAM, you'll be better off running on an Athena workstation. If your solutions are not being accepted, and you are confident in your approach, please use trials.</p>
<p>You will need to design your own <code>layers</code> to feed to <code>run_keras_fc_mnist</code> and <code>run_keras_cnn_mnist</code>, which will be different than the ones specified by <code>archs()</code>. For instance, <code>layers=[Dense(input_dim=64, units=4, activation="softmax")]</code> defines a single layer with 64 inputs, 4 output units, and softmax activation. Also, we advise you to use the option <code>verbose=True</code> when unsure about the progress made during training of your models.</p>
<p><b> 5A)</b> Look at the code and indicate what the difference is between <code>run_keras_fc_mnist</code> and <code>run_keras_cnn_mnist</code>?
<!--START question q000022 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000022" style="position: static">
<div id="q000022_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000022_opt0" type="checkbox" value="0"></td><td>The <tt>fc</tt> version uses images flattened into vectors.</td></tr>
<tr><td align="center"><input name="q000022_opt1" type="checkbox" value="1"></td><td>The <tt>fc</tt> version keeps the 2D structure of the images</td></tr>
<tr><td align="center"><input checked="" name="q000022_opt2" type="checkbox" value="2"></td><td>The <tt>cnn</tt> version keeps the 2D structure of the images</td></tr>
<tr><td align="center"><input checked="" name="q000022_opt3" type="checkbox" value="3"></td><td>The <tt>cnn</tt> version appends a dimension indicating there is one channel</td></tr>
</tbody></table><input id="q000022" name="q000022" type="hidden" value="{&quot;q000022_opt0&quot;:true,&quot;q000022_opt2&quot;:true,&quot;q000022_opt3&quot;:true}">
<script type="text/javascript">
var q000022_selected = {'q000022_opt0': true,'q000022_opt2': true,'q000022_opt3': true};
document.getElementById("q000022").value = JSON.stringify(q000022_selected);
document.querySelectorAll("input[type=checkbox][name^=q000022_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000022_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000022").value = JSON.stringify(q000022_selected);
    });
});
</script>
</div><div>
<span id="q000022_buttons">
<button class="submit btn btn-catsoop" id="q000022_submit" onclick="catsoop.submit('q000022');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000022_viewanswer" onclick="catsoop.viewanswer('q000022');" style="margin-top: 10px;">View Answer</button></span><span id="q000022_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000022',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000022',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000022_loading_wrapper">
<span id="q000022_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000022_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000022_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000022_solution_container">
<div id="q000022_solution">
</div>
<div id="q000022_solution_explanation">
</div>
</div>
<div id="q000022_message">
<script type="text/javascript">document.getElementById("q000022_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000022 -->
<p><b> 5B)</b> Using one epoch of training, what is the accuracy of a network <strong>with no hidden units</strong> (using the <code>run_keras_fc_mnist</code> method) on this data? Hint: this is expected to be terrible. If it's still not working, run for more trials. Remember to use 10 output units (the network predicts a digit from 0-9) and softmax activation!
<!--START question q000023 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000023" style="position: static">
<div id="q000023_rendered_question">
Enter a number between 0 and 1: <input id="q000023" name="q000023" size="50" type="text" value="0.6">
</div><div>
<span id="q000023_buttons">
<button class="submit btn btn-catsoop" id="q000023_submit" onclick="catsoop.submit('q000023');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000023_viewanswer" onclick="catsoop.viewanswer('q000023');" style="margin-top: 10px;">View Answer</button></span><span id="q000023_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000023',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000023',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000023_loading_wrapper">
<span id="q000023_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000023_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000023_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000023_solution_container">
<div id="q000023_solution">
</div>
<div id="q000023_solution_explanation">
</div>
</div>
<div id="q000023_message">
<script type="text/javascript">document.getElementById("q000023_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000023 -->
<p><b> 5C)</b> When creating the keras layer, pass in the following argument to Dense:
<code>kernel_initializer=VarianceScaling(scale=0.001, mode='fan_in', distribution='normal', seed=None)</code> and repeat the test.  What is the accuracy now?
<!--START question q000024 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000024" style="position: static">
<div id="q000024_rendered_question">
Enter a number between 0 and 1: <input id="q000024" name="q000024" size="50" type="text" value="0.7">
</div><div>
<span id="q000024_buttons">
<button class="submit btn btn-catsoop" id="q000024_submit" onclick="catsoop.submit('q000024');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000024_viewanswer" onclick="catsoop.viewanswer('q000024');" style="margin-top: 10px;">View Answer</button></span><span id="q000024_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000024',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000024',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000024_loading_wrapper">
<span id="q000024_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000024_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000024_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000024_solution_container">
<div id="q000024_solution">
</div>
<div id="q000024_solution_explanation">
</div>
</div>
<div id="q000024_message">
<script type="text/javascript">document.getElementById("q000024_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000024 -->
<p><b> 5D)</b> Now, linearly scale the data so that the pixel values are between 0 and 1 and repeat your test with the original layer (no VarianceScaling). What is the accuracy now?
<!--START question q000025 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000025" style="position: static">
<div id="q000025_rendered_question">
Enter a number between 0 and 1: <input id="q000025" name="q000025" size="50" type="text" value="0.88">
</div><div>
<span id="q000025_buttons">
<button class="submit btn btn-catsoop" id="q000025_submit" onclick="catsoop.submit('q000025');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000025_viewanswer" onclick="catsoop.viewanswer('q000025');" style="margin-top: 10px;">View Answer</button></span><span id="q000025_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000025',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000025',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000025_loading_wrapper">
<span id="q000025_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000025_score_display"><span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span></span>
<div class="nsubmits_left" id="q000025_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000025_solution_container">
<div id="q000025_solution">
</div>
<div id="q000025_solution_explanation">
</div>
</div>
<div id="q000025_message">
<script type="text/javascript">document.getElementById("q000025_score_display").innerHTML = '<span style="color:rgb(200,0,0);font-weight:bolder;">0.00%</span>';</script>
</div>
</div>
<!--END question q000025 -->
<p><b> 5E)</b> What is happening?
<!--START question q000026 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000026" style="position: static">
<div id="q000026_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000026_opt0" type="checkbox" value="0"></td><td><ol>
<li>Gradient descent algorithms are sensitive to the scale of the data.</li>
</ol></td></tr>
<tr><td align="center"><input checked="" name="q000026_opt1" type="checkbox" value="1"></td><td><ol start="2">
<li>When the scale of the initial weights was based (at least partly) on the scale of the data, performance improved.</li>
</ol></td></tr>
</tbody></table><input id="q000026" name="q000026" type="hidden" value="{&quot;q000026_opt1&quot;:true,&quot;q000026_opt0&quot;:true}">
<script type="text/javascript">
var q000026_selected = {'q000026_opt1': true,'q000026_opt0': true};
document.getElementById("q000026").value = JSON.stringify(q000026_selected);
document.querySelectorAll("input[type=checkbox][name^=q000026_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000026_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000026").value = JSON.stringify(q000026_selected);
    });
});
</script>
</div><div>
<span id="q000026_buttons">
<button class="submit btn btn-catsoop" id="q000026_submit" onclick="catsoop.submit('q000026');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000026_viewanswer" onclick="catsoop.viewanswer('q000026');" style="margin-top: 10px;">View Answer</button></span><span id="q000026_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000026',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000026',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 5 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000026_loading_wrapper">
<span id="q000026_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000026_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000026_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000026_solution_container">
<div id="q000026_solution">
</div>
<div id="q000026_solution_explanation">
</div>
</div>
<div id="q000026_message">
<script type="text/javascript">document.getElementById("q000026_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000026 -->
<br>
<b>Important: Always scale the data like in 5D) for subsequent problems.</b>
<p><b> 5F)</b> Using this same architecture, evaluate validation accuracy for number of training epochs in [5, 10, 15].
<!--START question q000027 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000027" style="position: static">
<div id="q000027_rendered_question">
Enter a list of three numbers between 0 and 1: <input id="q000027" name="q000027" size="50" type="text" value="">
</div><div>
<span id="q000027_buttons">
<button class="submit btn btn-catsoop" id="q000027_submit" onclick="catsoop.submit('q000027');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000027_viewanswer" onclick="catsoop.viewanswer('q000027');" style="margin-top: 10px;">View Answer</button></span><span id="q000027_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000027',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000027',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 6 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000027_loading_wrapper">
<span id="q000027_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000027_score_display"></span>
<div class="nsubmits_left" id="q000027_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000027_solution_container">
<div id="q000027_solution">
</div>
<div id="q000027_solution_explanation">
</div>
</div>
<div id="q000027_message"></div>
</div>
<!--END question q000027 -->
<p><b> 5G a)</b> With the validation accuracy that you just saw on per digit basis using <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>15</mn></mrow><annotation encoding="application/x-tex">15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">5</span></span></span></span></span> epochs, and assuming each digit is read independently from the others, what is the probability of reading a 5 digit zip code correctly?<br>
<!--START question q000028 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000028" style="position: static">
<div id="q000028_rendered_question">
Enter a number between 0 and 1: <input id="q000028" name="q000028" size="50" type="text" value="">
</div><div>
<span id="q000028_buttons">
<button class="submit btn btn-catsoop" id="q000028_submit" onclick="catsoop.submit('q000028');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000028_viewanswer" onclick="catsoop.viewanswer('q000028');" style="margin-top: 10px;">View Answer</button></span><span id="q000028_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000028',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000028',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 7 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000028_loading_wrapper">
<span id="q000028_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000028_score_display"></span>
<div class="nsubmits_left" id="q000028_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000028_solution_container">
<div id="q000028_solution">
</div>
<div id="q000028_solution_explanation">
</div>
</div>
<div id="q000028_message"></div>
</div>
<!--END question q000028 -->
<b> 5G b)</b> Now, assume that the accuracy is 0.9985, what is the probability of reading a zip code correctly?<br>
<!--START question q000029 -->
<div class="question question-pythonic" id="cs_qdiv_q000029" style="position: static">
<div id="q000029_rendered_question">
Enter a number between 0 and 1: <input id="q000029" name="q000029" size="50" type="text" value="">
</div><div>
<span id="q000029_buttons">
<button class="submit btn btn-catsoop" id="q000029_submit" onclick="catsoop.submit('q000029');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000029_viewanswer" onclick="catsoop.viewanswer('q000029');" style="margin-top: 10px;">View Answer</button></span><span id="q000029_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000029',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000029',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 8 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000029_loading_wrapper">
<span id="q000029_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000029_score_display"></span>
<div class="nsubmits_left" id="q000029_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000029_solution_container">
<div id="q000029_solution">
</div>
<div id="q000029_solution_explanation">
</div>
</div>
<div id="q000029_message"></div>
</div>
<!--END question q000029 -->

This is why people care about dropping the error rates to very low values.
<p><b> 5H)</b> Using one epoch of training, try a single hidden layer with ReLU and gradually increase the units; specifically, try (128, 256, 512, 1024) units and observe the results.  What are the accuracies?
<!--START question q000030 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000030" style="position: static">
<div id="q000030_rendered_question">
Enter a list of four numbers between 0 and 1, corresponding to 128, 256, 512, 1024 units: <input id="q000030" name="q000030" size="50" type="text" value="">
</div><div>
<span id="q000030_buttons">
<button class="submit btn btn-catsoop" id="q000030_submit" onclick="catsoop.submit('q000030');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000030_viewanswer" onclick="catsoop.viewanswer('q000030');" style="margin-top: 10px;">View Answer</button></span><span id="q000030_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000030',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 9 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000030',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 9 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000030_loading_wrapper">
<span id="q000030_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000030_score_display"></span>
<div class="nsubmits_left" id="q000030_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000030_solution_container">
<div id="q000030_solution">
</div>
<div id="q000030_solution_explanation">
</div>
</div>
<div id="q000030_message"></div>
</div>
<!--END question q000030 -->
<p><b> 5I)</b> Now, try a network with two layers, again using one epoch, with 512 units in the first hidden layer and and 256 units in the second hidden layer.  What is the accuracy?
<!--START question q000031 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000031" style="position: static">
<div id="q000031_rendered_question">
Enter a number between 0 and 1: <input id="q000031" name="q000031" size="50" type="text" value="">
</div><div>
<span id="q000031_buttons">
<button class="submit btn btn-catsoop" id="q000031_submit" onclick="catsoop.submit('q000031');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000031_viewanswer" onclick="catsoop.viewanswer('q000031');" style="margin-top: 10px;">View Answer</button></span><span id="q000031_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000031',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 10 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000031',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 10 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000031_loading_wrapper">
<span id="q000031_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000031_score_display"></span>
<div class="nsubmits_left" id="q000031_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000031_solution_container">
<div id="q000031_solution">
</div>
<div id="q000031_solution_explanation">
</div>
</div>
<div id="q000031_message"></div>
</div>
<!--END question q000031 -->
<p><b> 5J)</b> Build a convolutional network with the following structure:</p>
<ul>
<li> A convolutional layer with 32 filters of size 3 × 3, with a ReLU activation
</li><li> A max pooling layer with size 2 × 2
</li><li> A convolutional layer with 64 filters of size 3 × 3, with ReLU activation
</li><li> A max pooling layer with size 2 × 2
</li><li> A flatten layer
</li><li> A fully connected layer with 128 neurons, with ReLU activation
</li><li> A dropout layer with drop probability 0.5
</li><li> A fully-connected layer with 10 neurons with softmax
</li></ul>
<p>Train it on MNIST for one epoch, using <code>run_keras_cnn_mnist</code>.  What is the accuracy on the validation set?
<!--START question q000032 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000032" style="position: static">
<div id="q000032_rendered_question">
Enter a number between 0 and 1: <input id="q000032" name="q000032" size="50" type="text" value="">
</div><div>
<span id="q000032_buttons">
<button class="submit btn btn-catsoop" id="q000032_submit" onclick="catsoop.submit('q000032');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000032_viewanswer" onclick="catsoop.viewanswer('q000032');" style="margin-top: 10px;">View Answer</button></span><span id="q000032_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000032',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 11 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000032',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 11 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000032_loading_wrapper">
<span id="q000032_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000032_score_display"></span>
<div class="nsubmits_left" id="q000032_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000032_solution_container">
<div id="q000032_solution">
</div>
<div id="q000032_solution_explanation">
</div>
</div>
<div id="q000032_message"></div>
</div>
<!--END question q000032 -->

If you have time to run the training for more epochs, try it, you should see improvement.
<p><b> 5K)</b> Now, let's compare the performance of a fully connected model and a CNN on data where the characters have been shifted randomly so that they are no longer centered.  Below are some examples of the original and shifted characters.
</p><div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/three_center.png" width="15%"> <img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/three_shift.png" width="15%">
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/eight_center.png" width="15%"> <img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/eight_shift.png" width="15%">
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/four_center.png" width="15%"> <img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw08/four_shift.png" width="15%">
</center>
</div>
You can build such a data set by calling: <code>train_20, validation_20 = get_MNIST_data(shift=20)</code>. Remember to scale it appropriately.
<b>Note that each image is now 48x48, so you will need to change your layer definitions</b>.
Run your two-hidden-layer FC architecture from above (problem 5I) on this data and then run the CNN architecture from above (problem 5J), both for one epoch. Report your results.
<!--START question q000033 -->
<div class="question question-pythonic" id="cs_qdiv_q000033" style="position: static">
<div id="q000033_rendered_question">
Enter a list of two numbers between 0 and 1: <input id="q000033" name="q000033" size="50" type="text" value="">
</div><div>
<span id="q000033_buttons">
<button class="submit btn btn-catsoop" id="q000033_submit" onclick="catsoop.submit('q000033');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000033_viewanswer" onclick="catsoop.viewanswer('q000033');" style="margin-top: 10px;">View Answer</button></span><span id="q000033_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000033',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 12 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000033',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 12 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000033_loading_wrapper">
<span id="q000033_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000033_score_display"></span>
<div class="nsubmits_left" id="q000033_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000033_solution_container">
<div id="q000033_solution">
</div>
<div id="q000033_solution_explanation">
</div>
</div>
<div id="q000033_message"></div>
</div>
<!--END question q000033 -->
<p><b> 5L)</b> Some possible conclusions:
<!--START question q000034 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000034" style="position: static">
<div id="q000034_rendered_question">
Mark all that are true: <table border="0">
<tbody><tr><td align="center"><input checked="" name="q000034_opt0" type="checkbox" value="0"></td><td>Increasing the complexity of the network and training it for many epochs generally enables fitting more complex training data.</td></tr>
<tr><td align="center"><input name="q000034_opt1" type="checkbox" value="1"></td><td>Increasing the complexity of the network and training it for many epochs generally enables fitting more complex validation data.</td></tr>
<tr><td align="center"><input checked="" name="q000034_opt2" type="checkbox" value="2"></td><td>The convolutional and max pooling layers of the CNN enable it to recognize the presence of a digit anywhere in  the image</td></tr>
<tr><td align="center"><input name="q000034_opt3" type="checkbox" value="3"></td><td>A fully connected network cannot recognize the presence of a digit anywhere in  the image.</td></tr>
<tr><td align="center"><input checked="" name="q000034_opt4" type="checkbox" value="4"></td><td>It generally takes more data (compared to a CNN) to train a fully connected network to recognize the presence of a digit anywhere in  the image, since each location is essentially a new pattern.</td></tr>
</tbody></table><input id="q000034" name="q000034" type="hidden" value="{&quot;q000034_opt0&quot;:true,&quot;q000034_opt2&quot;:true,&quot;q000034_opt4&quot;:true}">
<script type="text/javascript">
var q000034_selected = {'q000034_opt0': true,'q000034_opt2': true,'q000034_opt4': true};
document.getElementById("q000034").value = JSON.stringify(q000034_selected);
document.querySelectorAll("input[type=checkbox][name^=q000034_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000034_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000034").value = JSON.stringify(q000034_selected);
    });
});
</script>
</div><div>
<span id="q000034_buttons">
<button class="submit btn btn-catsoop" id="q000034_submit" onclick="catsoop.submit('q000034');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000034_viewanswer" onclick="catsoop.viewanswer('q000034');" style="margin-top: 10px;">View Answer</button></span><span id="q000034_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000034',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 13 in Section 5',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000034',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 13 in Section 5',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000034_loading_wrapper">
<span id="q000034_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000034_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000034_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000034_solution_container">
<div id="q000034_solution">
</div>
<div id="q000034_solution_explanation">
</div>
</div>
<div id="q000034_message">
<script type="text/javascript">document.getElementById("q000034_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
</div>
</div>
<!--END question q000034 -->
<p><script src="/queue/fall18/js/queue.js"></script>
<script>
    catsoop.plugins.queue = {
        url_root: '/queue/fall18/',
        is_staff: false,
        container: "body",
        view: 'student_popup',
        room: 'default',
    };
    </script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
catsoop.all_questions = ['q000000', 'q000001', 'q000002', 'q000003', 'network', 'batch_norm', 'q000004', 'q000005', 'q000006', 'q000007', 'q000008', 'q000009', 'q000010', 'q000011', 'q000012', 'q000013', 'q000014', 'q000015', 'q000016', 'q000017', 'q000018', 'q000019', 'q000020', 'q000021', 'q000022', 'q000023', 'q000024', 'q000025', 'q000026', 'q000027', 'q000028', 'q000029', 'q000030', 'q000031', 'q000032', 'q000033', 'q000034'];
catsoop.username = 'AlexandrParkhomenko';
catsoop.api_token = 'ou3PvadLMR1zwQVIhEQLlWt6elMqlxph2gVU1xhXjyyRUXW4QMJ8O3E5H1HxxhLq0PFguf';
catsoop.this_path = 'https://introml_oll.odl.mit.edu/cat-soop/6.036/homework/hw08';
catsoop.path_info = ['6.036', 'homework', 'hw08'];
catsoop.course = '6.036';
catsoop.url_root = 'https://introml_oll.odl.mit.edu/cat-soop';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";
</script></p>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
      This page was last updated on Saturday January 18, 2020 at 01:56:46 PM (revision <code>064bd78</code>).<br>&nbsp;<br>Sec None Release 1900-01-01 00:00:00 Due 9999-12-31 23:59:59<br><script type="text/javascript">document.getElementById("cs_header").style.display="none";</script>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v14.0.0.dev144.<br>
      CAT-SOOP is <a href="http://www.fsf.org/about/what-is-free-software" target="_blank">free/libre software</a>, available under the terms<br>of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://introml_oll.odl.mit.edu/cat-soop/_util/source.zip?course=6.036" target="_blank">Download Source Code</a><br>
<a href="https://introml_oll.odl.mit.edu/cat-soop/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</footer>



<div style="clear: both; display: block;"></div></body></html>


