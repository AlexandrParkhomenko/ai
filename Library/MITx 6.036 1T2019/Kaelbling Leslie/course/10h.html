<html><head>
<!-- This page was generated by CAT-SOOP 14.0.0.dev144.  miau. -->
<meta charset="utf-8">
<title>6.036 Spring 2019</title>
<link href="data:image/gif;base64,R0lGODlhEAAQAKEAAAAAAAAzZv///wAAACH5BAEKAAMALAAAAAAQABAAAAIynI85oL3A3IFARFehlcvW3XyaR5XiJ6Tqmo6sOsZoS2viets0XJ+vzCoFXS8Yw4SkDAoAOw==" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/themes/base.css" rel="stylesheet" type="text/css">
<!-- librejs compatibility -->
<script>
    /*
    @licstart  The following is the entire license notice for the JavaScript
    code in this page.

    The Javascript on this page is part of CAT-SOOP
    Copyright (C) 2011-2019 by The CAT-SOOP Developers <catsoop-dev@mit.edu>

    The Javascript code on this page is free software: you can redistribute it
    and/or modify it under the terms of the GNU Affero General Public License
    as published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.  This code is distributed
    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE.  See the full text of the license for<html><head>
<!-- This page was generated by CAT-SOOP 14.0.0.dev144.  miau. -->
<meta charset="utf-8">
<title>6.036 Spring 2019</title>
<link href="data:image/gif;base64,R0lGODlhEAAQAKEAAAAAAAAzZv///wAAACH5BAEKAAMALAAAAAAQABAAAAIynI85oL3A3IFARFehlcvW3XyaR5XiJ6Tqmo6sOsZoS2viets0XJ+vzCoFXS8Yw4SkDAoAOw==" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/themes/base.css" rel="stylesheet" type="text/css">
<!-- librejs compatibility -->
<script>
    /*
    @licstart  The following is the entire license notice for the JavaScript
    code in this page.

    The Javascript on this page is part of CAT-SOOP
    Copyright (C) 2011-2019 by The CAT-SOOP Developers <catsoop-dev@mit.edu>

    The Javascript code on this page is free software: you can redistribute it
    and/or modify it under the terms of the GNU Affero General Public License
    as published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.  This code is distributed
    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE.  See the full text of the license for
    more details (https://www.gnu.org/licenses/agpl-3.0.en.html).

    As additional permission under GNU AGPL version 3 section 7, you may
    distribute non-source (e.g., minimized or compacted) forms of that code
    without the copy of the GNU AGPL normally required by section 4, provided
    you include this license notice and a URL through which recipients can
    access the Corresponding Source.

    @licend  The above is the entire license notice for the JavaScript code in
    this page.
    */
    </script>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    document.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });
    </script>
<!-- load in katex and mathjax, and CAT-SOOP-specific math rendering  -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css">
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/mathjax/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/cs_math.js" type="text/javascript"></script>
<!-- Syntax Highlighting -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/highlight/cs_highlight.pack.min.js" type="text/javascript"></script>
<script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
<style>
      :root {
        --cs-base-bg-color: #00bfff;
        --cs-light-bg-color: #32cbff;
        --cs-base-font-color: #ffffff;
        --cs-light-font-color: #000;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.3/iframeResizer.contentWindow.min.js" type="text/javascript"></script><link href="/queue/fall18/css/queue.css" rel="stylesheet">
<!--JS for questions-->
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script>
<meta content="width=device-width, initial-scale=1" name="viewport">
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/mode-python.js"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body style="margin: 0px;">
<header id="cs_header" style="display: none;">
<div class="nav-container">
<div class="cs_header_text"><a href="https://introml_oll.odl.mit.edu/cat-soop/6.036"></a></div>
<a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<center><h1></h1></center>
<p>A code directory that will be useful for doing this homework can
be found <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/code_for_hw10.zip"><strong>here</strong></a>.  Download
this to your computer. Or alternatively, use the <a href="https://colab.research.google.com/drive/1HxoDioZjhFDfP6FA3EvSdY30QLOPFl_7"><strong>colab notebook</strong></a>.</p>
<a class="anchor" name="catsoop_section_1"></a><h2>1) Exploration</h2>
<p>In this problem, we will work with the "tiny" MDP from exercises ex09
(repeated below for convenience), and we will look at the effects of
exploration on the success of Q-learning.</p>
<p>Consider an MDP with states (0, 1, 2, 3), actions ('b', 'c'). The reward function is:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi><mo>=</mo><mn>1</mn></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi><mo>=</mo><mn>3</mn></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">R(s,a) = \begin{cases} 1&amp;amp; \text{if $s=1$} \\ 2&amp;amp; \text{if $s=3$} \\ 0&amp;amp; \text{otherwise} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.00773em;" class="mord mathdefault">R</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.32em; vertical-align: -1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35002em;"><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -4.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.41em;"><span class="" style="top: -4.41em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.97em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -1.53em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.91em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.41em;"><span class="" style="top: -4.41em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span></span></span></span><span class="" style="top: -2.97em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">3</span></span></span></span><span class="" style="top: -1.53em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.91em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>
You get the reward associated with a state on the step when you exit that state. The transition function for each action is below, where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>[</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">T[i,x,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">]</span></span></span></span></span> is the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>j</mi><mi mathvariant="normal">∣</mi><mi>a</mi><mo>=</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(s_{t+1}=j | a=x, s_t=i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>.
<div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><mtext>’b’</mtext><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T(s_t, \text{&amp;#x27;b&amp;#x27;}, s_{t+1})= \begin{bmatrix} 0.0 &amp;amp; 0.9 &amp;amp; 0.1 &amp;amp; 0.0 \\ 0.9 &amp;amp; 0.1 &amp;amp; 0.0 &amp;amp; 0.0 \\ 0.0 &amp;amp; 0.0 &amp;amp; 0.1 &amp;amp; 0.9 \\ 0.9 &amp;amp; 0.0 &amp;amp; 0.0 &amp;amp; 0.1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">’b’</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80204em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><mtext>’c’</mtext><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T(s_t, \text{&amp;#x27;c&amp;#x27;}, s_{t+1})= \begin{bmatrix} 0.0 &amp;amp; 0.1 &amp;amp; 0.9 &amp;amp; 0.0 \\ 0.9 &amp;amp; 0.1 &amp;amp; 0.0 &amp;amp; 0.0 \\ 0.0 &amp;amp; 0.0 &amp;amp; 0.1 &amp;amp; 0.9 \\ 0.9 &amp;amp; 0.0 &amp;amp; 0.0 &amp;amp; 0.1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">’c’</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80204em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></div>
Note that the <strong>only</strong> effect of the action is to change the transition probability in state 0 (the first row of the transition matrix).<p></p>
<p>Consider the two plots below.  In both cases, the x-axis is the number
of steps of Q-learning, plotted in 1000's (so the actual number of
steps is 60,000).</p>
<ol>
<li>
<p>In the first plot, the y-axis is the <i>max norm difference</i>
between the optimal Q function, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>, and the learned Q
function, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14121em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mi>max</mi><mo>⁡</mo><mrow><mi>s</mi><mo separator="true">,</mo><mi>a</mi></mrow></munder><mo>∣</mo><msup><mi>Q</mi><mo>∗</mo></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>−</mo><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>∣</mo></mrow><annotation encoding="application/x-tex">\max_{s, a} \lvert Q^{\ast}(s, a) - \hat{Q}(s, a) \rvert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.58611em; vertical-align: -0.836108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em;"><span class="" style="top: -2.1em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">a</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836108em;"><span class=""></span></span></span></span></span><span class="mopen">∣</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.19677em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">∣</span></span></span></span></span></div><p></p>
</li>
<li>
<p>In the second plot, the y-axis is the average per-step reward,
averaged over 1000 steps.</p>
</li>
</ol>
<div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/QLGraph.png"> <img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/QLReturn.png">
</center>
</div>
<p>Our epsilon-greedy action-selection strategy at each iteration, when in state <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span>, is:</p>
<ul>
<li>flip a coin that lands heads with probability <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">1-\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span></li>
<li>if it lands heads, greedily select the best action under <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14121em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span> (the current Q-value estimates): <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow><msub><mi>max</mi><mo>⁡</mo><mi>a</mi></msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">{\rm arg} \max_a \hat{Q}(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.19677em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span style="margin-right: 0.01389em;" class="mord mathrm">g</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span></li>
<li>if it lands tails, select an action uniformly at random, for exploration purposes</li>
</ul>
<p>In each plot, we have used a different value of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span>:</p>
<ul>
<li>0.00 : Blue</li>
<li>0.05 : Green</li>
<li>0.10 : Red</li>
<li>0.25 : Cyan</li>
<li>0.50 : Magenta</li>
<li>1.00 : Yellow</li>
</ul>
<p>Here are some points about the algorithm:</p>
<ol>
<li>
<p>When there's a tie between action values, our implementation of
argmax always returns the first element, which in this case is action 'b'.</p>
</li>
<li>
<p>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal
due to the exploration.</p>
</li>
<li>
<p>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal
behavior (if we don't explore) is that the relative <b>ordering</b> of
action values is correct.</p>
</li>
<li>
<p>For any state, it is necessary to execute action 'c' from that state
some number of times before its estimated Q-value is higher than the
estimated Q-value for action 'b' from that state.</p>
</li>
</ol>
<p>For each of the following observations about the plots, mark all the points
listed above that are relevant to (helps explain) that observation.</p>
<p><b>1A)</b>
The blue line is perfectly constant in plot 1 and roughly constant in plot 2.

<!--START question q000000 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000000" style="position: static">
<div id="q000000_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000000_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000000_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000000_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000000_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000000" name="q000000" type="hidden" value="{}">
<script type="text/javascript">
var q000000_selected = {};
document.getElementById("q000000").value = JSON.stringify(q000000_selected);
document.querySelectorAll("input[type=checkbox][name^=q000000_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000000_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000000").value = JSON.stringify(q000000_selected);
    });
});
</script>
</div><div>
<span id="q000000_buttons">
<button class="submit btn btn-catsoop" id="q000000_submit" onclick="catsoop.submit('q000000');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000000_viewanswer" onclick="catsoop.viewanswer('q000000');" style="margin-top: 10px;">View Answer</button></span><span id="q000000_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000000_loading_wrapper">
<span id="q000000_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000000_score_display"></span>
<div class="nsubmits_left" id="q000000_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000000_solution_container">
<div id="q000000_solution">
</div>
<div id="q000000_solution_explanation">
</div>
</div>
<div id="q000000_message"></div>
</div>
<!--END question q000000 -->
<p><b>1B)</b>
The yellow line goes down the fastest in plot 1, but doesn't have the best performance in plot 2.
<!--START question q000001 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000001_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000001_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000001_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000001_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000001" name="q000001" type="hidden" value="{}">
<script type="text/javascript">
var q000001_selected = {};
document.getElementById("q000001").value = JSON.stringify(q000001_selected);
document.querySelectorAll("input[type=checkbox][name^=q000001_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000001_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000001").value = JSON.stringify(q000001_selected);
    });
});
</script>
</div><div>
<span id="q000001_buttons">
<button class="submit btn btn-catsoop" id="q000001_submit" onclick="catsoop.submit('q000001');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000001_viewanswer" onclick="catsoop.viewanswer('q000001');" style="margin-top: 10px;">View Answer</button></span><span id="q000001_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000001_score_display"></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message"></div>
</div>
<!--END question q000001 -->
<p><b>1C)</b>
The red line goes down slowly in plot 1, and leaps up in the middle of plot 2.
<!--START question q000002 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000002_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000002_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000002_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000002_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000002" name="q000002" type="hidden" value="{}">
<script type="text/javascript">
var q000002_selected = {};
document.getElementById("q000002").value = JSON.stringify(q000002_selected);
document.querySelectorAll("input[type=checkbox][name^=q000002_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000002_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000002").value = JSON.stringify(q000002_selected);
    });
});
</script>
</div><div>
<span id="q000002_buttons">
<button class="submit btn btn-catsoop" id="q000002_submit" onclick="catsoop.submit('q000002');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000002_viewanswer" onclick="catsoop.viewanswer('q000002');" style="margin-top: 10px;">View Answer</button></span><span id="q000002_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000002_score_display"></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message"></div>
</div>
<!--END question q000002 -->
<p><b>1D)</b>
The magenta, cyan, red, and green lines each leap up at some point (each one after the other) in the average rewards plot.
<!--START question q000003 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000003" style="position: static">
<div id="q000003_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000003_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000003_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000003_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000003_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000003" name="q000003" type="hidden" value="{}">
<script type="text/javascript">
var q000003_selected = {};
document.getElementById("q000003").value = JSON.stringify(q000003_selected);
document.querySelectorAll("input[type=checkbox][name^=q000003_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000003_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000003").value = JSON.stringify(q000003_selected);
    });
});
</script>
</div><div>
<span id="q000003_buttons">
<button class="submit btn btn-catsoop" id="q000003_submit" onclick="catsoop.submit('q000003');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000003_viewanswer" onclick="catsoop.viewanswer('q000003');" style="margin-top: 10px;">View Answer</button></span><span id="q000003_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000003_loading_wrapper">
<span id="q000003_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000003_score_display"></span>
<div class="nsubmits_left" id="q000003_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000003_solution_container">
<div id="q000003_solution">
</div>
<div id="q000003_solution_explanation">
</div>
</div>
<div id="q000003_message"></div>
</div>
<!--END question q000003 -->
<a class="anchor" name="catsoop_section_2"></a><h2>2) Implement Q-Learning</h2>
<p>We'll work up to implementing the Q-learning algorithm by extending our code from HW9. The code is reproduced here (detailed definition is in the code file):</p>
<p></p><pre>class MDP:
    def __init__(self, states, actions, transition_model, reward_fn,
                     discount_factor = 1.0, start_dist = None):
        # states: list or set of states
        # actions: list or set of actions
        # transition_model: function from (state, action) into DDist over next state
        # reward_fn: function from (state, action) to real-valued reward
        # discount_factor: real, greater than 0, less than or equal to 1
        # start_dist: optional instance of DDist, specifying initial state dist
        #    if it's unspecified, we'll use a uniform over states
    def terminal(self, s):
        # Given a state, return True if the state should be considered to
        # be terminal.  You can think of a terminal state as generating an
        # infinite sequence of zero reward.
    def init_state(self):
        # Return an initial state by drawing from the distribution over start states.
    def sim_transition(self, s, a):
        # Simulates a transition from the given state, s and action a, using the
        # transition model as a probability distribution.  If s is terminal,
        # use init_state to draw an initial state.  Returns (reward, new_state)

class TabularQ:
    def __init__(self, states, actions):
        self.actions = actions
        self.states = states
        self.q = dict([((s, a), 0.0) for s in states for a in actions])
    def copy(self):
        q_copy = TabularQ(self.states, self.actions)
        q_copy.q.update(self.q)
        return q_copy
    def set(self, s, a, v):
        self.q[(s,a)] = v
    def get(self, s, a):
        return self.q[(s,a)]
</pre>
<p><a class="anchor" name="catsoop_section_2_1"></a></p><h3>2.1) Q update</h3><p></p>
<p>First, we'll extend our implementation of the <tt>TabularQ</tt> class 
in <a href="https://introml.odl.mit.edu/cat-soop/6.036/homework/hw09">HW 9</a> 
(Problem 5) to incorporate the crucial operation of Q-learning, 
which is to update the Q value for a given <tt>(s,a)</tt> entry and move 
it part of the way towards a "target" value <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span></span>.</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>←</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Q(s,a) \leftarrow (1-\alpha) Q(s,a) + \alpha t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mclose">)</span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mord mathdefault">t</span></span></span></span></span></div><p></p>
<p>Note that this can also be written as:</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>←</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mo>(</mo><mi>t</mi><mo>−</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a) \leftarrow Q(s,a) + \alpha (t - Q(s,a))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></div><p></p>
<p>That is, move a small (<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span></span></span></span></span>) step towards <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span></span>.</p>
<p>Let's define a new method for <tt>TabularQ</tt> that implements this,
in a batched form.  We will be given a list of <tt>(s, a, t)</tt> triples and
have to do all the updates.  Note that <code>update</code> is a method of the
<code>TabularQ</code> class, so you can access the other methods and attributes.</p>
<ul>
<li> <code>data</code> is a list of <tt>(s, a, t)</tt> tuples.</li>
<li> <code>lr</code> is a learning rate (<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span></span></span></span></span> above)</li>
<li> We will have to update <tt>self.q[(s,a)]</tt> for all of the data.</li>
</ul>
<p>Here is an example of how to test <code>update</code>:
</p><pre>&gt;&gt;&gt; q = TabularQ([0,1,2,3],['b','c'])
&gt;&gt;&gt; q.update([(0, 'b', 50), (2, 'c', 30)], 0.5)
&gt;&gt;&gt; q.get(0, 'b')
25.0
&gt;&gt;&gt; q.get(2, 'c')
15.0
</pre>
<p>
<!--START question TabularQ -->
</p><div class="question question-pythoncode" id="cs_qdiv_TabularQ" style="position: static">
<div id="TabularQ_rendered_question">
<div class="ace_editor_wrapper" id="containerTabularQ" style="height: 280px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorTabularQ" name="editorTabularQ" style="font-size: 16px; height: 280px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 38px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 318px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div></div><div class="ace_gutter-active-line" style="top: 38px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 318px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:38px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">update</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">data</span>, <span class="ace_identifier">lr</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 38px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 57px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="TabularQ" name="TabularQ" type="hidden" value="def update(self, data, lr):
    # Your code here
    pass">
<input id="TabularQ_log" name="TabularQ_log" type="hidden">
<script type="text/javascript">
    var logTabularQ = new Array();
    var editorTabularQ = ace.edit("editorTabularQ");
    editorTabularQ.setTheme("ace/theme/textmate");
    editorTabularQ.getSession().setMode("ace/mode/python");
    editorTabularQ.setShowFoldWidgets(false);
    editorTabularQ.setValue('def update(self, data, lr):\n    # Your code here\n    pass')
    document.getElementById("TabularQ").value = editorTabularQ.getValue();
    editorTabularQ.on("change",function(e){
        editorTabularQ.getSession().setUseSoftTabs(true);
        document.getElementById("TabularQ").value = editorTabularQ.getValue();
    });
    editorTabularQ.clearSelection()
    editorTabularQ.getSession().setUseSoftTabs(true);
    editorTabularQ.on("paste",function(txt){editorTabularQ.getSession().setUseSoftTabs(false);});
    editorTabularQ.getSession().setTabSize(4);
    editorTabularQ.setFontSize("16px");
    document.getElementById("containerTabularQ").style.height = "280px";
    document.getElementById("editorTabularQ").style.height = "280px";
    editorTabularQ.resize(true);
</script>
</div><div>
<span id="TabularQ_buttons">
<button class="check btn btn-catsoop" id="TabularQ_check" onclick="catsoop.check('TabularQ');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="TabularQ_submit" onclick="catsoop.submit('TabularQ');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="TabularQ_viewanswer" onclick="catsoop.viewanswer('TabularQ');" style="margin-top: 10px;">View Answer</button></span><span id="TabularQ_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'TabularQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'TabularQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="TabularQ_loading_wrapper">
<span id="TabularQ_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="TabularQ_score_display"></span>
<div class="nsubmits_left" id="TabularQ_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="TabularQ_solution_container">
<div id="TabularQ_solution">
</div>
<div id="TabularQ_solution_explanation">
</div>
</div>
<div id="TabularQ_message"></div>
</div>
<!--END question TabularQ -->
<p><a class="anchor" name="catsoop_section_2_2"></a></p><h3>2.2) Q_learn</h3><p></p>
<p>Complete the definition of the <tt>Q_learn</tt> function.  It should
update the entries in the <tt>q</tt> function, <tt>(s, a)</tt>,
towards their estimated Q values.  It should terminate after
<tt>iters</tt> iterations and use learning rate <tt>lr</tt>. Use the
<code>q.update</code> method, which you just wrote, to update the Q values.</p>
<p>You will need to both simulate the agent's trajectory through the
space as well as perform the updates to the Q function estimates.  In
this version, you should update the Q values after every transition,
using a single <tt>(s, a, t)</tt> tuple.  <strong>The following methods and functions have already been defined for you.</strong>
</p><ul>
<li> To start a new simulation, call <tt>mdp.init_state()</tt>.
That will draw a state from the MDP's initial state distribution.  </li>
<li> You can use the functions that we defined in HW 9:
<tt>epsilon_greedy</tt> for action
selection (<tt>epsilon_greedy</tt> takes <tt>(q, s, eps = 0.5)</tt> as input and returns an action), <strong> and </strong> <tt>value</tt> takes <tt>(q, s)</tt> and returns the max Q value for a state.</li>
<li> To take a step in the simulation, starting in a given state,
<tt>s</tt>, using action <tt>a</tt>, call
<tt>mdp.sim_transition(s,a)</tt>.  It will return a pair <tt>(r,
s_prime)</tt> denoting the reward received by the agent at that step
and the next state.</li>
<li> To get the discount factor in your code, you can use <tt>mdp.discount_factor</tt>.</li>
<li> Be careful in treating terminal states.  Recall that at a terminal
state, there may be an immediate reward (i.e. allow for reward <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">r</span></span></span></span></span>) but the future expected value
will be zero (e.g. <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> or drop the term with <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span></span></span></span></span>).  Also, simulations may restart with the initial state 
subsequent to reaching a terminal state (so don't latch a terminal condition).</li>
<li> Return <code>q</code> so that the Tutor can test it.</li>
</ul>
<p>Locally, or in colab, you should be able to pass <tt>draw=True</tt> in the test
functions to see a policy learned by the algorithm playing the game No Exit.</p>
<p>For testing, we can also set up a tiny MDP problem as follows (and use this to test 2.2 - 3.1):</p>
<p></p><pre>def tinyTerminal(s):
    return s==4
def tinyR(s, a):
    if s == 1: return 1
    elif s == 3: return 2
    else: return 0
def tinyTrans(s, a):
    if s == 0:
        if a == 'a':
            return DDist({1 : 0.9, 2 : 0.1})
        else:
            return DDist({1 : 0.1, 2 : 0.9})
    elif s == 1:
        return DDist({1 : 0.1, 0 : 0.9})
    elif s == 2:
        return DDist({2 : 0.1, 3 : 0.9})
    elif s == 3:
        return DDist({3 : 0.1, 0 : 0.5, 4 : 0.4})
    elif s == 4:
        return DDist({4 : 1.0})
</pre>
<p>We can use this to test <code>Q_learn</code> as follows:</p>
<p></p><pre>def testQ():
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = TabularQ(tiny.states, tiny.actions)
    qf = Q_learn(tiny, q)
    return list(qf.q.items())

&gt;&gt;&gt; random.seed(0)
&gt;&gt;&gt; testQ()
[((0, 'a'), 0.6649739221724159), ((0, 'b'), 0.1712369526453748), ((1, 'a'), 0.7732751316011999), ((1, 'b'), 1.2034912054227331), ((2, 'a'), 0.37197205380133874), ((2, 'b'), 0.45929063274463033), ((3, 'a'), 1.5156163024818292), ((3, 'b'), 0.8776852768653631), ((4, 'a'), 0.0), ((4, 'b'), 0.0)]
</pre>
<p>
<!--START question QLearn -->
</p><div class="question question-pythoncode" id="cs_qdiv_QLearn" style="position: static">
<div id="QLearn_rendered_question">
<div class="ace_editor_wrapper" id="containerQLearn" style="height: 280px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorQLearn" name="editorQLearn" style="font-size: 16px; height: 280px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 95px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 318px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div></div><div class="ace_gutter-active-line" style="top: 95px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 318px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:95px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">Q_learn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mdp</span>, <span class="ace_identifier">q</span>, <span class="ace_identifier">lr</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.1</span>, <span class="ace_identifier">iters</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">100</span>, <span class="ace_identifier">eps</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.5</span>, <span class="ace_identifier">interactive_fn</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">None</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">iters</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># include this line in the iteration, where i is the iteration number</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">interactive_fn</span>: <span class="ace_identifier">interactive_fn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">q</span>, <span class="ace_identifier">i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 95px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 114px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="QLearn" name="QLearn" type="hidden" value="def Q_learn(mdp, q, lr=.1, iters=100, eps = 0.5, interactive_fn=None):
    # Your code here
    for i in range(iters):
        # include this line in the iteration, where i is the iteration number
        if interactive_fn: interactive_fn(q, i)
    pass">
<input id="QLearn_log" name="QLearn_log" type="hidden">
<script type="text/javascript">
    var logQLearn = new Array();
    var editorQLearn = ace.edit("editorQLearn");
    editorQLearn.setTheme("ace/theme/textmate");
    editorQLearn.getSession().setMode("ace/mode/python");
    editorQLearn.setShowFoldWidgets(false);
    editorQLearn.setValue('def Q_learn(mdp, q, lr=.1, iters=100, eps = 0.5, interactive_fn=None):\n    # Your code here\n    for i in range(iters):\n        # include this line in the iteration, where i is the iteration number\n        if interactive_fn: interactive_fn(q, i)\n    pass')
    document.getElementById("QLearn").value = editorQLearn.getValue();
    editorQLearn.on("change",function(e){
        editorQLearn.getSession().setUseSoftTabs(true);
        document.getElementById("QLearn").value = editorQLearn.getValue();
    });
    editorQLearn.clearSelection()
    editorQLearn.getSession().setUseSoftTabs(true);
    editorQLearn.on("paste",function(txt){editorQLearn.getSession().setUseSoftTabs(false);});
    editorQLearn.getSession().setTabSize(4);
    editorQLearn.setFontSize("16px");
    document.getElementById("containerQLearn").style.height = "280px";
    document.getElementById("editorQLearn").style.height = "280px";
    editorQLearn.resize(true);
</script>
</div><div>
<span id="QLearn_buttons">
<button class="check btn btn-catsoop" id="QLearn_check" onclick="catsoop.check('QLearn');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="QLearn_submit" onclick="catsoop.submit('QLearn');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="QLearn_viewanswer" onclick="catsoop.viewanswer('QLearn');" style="margin-top: 10px;">View Answer</button></span><span id="QLearn_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearn',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearn',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="QLearn_loading_wrapper">
<span id="QLearn_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="QLearn_score_display"></span>
<div class="nsubmits_left" id="QLearn_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="QLearn_solution_container">
<div id="QLearn_solution">
</div>
<div id="QLearn_solution_explanation">
</div>
</div>
<div id="QLearn_message"></div>
</div>
<!--END question QLearn -->
<p>Below, assume this <tt>update</tt> method has been defined.</p>
<p><a class="anchor" name="catsoop_section_2_3"></a></p><h3>2.3) Batch Q_learn</h3><p></p>
<p>In the standard Q-learning algorithm, we make one epsilon-greedy
transition based on the current Q estimate and then update the Q
values.  You can think of this as being like stochastic gradient
descent.  We can also define a version that is more like batch
gradient descent, where we generate one or more "episodes" (sequences
of transitions) using the current Q values and then update the Q
values based on all the observed results.  We can also keep around old
transitions and use them (all or a random subset) in the update as
well. <strong>Note that as our Q value estimate evolves, the target Q value
computed from a previously observed transition can change.</strong></p>
<p>Implement this version of batch Q-learning that (a) generates some
specifed number of episodes of a given length (see
<code>sim_episode</code> below), (b) adds these to the experiences we
have seen previously, and (c) updates the Q estimates based on <strong>all
the experience so far</strong>.  Return <code>q</code> so that the Tutor can
test it.</p>
<p></p><pre>def sim_episode(mdp, episode_length, policy, draw=False):
    '''
    Simulate an episode (sequence of transitions) of at most
    episode_length, using policy function to select actions.  If we find
    a terminal state, end the episode.  Return accumulated reward a list
    of (s, a, r, s') where s' is None for transition from terminal state.
    Also return an animation if draw=True, or None if draw=False
    '''
    episode = []
    reward = 0
    s = mdp.init_state()
    all_states = [s]
    for i in range(episode_length):
        a = policy(s)
        (r, s_prime) = mdp.sim_transition(s, a)
        reward += r
        if mdp.terminal(s):
            episode.append((s, a, r, None))
            break
        episode.append((s, a, r, s_prime))
        if draw: 
            mdp.draw_state(s)
        s = s_prime
        all_states.append(s)
    animation = animate(all_states, mdp.n, episode_length) if draw else None
    return reward, episode, animation
</pre>
<p>This definition is already available for you.  Note that
<tt>sim_episode</tt> can return tuples with <tt>s_prime = None</tt>.</p>
<p><b>Clarifications</b> </p><ul> <li> There should be a SINGLE call to
<code>q.update</code> per iteration, not per episode or per experience.  Just one
call per iteration, with a lot of data.</li> <li> Let's understand the
distinction between experiences <tt>(s, a, r, s')</tt> and Q targets
<tt>(s, a, t)</tt>. Note that experiences don't depend on the current
estimated Q values (only on the environment we are acting in), but the
"t" in the Q targets depends on the current Q values. So, it makes
sense to store experiences across iterations, but not to store Q
targets, since the Q targets change when we update our Q values. Thus,
you want to continuously aggregate the experience and then, in each
iteration, re-compute the Q targets under the current estimated Q
values, then do the update with all of these Q targets. Here's
pseudocode:</li> </ul>
<p></p><pre>all_experiences = []
Loop over n_iterations:
    Loop over n_episodes:
        Generate an episode of length episode_length, append this experience to all_experiences
    all_q_targets = []
    Loop over all_experiences:
        Append Q target from one experience to all_q_targets
        Remember to handle terminal states (where s' = None)
    q.update(all_q_targets, lr)
return q
</pre>
<p>We can use our tiny MDP example above to test <code>Q_learn_batch</code> as follows:</p>
<p></p><pre>def testBatchQ():
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = TabularQ(tiny.states, tiny.actions)
    qf = Q_learn_batch(tiny, q)
    return list(qf.q.items())

&gt;&gt;&gt; random.seed(0)
&gt;&gt;&gt; testBatchQ()
[((0, 'a'), 4.7566600197286535), ((0, 'b'), 3.993296047838986), ((1, 'a'), 5.292467934685342), ((1, 'b'), 5.364014782870985), ((2, 'a'), 4.139537149779127), ((2, 'b'), 4.155347555640753), ((3, 'a'), 4.076532544818926), ((3, 'b'), 4.551442974149778), ((4, 'a'), 0.0), ((4, 'b'), 0.0)]
</pre>
<p>
<!--START question QLearnBatch -->
</p><div class="question question-pythoncode" id="cs_qdiv_QLearnBatch" style="position: static">
<div id="QLearnBatch_rendered_question">
<div class="ace_editor_wrapper" id="containerQLearnBatch" style="height: 400px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorQLearnBatch" name="editorQLearnBatch" style="font-size: 16px; height: 400px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 133px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 438px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div></div><div class="ace_gutter-active-line" style="top: 133px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 438px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:133px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">Q_learn_batch</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mdp</span>, <span class="ace_identifier">q</span>, <span class="ace_identifier">lr</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.1</span>, <span class="ace_identifier">iters</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">100</span>, <span class="ace_identifier">eps</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.5</span>,</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_identifier">episode_length</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">10</span>, <span class="ace_identifier">n_episodes</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">2</span>,</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">interactive_fn</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">None</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">iters</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># include this line in the iteration, where i is the iteration number</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">interactive_fn</span>: <span class="ace_identifier">interactive_fn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">q</span>, <span class="ace_identifier">i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 133px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 152px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="QLearnBatch" name="QLearnBatch" type="hidden" value="def Q_learn_batch(mdp, q, lr=.1, iters=100, eps=0.5,
                                   episode_length=10, n_episodes=2,
                  interactive_fn=None):
    # Your code here
    for i in range(iters):
        # include this line in the iteration, where i is the iteration number
        if interactive_fn: interactive_fn(q, i)
    pass">
<input id="QLearnBatch_log" name="QLearnBatch_log" type="hidden">
<script type="text/javascript">
    var logQLearnBatch = new Array();
    var editorQLearnBatch = ace.edit("editorQLearnBatch");
    editorQLearnBatch.setTheme("ace/theme/textmate");
    editorQLearnBatch.getSession().setMode("ace/mode/python");
    editorQLearnBatch.setShowFoldWidgets(false);
    editorQLearnBatch.setValue('def Q_learn_batch(mdp, q, lr=.1, iters=100, eps=0.5,\n                                   episode_length=10, n_episodes=2,\n                  interactive_fn=None):\n    # Your code here\n    for i in range(iters):\n        # include this line in the iteration, where i is the iteration number\n        if interactive_fn: interactive_fn(q, i)\n    pass')
    document.getElementById("QLearnBatch").value = editorQLearnBatch.getValue();
    editorQLearnBatch.on("change",function(e){
        editorQLearnBatch.getSession().setUseSoftTabs(true);
        document.getElementById("QLearnBatch").value = editorQLearnBatch.getValue();
    });
    editorQLearnBatch.clearSelection()
    editorQLearnBatch.getSession().setUseSoftTabs(true);
    editorQLearnBatch.on("paste",function(txt){editorQLearnBatch.getSession().setUseSoftTabs(false);});
    editorQLearnBatch.getSession().setTabSize(4);
    editorQLearnBatch.setFontSize("16px");
    document.getElementById("containerQLearnBatch").style.height = "400px";
    document.getElementById("editorQLearnBatch").style.height = "400px";
    editorQLearnBatch.resize(true);
</script>
</div><div>
<span id="QLearnBatch_buttons">
<button class="check btn btn-catsoop" id="QLearnBatch_check" onclick="catsoop.check('QLearnBatch');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="QLearnBatch_submit" onclick="catsoop.submit('QLearnBatch');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="QLearnBatch_viewanswer" onclick="catsoop.viewanswer('QLearnBatch');" style="margin-top: 10px;">View Answer</button></span><span id="QLearnBatch_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearnBatch',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearnBatch',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="QLearnBatch_loading_wrapper">
<span id="QLearnBatch_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="QLearnBatch_score_display"></span>
<div class="nsubmits_left" id="QLearnBatch_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="QLearnBatch_solution_container">
<div id="QLearnBatch_solution">
</div>
<div id="QLearnBatch_solution_explanation">
</div>
</div>
<div id="QLearnBatch_message"></div>
</div>
<!--END question QLearnBatch -->
<a class="anchor" name="catsoop_section_3"></a><h2>3) NNQ: Using neural networks to store the Q function</h2>
<p>We would like to operate in large or continuous state and/or action
spaces so it is not possible (or effective) to store the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></span> values in
a table as we did with the <tt>TabularQ</tt> class; instead, we will
"store" them by training a neural network to do regression for us,
taking <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo separator="true">,</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">s,a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span></span></span></span></span> as input and generating (an approximation of) <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^*(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span>
as output.</p>
<p>To train the network, we will use <i>squared Bellman error</i> as
the loss function:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mo fence="true">(</mo><mrow><mo fence="true">[</mo><mi>R</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>γ</mi><munder><mi>max</mi><mo>⁡</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup></munder><mi>Q</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">;</mo><mi>θ</mi><mo>)</mo><mo fence="true">]</mo></mrow><mo>−</mo><mi>Q</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">;</mo><mi>θ</mi><mo>)</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\left(\left[R(s_t, a_t) + \gamma \max_{a&amp;#x27;} Q(s_{t+1}, a&amp;#x27;; \theta)\right] - Q(s_t, a_t;\theta) \right)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.09799em; vertical-align: -0.74398em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">[</span></span><span style="margin-right: 0.00773em;" class="mord mathdefault">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em;"><span class="" style="top: -2.05602em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.74398em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">]</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div>
where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span></span></span></span></span> stands for the current weights in the neural network
and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">;</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s, a; \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span></span></span></span></span> stands for the output of the network with
weights <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span></span></span></span></span> when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> is the input.<p></p>
<p>There are many choices of neural network architecture for storing Q
values.  In this problem, we will:</p>
<ul>
<li> Focus on the case where we have a small set of possible actions,
so make one neural network for each possible action <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">a</span></span></span></span></span>;

</li><li> Design that network with two <b>hidden</b> layers with ReLU units
and a single linear output unit (although a deeper network could be
useful); and

</li><li> Use mean squared error (MSE) as the loss function since, we are
predicting continuous <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></span> values, which is a regression
problem.

</li></ul>
<p>To use a neural net to store Q values, for a given action, we will
need to have a mapping from states to fixed-length vectors.  We will
assume that the <code>MDP</code> class has a <code>state2vec</code>
method that maps states to vectors.  For the simple discrete-state
MDPs we have seen so far, this simply returns a one-hot representation
of the state. For reference, this is our implementation of
<code>state2vec</code> (note the shape of its returned array):
</p><pre>    def state2vec(self, s):
        '''
        Return one-hot encoding of state s; used in neural network agent implementations
        '''
        v = np.zeros((1, len(self.states)))
        v[0,self.states.index(s)] = 1.
        return v
</pre>
<p>Now, all we need to do is write a new class, called <code>NNQ</code>
to implement neural-network version of Q-function storage; then we can
pass an <code>NNQ</code> instance instead of a <code>TabularQ</code> instance
into <code>Q_learn</code> or <code>Q_learn_batch</code>, and
we will automatically have reinforcement learning with neural
networks!</p>
<p>There are three methods to implement in our <code>NNQ</code>
class. Here are some ideas for how to do that:
</p><ul>
<li> <code>__init__</code>: Create one neural network for each action,
and store them in <tt>self.models</tt>. Note that <tt>actions</tt> is
a list that may consist of integers or strings or other objects.  As a
reminder, here's how to make a new feed-forward network using Keras
(you can assume this <code>make_nn</code> procedure exists and can be called
by your code):
<pre>def make_nn(state_dim, num_hidden_layers, num_units):
    '''
    state_dim = (int) number of states
    num_hidden_layers = (int) number of fully connected hidden layers
    num_units = (int) number of dense relu units to use in hidden layers
    '''
    model = Sequential()
    model.add(Dense(num_units, input_dim = state_dim, activation='relu'))
    for i in range(num_hidden_layers-1):
        model.add(Dense(num_units, activation='relu'))
    model.add(Dense(1, activation='linear'))
    model.compile(loss='mse', optimizer=Adam())
    return model
</pre>
</li>
<li> <code>get(self, s, a)</code>: Use the neural network you have
stored for action <code>a</code> to predict a Q value for state
<code>s</code>. Feel free to consult documentation on the 
<a href="https://keras.io/models/model/#predict">Keras model predict</a>
method.</li>
<li> <code>update(self, data, lr, epochs = 1)</code>: As in
<code>TabularQ</code>, <code>data</code> is a list of <code>(s, a,t)</code> 
tuples, where <code>t</code> is a target Q value.  For each
action <code>a</code>, you will need to:

  <ul>
<li> Construct a training set <code>X, Y</code> of data that is
  relevant to action <code>a</code>, where the input values are states
  (encoded as vectors) and the output values are the target Q values;</li>
<p></p><li> Use the Keras method <code>fit(self, X, Y, epochs=epochs)</code> 
  to update the weights in th e associated network.  You can ignore
  the <tt>lr</tt> input parameter, and let Adam in keras manage the
  learning rate.</li>
</ul>
</li>
</ul>
<p>We can use our tiny MDP example above to test the <code>NNQ</code>
class as follows (note: the answers may differ numerically, but you
should get the same structure in terms of data structure and length):</p>
<p></p><pre>def test_NNQ(data):
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = NNQ(tiny.states, tiny.actions, tiny.state2vec, 2, 10)
    q.update(data, 1)
    return [q.get(s,a) for s in q.states for a in q.actions]

&gt;&gt;&gt; test_NNQ([(0,'a',0.3),(1,'a',0.1),(0,'a',0.1),(1,'a',0.5)])
[array([[-0.07211456]]), array([[-0.19553234]]), array([[-0.21926211]]), array([[0.01699455]]), array([[-0.26390356]]), array([[0.06374809]]), array([[0.0340214]]), array([[-0.18334733]]), array([[-0.438375]]), array([[-0.13844737]])]
</pre>
<p>
<!--START question NNQ -->
</p><div class="question question-pythoncode" id="cs_qdiv_NNQ" style="position: static">
<div id="NNQ_rendered_question">
<div class="ace_editor_wrapper" id="containerNNQ" style="height: 600px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorNNQ" name="editorNNQ" style="font-size: 16px; height: 600px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 165.6px; top: 228px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 624px; width: 46px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div><div class="ace_gutter-cell " style="height: 19px;">9</div><div class="ace_gutter-cell " style="height: 19px;">10</div><div class="ace_gutter-cell " style="height: 19px;">11</div><div class="ace_gutter-cell " style="height: 19px;">12</div><div class="ace_gutter-cell " style="height: 19px;">13</div></div><div class="ace_gutter-active-line" style="top: 228px; height: 19px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 14px;"><div class="ace_content" style="margin-top: 0px; width: 817px; height: 624px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:228px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">NNQ</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">states</span>, <span class="ace_identifier">actions</span>, <span class="ace_identifier">state2vec</span>, <span class="ace_identifier">num_layers</span>, <span class="ace_identifier">num_units</span>, <span class="ace_identifier">epochs</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">actions</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">actions</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">states</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">states</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">epochs</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">state2vec</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">state2vec</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">models</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language">None</span>              <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">get</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">s</span>, <span class="ace_identifier">a</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">update</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">data</span>, <span class="ace_identifier">lr</span>, <span class="ace_identifier">epochs</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 119.6px; top: 228px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 14px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 247px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="height: 19px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 817px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="NNQ" name="NNQ" type="hidden" value="class NNQ:
    def __init__(self, states, actions, state2vec, num_layers, num_units, epochs=1):
        self.actions = actions
        self.states = states
        self.epochs = epochs
        self.state2vec = state2vec
        self.models = None              # Your code here
    def get(self, s, a):
        # Your code here
        pass
    def update(self, data, lr, epochs=1):
        # Your code here
        pass">
<input id="NNQ_log" name="NNQ_log" type="hidden">
<script type="text/javascript">
    var logNNQ = new Array();
    var editorNNQ = ace.edit("editorNNQ");
    editorNNQ.setTheme("ace/theme/textmate");
    editorNNQ.getSession().setMode("ace/mode/python");
    editorNNQ.setShowFoldWidgets(false);
    editorNNQ.setValue('class NNQ:\n    def __init__(self, states, actions, state2vec, num_layers, num_units, epochs=1):\n        self.actions = actions\n        self.states = states\n        self.epochs = epochs\n        self.state2vec = state2vec\n        self.models = None              # Your code here\n    def get(self, s, a):\n        # Your code here\n        pass\n    def update(self, data, lr, epochs=1):\n        # Your code here\n        pass')
    document.getElementById("NNQ").value = editorNNQ.getValue();
    editorNNQ.on("change",function(e){
        editorNNQ.getSession().setUseSoftTabs(true);
        document.getElementById("NNQ").value = editorNNQ.getValue();
    });
    editorNNQ.clearSelection()
    editorNNQ.getSession().setUseSoftTabs(true);
    editorNNQ.on("paste",function(txt){editorNNQ.getSession().setUseSoftTabs(false);});
    editorNNQ.getSession().setTabSize(4);
    editorNNQ.setFontSize("16px");
    document.getElementById("containerNNQ").style.height = "600px";
    document.getElementById("editorNNQ").style.height = "600px";
    editorNNQ.resize(true);
</script>
</div><div>
<span id="NNQ_buttons">
<button class="check btn btn-catsoop" id="NNQ_check" onclick="catsoop.check('NNQ');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="NNQ_submit" onclick="catsoop.submit('NNQ');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="NNQ_viewanswer" onclick="catsoop.viewanswer('NNQ');" style="margin-top: 10px;">View Answer</button></span><span id="NNQ_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'NNQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'NNQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="NNQ_loading_wrapper">
<span id="NNQ_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="NNQ_score_display"></span>
<div class="nsubmits_left" id="NNQ_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="NNQ_solution_container">
<div id="NNQ_solution">
</div>
<div id="NNQ_solution_explanation">
</div>
</div>
<div id="NNQ_message"></div>
</div>
<!--END question NNQ -->
<a class="anchor" name="catsoop_section_4"></a><h2>4) No Exit</h2>
<p><a class="anchor" name="catsoop_section_4_1"></a></p><h3>4.1) Storing Q vs. Learning Updates</h3>
At this point, we have implemented the following:<p></p>
<ul>
<li>We have two ways of storing Q functions:  TabularQ and NNQ</li>
<li>We have two ways of doing Q-learning updates:  Q_learn and Q_learn_batch</li>
</ul>
<p>When we combine NNQ and Q_learn, we get what people often call "Deep Q
Learning". When we combine NNQ and Q_learn_batch we get what people
often call "Fitted Q learning".</p>
<p>The reason that we use only one epoch in Deep Q is that we, right now,
only have a single training example in our hands; if we used a lot of
epochs, we would be telling the NN to predict that one example
correctly, at the cost of potentially forgetting everything else. That
would result in unstable training.</p>
<p>In Fitted Q, on the other hand, we have a large set of training
examples, for many states, that we think "cover" the state space. We
can train a new NN from scratch with all of this data, just to learn
to approximate the value function.  Fitted Q can be thought of as being a lot
like value iteration: We have a Q function, we use it to compute a
bunch of new target values, then we fit a whole new Q function to
those values, etc.</p>
<p><a class="anchor" name="catsoop_section_4_2"></a></p><h3>4.2) Learning to Play</h3><p></p>
<p>In this part, we are going to test these various methods using a very
simple game we call <i>No Exit</i>, that you experienced in the
lab. It's like Breakout, but you can't break out. There is a purple
ball that bounces around a square environment and a yellow paddle that
can be controlled to move up and down on the rightmost side. If the
ball sails past the paddle then the game is over, and enters a
zero-reward absorbing state.  Otherwise, there is a reward of +1 for
every action taken.  There is a small amount of randomness in the way
the ball bounces, so it's not completely deterministic.</p>
<p>You can see it working by loading <code>code_for_hw10.py</code> and
running <tt>test_solve_play()</tt> and just hitting return to watch a
policy that was found using value iteration and the known
model. <b>But, first, you will need to paste in all the definitions
that are incomplete in <code>mdp10.py</code></b>.</p>
<p>The raw representation of a state, for the purposes of No Exit, is
</p><pre>((ball_row, ball_column), (ball_row_velocity, ball_column_velocity), paddle_row, paddle_row_velocity)
</pre>
with a special state for <tt>game_over</tt>.  There is a method
<tt>state2vec</tt> which will take a state of the game and return a
seven-dimensional numpy row vector (the last feature indicates whether
the game is over) which you can use as an input vector for Keras.
<p>In the code file <code>mdp10.py</code> that we have provided, you will
need to paste in the definitions of functions such as for
<code>value_iteration</code> from HW 09 and <code>Q_learn</code> and
<code>Q_learn_batch</code> from this assignment. In order to implement this we have added an additional <code>interactive_fn</code> argument to both <code>Q_learn</code> and <code>Q_learn_batch</code>.</p>
<p>At the end of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/code_for_hw10.zip"><code>code_for_hw10.py<code></code></code></a> file are a set of commented test cases that run the
various approaches for learning the game.
</p><ul>
<li> Value Iteration - using an explicit model of the MDP
</li><li> Q-learning - using a tabular representation in Q_learn
</li><li> Batch Q-learning - using a tabular representation in Q_learn_batch
</li><li> NN Q-learning - using neural nets to approximate Q in Q_learn
</li><li> Fitted Q-learning - using neural nets to approximate Q in Q_learn_batch
</li></ul>
<p><b>For each of the learning method and Q model combinations below,
solve the game so that it reliably gets to reward of 100 (that is, the
learned game reliably plays 100 steps without missing the ball,
earning a score of 100).  During learning, you should see a sequence
of lines like: <code>score (5000, 37.5)</code>, which indicates that
after 5000 iterations the average reward over 10 games is 37.5.  We
are checking whether you reach a solution that gets an average reward
100 at least one time. Try playing around with the number of
iterations (an argument to <code>test_learn_play</code>) until you
achieve this point. Note that we will need fewer iterations for
Q_learn_batch, in general (check yourself: why?). After learning, the
code prints a long "upload string" in HEX code.  Enter the upload
strings in the question boxes below.
</b></p>
<p>If you do not see the <tt>score</tt> printouts it's because you did not
call the <tt>interactive_fn</tt> at every iteration.  Look at the code
for <tt>Q_learn</tt> originally provided in the zip file to see
how this should be done.</p>
<p><b>Optional -- viewing game play:</b> The code is set up so that by
default it doesn't bother displaying the game play after the training
is completed. But if you'd like to see the game play, you can!  First,
if you want to see the optimal policy in action based on the Q from
value iteration, run <code>test_solve_play(draw=True)</code> and you
can watch it go.  Hit 'return' after each step.  Similarly, for the
cases involving Q learning (rather than value iteration), you can pass
the argument <code>draw = True</code> into
<code>test_learn_play()</code>, along with the other arguments that
determine the learning approach. Warning: many people have broken
<tt>matplotlib</tt> installations and will not be able to see the
game. Don't panic; it's purely optional to see the game play.</p>
<p><b>Note on computation time</b>: the training stage can take a relatively long time 
(sometimes tens of minutes) for the
default dimension of the game, <code>d = 6</code>. For debugging, you
might pass smaller values such as <code>d = 4</code> into the
<code>test_solve_play</code> or <code>test_learn_play</code>
functions.</p>
<p>Once submitted, the questions below print the decoded
information in the pasted-in string. This consists of a list
of three elements: boolean (True if TabularQ is used, False if NNQ is used);
boolean (True if batch Q_learn_batch is used, False if Q_learn is used);
a list of (iteration_number, score) tuples resulting during learning. A
successful submission will have a 100.0 score achieved during the learning.</p>
<p><b>4A)</b>
<!--START question q000004 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000004" style="position: static">
<div id="q000004_rendered_question">
Enter the string printed by tabular Q_learn: <input id="q000004" name="q000004" size="50" type="text" value="">
</div><div>
<span id="q000004_buttons">
<button class="submit btn btn-catsoop" id="q000004_submit" onclick="catsoop.submit('q000004');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000004_viewanswer" onclick="catsoop.viewanswer('q000004');" style="margin-top: 10px;">View Answer</button></span><span id="q000004_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000004_loading_wrapper">
<span id="q000004_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000004_score_display"></span>
<div class="nsubmits_left" id="q000004_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000004_solution_container">
<div id="q000004_solution">
</div>
<div id="q000004_solution_explanation">
</div>
</div>
<div id="q000004_message"></div>
</div>
<!--END question q000004 -->
<p><b>4B)</b>
<!--START question q000005 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000005" style="position: static">
<div id="q000005_rendered_question">
Enter the string printed by tabular Q_learn_batch: <input id="q000005" name="q000005" size="50" type="text" value="">
</div><div>
<span id="q000005_buttons">
<button class="submit btn btn-catsoop" id="q000005_submit" onclick="catsoop.submit('q000005');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000005_viewanswer" onclick="catsoop.viewanswer('q000005');" style="margin-top: 10px;">View Answer</button></span><span id="q000005_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000005_loading_wrapper">
<span id="q000005_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000005_score_display"></span>
<div class="nsubmits_left" id="q000005_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000005_solution_container">
<div id="q000005_solution">
</div>
<div id="q000005_solution_explanation">
</div>
</div>
<div id="q000005_message"></div>
</div>
<!--END question q000005 -->
<p><b>4C)</b>
<!--START question q000006 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000006" style="position: static">
<div id="q000006_rendered_question">
Enter the string printed by NNQ Q_learn: <input id="q000006" name="q000006" size="50" type="text" value="">
</div><div>
<span id="q000006_buttons">
<button class="submit btn btn-catsoop" id="q000006_submit" onclick="catsoop.submit('q000006');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000006_viewanswer" onclick="catsoop.viewanswer('q000006');" style="margin-top: 10px;">View Answer</button></span><span id="q000006_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000006_loading_wrapper">
<span id="q000006_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000006_score_display"></span>
<div class="nsubmits_left" id="q000006_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000006_solution_container">
<div id="q000006_solution">
</div>
<div id="q000006_solution_explanation">
</div>
</div>
<div id="q000006_message"></div>
</div>
<!--END question q000006 -->
<p><b>4D)</b>
<!--START question q000007 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000007" style="position: static">
<div id="q000007_rendered_question">
Enter the string printed by Fitted Q_learn (NNQ in Q_learn_batch): <input id="q000007" name="q000007" size="50" type="text" value="">
</div><div>
<span id="q000007_buttons">
<button class="submit btn btn-catsoop" id="q000007_submit" onclick="catsoop.submit('q000007');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000007_viewanswer" onclick="catsoop.viewanswer('q000007');" style="margin-top: 10px;">View Answer</button></span><span id="q000007_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000007_loading_wrapper">
<span id="q000007_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000007_score_display"></span>
<div class="nsubmits_left" id="q000007_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000007_solution_container">
<div id="q000007_solution">
</div>
<div id="q000007_solution_explanation">
</div>
</div>
<div id="q000007_message"></div>
</div>
<!--END question q000007 -->
<p>With this experience in hand, you might compare how many iterations are
needed to reliably get to something that gets reward of 100, for each
of the learning algorithm (Q_learn and Q_learn_batch) and Q model (TabularQ and
NNQ) combinations. Think about why more or fewer iterations are required
in these different cases.</p>
<a class="anchor" name="catsoop_section_5"></a><h2>5) Optional Challenges</h2>
<p>There are a lot of possible extensions!!!</p>
<ul>
<li> You can try bigger game instances.
</li><li> You can change the ball speed.
</li><li> You can change the game behavior.
</li><li> You can try different network architectures, e.g. one network with multiple outputs, one for each action.
</li><li> You can try to use a CNN using the board directly as an image input.  Talk to a staff member for pointers on how to do this.
</li></ul>
<p><script src="/queue/fall18/js/queue.js"></script>
<script>
    catsoop.plugins.queue = {
        url_root: '/queue/fall18/',
        is_staff: false,
        container: "body",
        view: 'student_popup',
        room: 'default',
    };
    </script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
catsoop.all_questions = ['q000000', 'q000001', 'q000002', 'q000003', 'TabularQ', 'QLearn', 'QLearnBatch', 'NNQ', 'q000004', 'q000005', 'q000006', 'q000007'];
catsoop.username = 'AlexandrParkhomenko';
catsoop.api_token = 'ou3PvadLMR1zwQVIhEQLlWt6elMqlxph2gVU1xhXjyyRUXW4QMJ8O3E5H1HxxhLq0PFguf';
catsoop.this_path = 'https://introml_oll.odl.mit.edu/cat-soop/6.036/homework/hw10';
catsoop.path_info = ['6.036', 'homework', 'hw10'];
catsoop.course = '6.036';
catsoop.url_root = 'https://introml_oll.odl.mit.edu/cat-soop';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";
</script></p>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
      This page was last updated on Wednesday April 24, 2019 at 02:26:39 PM (revision <code>73ed03a</code>).<br>&nbsp;<br>Sec None Release 1900-01-01 00:00:00 Due 9999-12-31 23:59:59<br><script type="text/javascript">document.getElementById("cs_header").style.display="none";</script>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v14.0.0.dev144.<br>
      CAT-SOOP is <a href="http://www.fsf.org/about/what-is-free-software" target="_blank">free/libre software</a>, available under the terms<br>of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://introml_oll.odl.mit.edu/cat-soop/_util/source.zip?course=6.036" target="_blank">Download Source Code</a><br>
<a href="https://introml_oll.odl.mit.edu/cat-soop/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</footer>



<div style="clear: both; display: block;"></div></body></html>


    more details (https://www.gnu.org/licenses/agpl-3.0.en.html).

    As additional permission under GNU AGPL version 3 section 7, you may
    distribute non-source (e.g., minimized or compacted) forms of that code
    without the copy of the GNU AGPL normally required by section 4, provided
    you include this license notice and a URL through which recipients can
    access the Corresponding Source.

    @licend  The above is the entire license notice for the JavaScript code in
    this page.
    */
    </script>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    document.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });
    </script>
<!-- load in katex and mathjax, and CAT-SOOP-specific math rendering  -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css">
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/mathjax/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/cs_math.js" type="text/javascript"></script>
<!-- Syntax Highlighting -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/highlight/cs_highlight.pack.min.js" type="text/javascript"></script>
<script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
<style>
      :root {
        --cs-base-bg-color: #00bfff;
        --cs-light-bg-color: #32cbff;
        --cs-base-font-color: #ffffff;
        --cs-light-font-color: #000;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.3/iframeResizer.contentWindow.min.js" type="text/javascript"></script><link href="/queue/fall18/css/queue.css" rel="stylesheet">
<!--JS for questions-->
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script>
<meta content="width=device-width, initial-scale=1" name="viewport">
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/mode-python.js"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body style="margin: 0px;">
<header id="cs_header" style="display: none;">
<div class="nav-container">
<div class="cs_header_text"><a href="https://introml_oll.odl.mit.edu/cat-soop/6.036"></a></div>
<a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<center><h1></h1></center>
<p>A code directory that will be useful for doing this homework can
be found <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/code_for_hw10.zip"><strong>here</strong></a>.  Download
this to your computer. Or alternatively, use the <a href="https://colab.research.google.com/drive/1HxoDioZjhFDfP6FA3EvSdY30QLOPFl_7"><strong>colab notebook</strong></a>.</p>
<a class="anchor" name="catsoop_section_1"></a><h2>1) Exploration</h2>
<p>In this problem, we will work with the "tiny" MDP from exercises ex09
(repeated below for convenience), and we will look at the effects of
exploration on the success of Q-learning.</p>
<p>Consider an MDP with states (0, 1, 2, 3), actions ('b', 'c'). The reward function is:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi><mo>=</mo><mn>1</mn></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi><mo>=</mo><mn>3</mn></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">R(s,a) = \begin{cases} 1&amp;amp; \text{if $s=1$} \\ 2&amp;amp; \text{if $s=3$} \\ 0&amp;amp; \text{otherwise} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.00773em;" class="mord mathdefault">R</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.32em; vertical-align: -1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35002em;"><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -4.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.41em;"><span class="" style="top: -4.41em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.97em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -1.53em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.91em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.41em;"><span class="" style="top: -4.41em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span></span></span></span><span class="" style="top: -2.97em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">3</span></span></span></span><span class="" style="top: -1.53em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.91em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>
You get the reward associated with a state on the step when you exit that state. The transition function for each action is below, where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>[</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">T[i,x,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">]</span></span></span></span></span> is the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>j</mi><mi mathvariant="normal">∣</mi><mi>a</mi><mo>=</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(s_{t+1}=j | a=x, s_t=i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>.
<div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><mtext>’b’</mtext><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T(s_t, \text{&amp;#x27;b&amp;#x27;}, s_{t+1})= \begin{bmatrix} 0.0 &amp;amp; 0.9 &amp;amp; 0.1 &amp;amp; 0.0 \\ 0.9 &amp;amp; 0.1 &amp;amp; 0.0 &amp;amp; 0.0 \\ 0.0 &amp;amp; 0.0 &amp;amp; 0.1 &amp;amp; 0.9 \\ 0.9 &amp;amp; 0.0 &amp;amp; 0.0 &amp;amp; 0.1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">’b’</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80204em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><mtext>’c’</mtext><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T(s_t, \text{&amp;#x27;c&amp;#x27;}, s_{t+1})= \begin{bmatrix} 0.0 &amp;amp; 0.1 &amp;amp; 0.9 &amp;amp; 0.0 \\ 0.9 &amp;amp; 0.1 &amp;amp; 0.0 &amp;amp; 0.0 \\ 0.0 &amp;amp; 0.0 &amp;amp; 0.1 &amp;amp; 0.9 \\ 0.9 &amp;amp; 0.0 &amp;amp; 0.0 &amp;amp; 0.1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">’c’</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80204em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80499em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.40599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.65201em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></div>
Note that the <strong>only</strong> effect of the action is to change the transition probability in state 0 (the first row of the transition matrix).<p></p>
<p>Consider the two plots below.  In both cases, the x-axis is the number
of steps of Q-learning, plotted in 1000's (so the actual number of
steps is 60,000).</p>
<ol>
<li>
<p>In the first plot, the y-axis is the <i>max norm difference</i>
between the optimal Q function, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>, and the learned Q
function, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14121em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mi>max</mi><mo>⁡</mo><mrow><mi>s</mi><mo separator="true">,</mo><mi>a</mi></mrow></munder><mo>∣</mo><msup><mi>Q</mi><mo>∗</mo></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>−</mo><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>∣</mo></mrow><annotation encoding="application/x-tex">\max_{s, a} \lvert Q^{\ast}(s, a) - \hat{Q}(s, a) \rvert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.58611em; vertical-align: -0.836108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em;"><span class="" style="top: -2.1em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">a</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836108em;"><span class=""></span></span></span></span></span><span class="mopen">∣</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.19677em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">∣</span></span></span></span></span></div><p></p>
</li>
<li>
<p>In the second plot, the y-axis is the average per-step reward,
averaged over 1000 steps.</p>
</li>
</ol>
<div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/QLGraph.png"> <img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/QLReturn.png">
</center>
</div>
<p>Our epsilon-greedy action-selection strategy at each iteration, when in state <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span>, is:</p>
<ul>
<li>flip a coin that lands heads with probability <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">1-\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span></li>
<li>if it lands heads, greedily select the best action under <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14121em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span> (the current Q-value estimates): <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow><msub><mi>max</mi><mo>⁡</mo><mi>a</mi></msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">{\rm arg} \max_a \hat{Q}(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.19677em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span style="margin-right: 0.01389em;" class="mord mathrm">g</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span></li>
<li>if it lands tails, select an action uniformly at random, for exploration purposes</li>
</ul>
<p>In each plot, we have used a different value of <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span>:</p>
<ul>
<li>0.00 : Blue</li>
<li>0.05 : Green</li>
<li>0.10 : Red</li>
<li>0.25 : Cyan</li>
<li>0.50 : Magenta</li>
<li>1.00 : Yellow</li>
</ul>
<p>Here are some points about the algorithm:</p>
<ol>
<li>
<p>When there's a tie between action values, our implementation of
argmax always returns the first element, which in this case is action 'b'.</p>
</li>
<li>
<p>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal
due to the exploration.</p>
</li>
<li>
<p>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\ast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal
behavior (if we don't explore) is that the relative <b>ordering</b> of
action values is correct.</p>
</li>
<li>
<p>For any state, it is necessary to execute action 'c' from that state
some number of times before its estimated Q-value is higher than the
estimated Q-value for action 'b' from that state.</p>
</li>
</ol>
<p>For each of the following observations about the plots, mark all the points
listed above that are relevant to (helps explain) that observation.</p>
<p><b>1A)</b>
The blue line is perfectly constant in plot 1 and roughly constant in plot 2.

<!--START question q000000 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000000" style="position: static">
<div id="q000000_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000000_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000000_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000000_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000000_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000000" name="q000000" type="hidden" value="{}">
<script type="text/javascript">
var q000000_selected = {};
document.getElementById("q000000").value = JSON.stringify(q000000_selected);
document.querySelectorAll("input[type=checkbox][name^=q000000_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000000_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000000").value = JSON.stringify(q000000_selected);
    });
});
</script>
</div><div>
<span id="q000000_buttons">
<button class="submit btn btn-catsoop" id="q000000_submit" onclick="catsoop.submit('q000000');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000000_viewanswer" onclick="catsoop.viewanswer('q000000');" style="margin-top: 10px;">View Answer</button></span><span id="q000000_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000000_loading_wrapper">
<span id="q000000_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000000_score_display"></span>
<div class="nsubmits_left" id="q000000_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000000_solution_container">
<div id="q000000_solution">
</div>
<div id="q000000_solution_explanation">
</div>
</div>
<div id="q000000_message"></div>
</div>
<!--END question q000000 -->
<p><b>1B)</b>
The yellow line goes down the fastest in plot 1, but doesn't have the best performance in plot 2.
<!--START question q000001 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000001_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000001_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000001_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000001_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000001" name="q000001" type="hidden" value="{}">
<script type="text/javascript">
var q000001_selected = {};
document.getElementById("q000001").value = JSON.stringify(q000001_selected);
document.querySelectorAll("input[type=checkbox][name^=q000001_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000001_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000001").value = JSON.stringify(q000001_selected);
    });
});
</script>
</div><div>
<span id="q000001_buttons">
<button class="submit btn btn-catsoop" id="q000001_submit" onclick="catsoop.submit('q000001');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000001_viewanswer" onclick="catsoop.viewanswer('q000001');" style="margin-top: 10px;">View Answer</button></span><span id="q000001_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000001_score_display"></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message"></div>
</div>
<!--END question q000001 -->
<p><b>1C)</b>
The red line goes down slowly in plot 1, and leaps up in the middle of plot 2.
<!--START question q000002 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000002_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000002_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000002_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000002_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000002" name="q000002" type="hidden" value="{}">
<script type="text/javascript">
var q000002_selected = {};
document.getElementById("q000002").value = JSON.stringify(q000002_selected);
document.querySelectorAll("input[type=checkbox][name^=q000002_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000002_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000002").value = JSON.stringify(q000002_selected);
    });
});
</script>
</div><div>
<span id="q000002_buttons">
<button class="submit btn btn-catsoop" id="q000002_submit" onclick="catsoop.submit('q000002');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000002_viewanswer" onclick="catsoop.viewanswer('q000002');" style="margin-top: 10px;">View Answer</button></span><span id="q000002_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000002_score_display"></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message"></div>
</div>
<!--END question q000002 -->
<p><b>1D)</b>
The magenta, cyan, red, and green lines each leap up at some point (each one after the other) in the average rewards plot.
<!--START question q000003 -->
</p><div class="question question-multiplechoice" id="cs_qdiv_q000003" style="position: static">
<div id="q000003_rendered_question">
Mark all the points listed below that are relevant to (helps explain) this observation: <table border="0">
<tbody><tr><td align="center"><input name="q000003_opt0" type="checkbox" value="0"></td><td>When there's a tie between action values, our implementation of argmax always returns the first element, which in this case is action 'b'.</td></tr>
<tr><td align="center"><input name="q000003_opt1" type="checkbox" value="1"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is known very well, behavior can be suboptimal due to the exploration.</td></tr>
<tr><td align="center"><input name="q000003_opt2" type="checkbox" value="2"></td><td>Even when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>⋆</mo></msup></mrow><annotation encoding="application/x-tex">Q^{\star}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span></span></span></span></span> is not correct, all that matters for optimal behavior (if we don't explore) is that the relative <b>ordering</b> of action values is correct.</td></tr>
<tr><td align="center"><input name="q000003_opt3" type="checkbox" value="3"></td><td>For any state, it is necessary to execute action 'c' from that state some number of times before its estimated Q-value is higher than the estimated Q-value for action 'b' from that state.</td></tr>
</tbody></table><input id="q000003" name="q000003" type="hidden" value="{}">
<script type="text/javascript">
var q000003_selected = {};
document.getElementById("q000003").value = JSON.stringify(q000003_selected);
document.querySelectorAll("input[type=checkbox][name^=q000003_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        q000003_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("q000003").value = JSON.stringify(q000003_selected);
    });
});
</script>
</div><div>
<span id="q000003_buttons">
<button class="submit btn btn-catsoop" id="q000003_submit" onclick="catsoop.submit('q000003');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000003_viewanswer" onclick="catsoop.viewanswer('q000003');" style="margin-top: 10px;">View Answer</button></span><span id="q000003_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000003',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000003_loading_wrapper">
<span id="q000003_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000003_score_display"></span>
<div class="nsubmits_left" id="q000003_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000003_solution_container">
<div id="q000003_solution">
</div>
<div id="q000003_solution_explanation">
</div>
</div>
<div id="q000003_message"></div>
</div>
<!--END question q000003 -->
<a class="anchor" name="catsoop_section_2"></a><h2>2) Implement Q-Learning</h2>
<p>We'll work up to implementing the Q-learning algorithm by extending our code from HW9. The code is reproduced here (detailed definition is in the code file):</p>
<p></p><pre>class MDP:
    def __init__(self, states, actions, transition_model, reward_fn,
                     discount_factor = 1.0, start_dist = None):
        # states: list or set of states
        # actions: list or set of actions
        # transition_model: function from (state, action) into DDist over next state
        # reward_fn: function from (state, action) to real-valued reward
        # discount_factor: real, greater than 0, less than or equal to 1
        # start_dist: optional instance of DDist, specifying initial state dist
        #    if it's unspecified, we'll use a uniform over states
    def terminal(self, s):
        # Given a state, return True if the state should be considered to
        # be terminal.  You can think of a terminal state as generating an
        # infinite sequence of zero reward.
    def init_state(self):
        # Return an initial state by drawing from the distribution over start states.
    def sim_transition(self, s, a):
        # Simulates a transition from the given state, s and action a, using the
        # transition model as a probability distribution.  If s is terminal,
        # use init_state to draw an initial state.  Returns (reward, new_state)

class TabularQ:
    def __init__(self, states, actions):
        self.actions = actions
        self.states = states
        self.q = dict([((s, a), 0.0) for s in states for a in actions])
    def copy(self):
        q_copy = TabularQ(self.states, self.actions)
        q_copy.q.update(self.q)
        return q_copy
    def set(self, s, a, v):
        self.q[(s,a)] = v
    def get(self, s, a):
        return self.q[(s,a)]
</pre>
<p><a class="anchor" name="catsoop_section_2_1"></a></p><h3>2.1) Q update</h3><p></p>
<p>First, we'll extend our implementation of the <tt>TabularQ</tt> class 
in <a href="https://introml.odl.mit.edu/cat-soop/6.036/homework/hw09">HW 9</a> 
(Problem 5) to incorporate the crucial operation of Q-learning, 
which is to update the Q value for a given <tt>(s,a)</tt> entry and move 
it part of the way towards a "target" value <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span></span>.</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>←</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Q(s,a) \leftarrow (1-\alpha) Q(s,a) + \alpha t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mclose">)</span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mord mathdefault">t</span></span></span></span></span></div><p></p>
<p>Note that this can also be written as:</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>←</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mo>(</mo><mi>t</mi><mo>−</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a) \leftarrow Q(s,a) + \alpha (t - Q(s,a))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></div><p></p>
<p>That is, move a small (<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span></span></span></span></span>) step towards <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span></span>.</p>
<p>Let's define a new method for <tt>TabularQ</tt> that implements this,
in a batched form.  We will be given a list of <tt>(s, a, t)</tt> triples and
have to do all the updates.  Note that <code>update</code> is a method of the
<code>TabularQ</code> class, so you can access the other methods and attributes.</p>
<ul>
<li> <code>data</code> is a list of <tt>(s, a, t)</tt> tuples.</li>
<li> <code>lr</code> is a learning rate (<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span></span></span></span></span> above)</li>
<li> We will have to update <tt>self.q[(s,a)]</tt> for all of the data.</li>
</ul>
<p>Here is an example of how to test <code>update</code>:
</p><pre>&gt;&gt;&gt; q = TabularQ([0,1,2,3],['b','c'])
&gt;&gt;&gt; q.update([(0, 'b', 50), (2, 'c', 30)], 0.5)
&gt;&gt;&gt; q.get(0, 'b')
25.0
&gt;&gt;&gt; q.get(2, 'c')
15.0
</pre>
<p>
<!--START question TabularQ -->
</p><div class="question question-pythoncode" id="cs_qdiv_TabularQ" style="position: static">
<div id="TabularQ_rendered_question">
<div class="ace_editor_wrapper" id="containerTabularQ" style="height: 280px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorTabularQ" name="editorTabularQ" style="font-size: 16px; height: 280px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 38px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 318px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div></div><div class="ace_gutter-active-line" style="top: 38px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 318px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:38px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">update</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">data</span>, <span class="ace_identifier">lr</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 38px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 57px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="TabularQ" name="TabularQ" type="hidden" value="def update(self, data, lr):
    # Your code here
    pass">
<input id="TabularQ_log" name="TabularQ_log" type="hidden">
<script type="text/javascript">
    var logTabularQ = new Array();
    var editorTabularQ = ace.edit("editorTabularQ");
    editorTabularQ.setTheme("ace/theme/textmate");
    editorTabularQ.getSession().setMode("ace/mode/python");
    editorTabularQ.setShowFoldWidgets(false);
    editorTabularQ.setValue('def update(self, data, lr):\n    # Your code here\n    pass')
    document.getElementById("TabularQ").value = editorTabularQ.getValue();
    editorTabularQ.on("change",function(e){
        editorTabularQ.getSession().setUseSoftTabs(true);
        document.getElementById("TabularQ").value = editorTabularQ.getValue();
    });
    editorTabularQ.clearSelection()
    editorTabularQ.getSession().setUseSoftTabs(true);
    editorTabularQ.on("paste",function(txt){editorTabularQ.getSession().setUseSoftTabs(false);});
    editorTabularQ.getSession().setTabSize(4);
    editorTabularQ.setFontSize("16px");
    document.getElementById("containerTabularQ").style.height = "280px";
    document.getElementById("editorTabularQ").style.height = "280px";
    editorTabularQ.resize(true);
</script>
</div><div>
<span id="TabularQ_buttons">
<button class="check btn btn-catsoop" id="TabularQ_check" onclick="catsoop.check('TabularQ');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="TabularQ_submit" onclick="catsoop.submit('TabularQ');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="TabularQ_viewanswer" onclick="catsoop.viewanswer('TabularQ');" style="margin-top: 10px;">View Answer</button></span><span id="TabularQ_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'TabularQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'TabularQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="TabularQ_loading_wrapper">
<span id="TabularQ_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="TabularQ_score_display"></span>
<div class="nsubmits_left" id="TabularQ_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="TabularQ_solution_container">
<div id="TabularQ_solution">
</div>
<div id="TabularQ_solution_explanation">
</div>
</div>
<div id="TabularQ_message"></div>
</div>
<!--END question TabularQ -->
<p><a class="anchor" name="catsoop_section_2_2"></a></p><h3>2.2) Q_learn</h3><p></p>
<p>Complete the definition of the <tt>Q_learn</tt> function.  It should
update the entries in the <tt>q</tt> function, <tt>(s, a)</tt>,
towards their estimated Q values.  It should terminate after
<tt>iters</tt> iterations and use learning rate <tt>lr</tt>. Use the
<code>q.update</code> method, which you just wrote, to update the Q values.</p>
<p>You will need to both simulate the agent's trajectory through the
space as well as perform the updates to the Q function estimates.  In
this version, you should update the Q values after every transition,
using a single <tt>(s, a, t)</tt> tuple.  <strong>The following methods and functions have already been defined for you.</strong>
</p><ul>
<li> To start a new simulation, call <tt>mdp.init_state()</tt>.
That will draw a state from the MDP's initial state distribution.  </li>
<li> You can use the functions that we defined in HW 9:
<tt>epsilon_greedy</tt> for action
selection (<tt>epsilon_greedy</tt> takes <tt>(q, s, eps = 0.5)</tt> as input and returns an action), <strong> and </strong> <tt>value</tt> takes <tt>(q, s)</tt> and returns the max Q value for a state.</li>
<li> To take a step in the simulation, starting in a given state,
<tt>s</tt>, using action <tt>a</tt>, call
<tt>mdp.sim_transition(s,a)</tt>.  It will return a pair <tt>(r,
s_prime)</tt> denoting the reward received by the agent at that step
and the next state.</li>
<li> To get the discount factor in your code, you can use <tt>mdp.discount_factor</tt>.</li>
<li> Be careful in treating terminal states.  Recall that at a terminal
state, there may be an immediate reward (i.e. allow for reward <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">r</span></span></span></span></span>) but the future expected value
will be zero (e.g. <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> or drop the term with <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span></span></span></span></span>).  Also, simulations may restart with the initial state 
subsequent to reaching a terminal state (so don't latch a terminal condition).</li>
<li> Return <code>q</code> so that the Tutor can test it.</li>
</ul>
<p>Locally, or in colab, you should be able to pass <tt>draw=True</tt> in the test
functions to see a policy learned by the algorithm playing the game No Exit.</p>
<p>For testing, we can also set up a tiny MDP problem as follows (and use this to test 2.2 - 3.1):</p>
<p></p><pre>def tinyTerminal(s):
    return s==4
def tinyR(s, a):
    if s == 1: return 1
    elif s == 3: return 2
    else: return 0
def tinyTrans(s, a):
    if s == 0:
        if a == 'a':
            return DDist({1 : 0.9, 2 : 0.1})
        else:
            return DDist({1 : 0.1, 2 : 0.9})
    elif s == 1:
        return DDist({1 : 0.1, 0 : 0.9})
    elif s == 2:
        return DDist({2 : 0.1, 3 : 0.9})
    elif s == 3:
        return DDist({3 : 0.1, 0 : 0.5, 4 : 0.4})
    elif s == 4:
        return DDist({4 : 1.0})
</pre>
<p>We can use this to test <code>Q_learn</code> as follows:</p>
<p></p><pre>def testQ():
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = TabularQ(tiny.states, tiny.actions)
    qf = Q_learn(tiny, q)
    return list(qf.q.items())

&gt;&gt;&gt; random.seed(0)
&gt;&gt;&gt; testQ()
[((0, 'a'), 0.6649739221724159), ((0, 'b'), 0.1712369526453748), ((1, 'a'), 0.7732751316011999), ((1, 'b'), 1.2034912054227331), ((2, 'a'), 0.37197205380133874), ((2, 'b'), 0.45929063274463033), ((3, 'a'), 1.5156163024818292), ((3, 'b'), 0.8776852768653631), ((4, 'a'), 0.0), ((4, 'b'), 0.0)]
</pre>
<p>
<!--START question QLearn -->
</p><div class="question question-pythoncode" id="cs_qdiv_QLearn" style="position: static">
<div id="QLearn_rendered_question">
<div class="ace_editor_wrapper" id="containerQLearn" style="height: 280px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorQLearn" name="editorQLearn" style="font-size: 16px; height: 280px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 95px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 318px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div></div><div class="ace_gutter-active-line" style="top: 95px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 318px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:95px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">Q_learn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mdp</span>, <span class="ace_identifier">q</span>, <span class="ace_identifier">lr</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.1</span>, <span class="ace_identifier">iters</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">100</span>, <span class="ace_identifier">eps</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.5</span>, <span class="ace_identifier">interactive_fn</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">None</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">iters</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># include this line in the iteration, where i is the iteration number</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">interactive_fn</span>: <span class="ace_identifier">interactive_fn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">q</span>, <span class="ace_identifier">i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 95px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 114px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="QLearn" name="QLearn" type="hidden" value="def Q_learn(mdp, q, lr=.1, iters=100, eps = 0.5, interactive_fn=None):
    # Your code here
    for i in range(iters):
        # include this line in the iteration, where i is the iteration number
        if interactive_fn: interactive_fn(q, i)
    pass">
<input id="QLearn_log" name="QLearn_log" type="hidden">
<script type="text/javascript">
    var logQLearn = new Array();
    var editorQLearn = ace.edit("editorQLearn");
    editorQLearn.setTheme("ace/theme/textmate");
    editorQLearn.getSession().setMode("ace/mode/python");
    editorQLearn.setShowFoldWidgets(false);
    editorQLearn.setValue('def Q_learn(mdp, q, lr=.1, iters=100, eps = 0.5, interactive_fn=None):\n    # Your code here\n    for i in range(iters):\n        # include this line in the iteration, where i is the iteration number\n        if interactive_fn: interactive_fn(q, i)\n    pass')
    document.getElementById("QLearn").value = editorQLearn.getValue();
    editorQLearn.on("change",function(e){
        editorQLearn.getSession().setUseSoftTabs(true);
        document.getElementById("QLearn").value = editorQLearn.getValue();
    });
    editorQLearn.clearSelection()
    editorQLearn.getSession().setUseSoftTabs(true);
    editorQLearn.on("paste",function(txt){editorQLearn.getSession().setUseSoftTabs(false);});
    editorQLearn.getSession().setTabSize(4);
    editorQLearn.setFontSize("16px");
    document.getElementById("containerQLearn").style.height = "280px";
    document.getElementById("editorQLearn").style.height = "280px";
    editorQLearn.resize(true);
</script>
</div><div>
<span id="QLearn_buttons">
<button class="check btn btn-catsoop" id="QLearn_check" onclick="catsoop.check('QLearn');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="QLearn_submit" onclick="catsoop.submit('QLearn');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="QLearn_viewanswer" onclick="catsoop.viewanswer('QLearn');" style="margin-top: 10px;">View Answer</button></span><span id="QLearn_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearn',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearn',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="QLearn_loading_wrapper">
<span id="QLearn_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="QLearn_score_display"></span>
<div class="nsubmits_left" id="QLearn_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="QLearn_solution_container">
<div id="QLearn_solution">
</div>
<div id="QLearn_solution_explanation">
</div>
</div>
<div id="QLearn_message"></div>
</div>
<!--END question QLearn -->
<p>Below, assume this <tt>update</tt> method has been defined.</p>
<p><a class="anchor" name="catsoop_section_2_3"></a></p><h3>2.3) Batch Q_learn</h3><p></p>
<p>In the standard Q-learning algorithm, we make one epsilon-greedy
transition based on the current Q estimate and then update the Q
values.  You can think of this as being like stochastic gradient
descent.  We can also define a version that is more like batch
gradient descent, where we generate one or more "episodes" (sequences
of transitions) using the current Q values and then update the Q
values based on all the observed results.  We can also keep around old
transitions and use them (all or a random subset) in the update as
well. <strong>Note that as our Q value estimate evolves, the target Q value
computed from a previously observed transition can change.</strong></p>
<p>Implement this version of batch Q-learning that (a) generates some
specifed number of episodes of a given length (see
<code>sim_episode</code> below), (b) adds these to the experiences we
have seen previously, and (c) updates the Q estimates based on <strong>all
the experience so far</strong>.  Return <code>q</code> so that the Tutor can
test it.</p>
<p></p><pre>def sim_episode(mdp, episode_length, policy, draw=False):
    '''
    Simulate an episode (sequence of transitions) of at most
    episode_length, using policy function to select actions.  If we find
    a terminal state, end the episode.  Return accumulated reward a list
    of (s, a, r, s') where s' is None for transition from terminal state.
    Also return an animation if draw=True, or None if draw=False
    '''
    episode = []
    reward = 0
    s = mdp.init_state()
    all_states = [s]
    for i in range(episode_length):
        a = policy(s)
        (r, s_prime) = mdp.sim_transition(s, a)
        reward += r
        if mdp.terminal(s):
            episode.append((s, a, r, None))
            break
        episode.append((s, a, r, s_prime))
        if draw: 
            mdp.draw_state(s)
        s = s_prime
        all_states.append(s)
    animation = animate(all_states, mdp.n, episode_length) if draw else None
    return reward, episode, animation
</pre>
<p>This definition is already available for you.  Note that
<tt>sim_episode</tt> can return tuples with <tt>s_prime = None</tt>.</p>
<p><b>Clarifications</b> </p><ul> <li> There should be a SINGLE call to
<code>q.update</code> per iteration, not per episode or per experience.  Just one
call per iteration, with a lot of data.</li> <li> Let's understand the
distinction between experiences <tt>(s, a, r, s')</tt> and Q targets
<tt>(s, a, t)</tt>. Note that experiences don't depend on the current
estimated Q values (only on the environment we are acting in), but the
"t" in the Q targets depends on the current Q values. So, it makes
sense to store experiences across iterations, but not to store Q
targets, since the Q targets change when we update our Q values. Thus,
you want to continuously aggregate the experience and then, in each
iteration, re-compute the Q targets under the current estimated Q
values, then do the update with all of these Q targets. Here's
pseudocode:</li> </ul>
<p></p><pre>all_experiences = []
Loop over n_iterations:
    Loop over n_episodes:
        Generate an episode of length episode_length, append this experience to all_experiences
    all_q_targets = []
    Loop over all_experiences:
        Append Q target from one experience to all_q_targets
        Remember to handle terminal states (where s' = None)
    q.update(all_q_targets, lr)
return q
</pre>
<p>We can use our tiny MDP example above to test <code>Q_learn_batch</code> as follows:</p>
<p></p><pre>def testBatchQ():
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = TabularQ(tiny.states, tiny.actions)
    qf = Q_learn_batch(tiny, q)
    return list(qf.q.items())

&gt;&gt;&gt; random.seed(0)
&gt;&gt;&gt; testBatchQ()
[((0, 'a'), 4.7566600197286535), ((0, 'b'), 3.993296047838986), ((1, 'a'), 5.292467934685342), ((1, 'b'), 5.364014782870985), ((2, 'a'), 4.139537149779127), ((2, 'b'), 4.155347555640753), ((3, 'a'), 4.076532544818926), ((3, 'b'), 4.551442974149778), ((4, 'a'), 0.0), ((4, 'b'), 0.0)]
</pre>
<p>
<!--START question QLearnBatch -->
</p><div class="question question-pythoncode" id="cs_qdiv_QLearnBatch" style="position: static">
<div id="QLearnBatch_rendered_question">
<div class="ace_editor_wrapper" id="containerQLearnBatch" style="height: 400px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorQLearnBatch" name="editorQLearnBatch" style="font-size: 16px; height: 400px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 117.067px; top: 133px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 438px; width: 36px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div></div><div class="ace_gutter-active-line" style="top: 133px; height: 19px;"></div></div><div class="ace_scroller" style="left: 36px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 768px; height: 438px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:133px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">def</span> <span class="ace_identifier">Q_learn_batch</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mdp</span>, <span class="ace_identifier">q</span>, <span class="ace_identifier">lr</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.1</span>, <span class="ace_identifier">iters</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">100</span>, <span class="ace_identifier">eps</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.5</span>,</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_identifier">episode_length</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">10</span>, <span class="ace_identifier">n_episodes</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">2</span>,</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">interactive_fn</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">None</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">iters</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># include this line in the iteration, where i is the iteration number</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">interactive_fn</span>: <span class="ace_identifier">interactive_fn</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">q</span>, <span class="ace_identifier">i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 81.0667px; top: 133px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 152px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 19px; left: 36px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 768px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="QLearnBatch" name="QLearnBatch" type="hidden" value="def Q_learn_batch(mdp, q, lr=.1, iters=100, eps=0.5,
                                   episode_length=10, n_episodes=2,
                  interactive_fn=None):
    # Your code here
    for i in range(iters):
        # include this line in the iteration, where i is the iteration number
        if interactive_fn: interactive_fn(q, i)
    pass">
<input id="QLearnBatch_log" name="QLearnBatch_log" type="hidden">
<script type="text/javascript">
    var logQLearnBatch = new Array();
    var editorQLearnBatch = ace.edit("editorQLearnBatch");
    editorQLearnBatch.setTheme("ace/theme/textmate");
    editorQLearnBatch.getSession().setMode("ace/mode/python");
    editorQLearnBatch.setShowFoldWidgets(false);
    editorQLearnBatch.setValue('def Q_learn_batch(mdp, q, lr=.1, iters=100, eps=0.5,\n                                   episode_length=10, n_episodes=2,\n                  interactive_fn=None):\n    # Your code here\n    for i in range(iters):\n        # include this line in the iteration, where i is the iteration number\n        if interactive_fn: interactive_fn(q, i)\n    pass')
    document.getElementById("QLearnBatch").value = editorQLearnBatch.getValue();
    editorQLearnBatch.on("change",function(e){
        editorQLearnBatch.getSession().setUseSoftTabs(true);
        document.getElementById("QLearnBatch").value = editorQLearnBatch.getValue();
    });
    editorQLearnBatch.clearSelection()
    editorQLearnBatch.getSession().setUseSoftTabs(true);
    editorQLearnBatch.on("paste",function(txt){editorQLearnBatch.getSession().setUseSoftTabs(false);});
    editorQLearnBatch.getSession().setTabSize(4);
    editorQLearnBatch.setFontSize("16px");
    document.getElementById("containerQLearnBatch").style.height = "400px";
    document.getElementById("editorQLearnBatch").style.height = "400px";
    editorQLearnBatch.resize(true);
</script>
</div><div>
<span id="QLearnBatch_buttons">
<button class="check btn btn-catsoop" id="QLearnBatch_check" onclick="catsoop.check('QLearnBatch');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="QLearnBatch_submit" onclick="catsoop.submit('QLearnBatch');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="QLearnBatch_viewanswer" onclick="catsoop.viewanswer('QLearnBatch');" style="margin-top: 10px;">View Answer</button></span><span id="QLearnBatch_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearnBatch',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'QLearnBatch',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2.3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="QLearnBatch_loading_wrapper">
<span id="QLearnBatch_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="QLearnBatch_score_display"></span>
<div class="nsubmits_left" id="QLearnBatch_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="QLearnBatch_solution_container">
<div id="QLearnBatch_solution">
</div>
<div id="QLearnBatch_solution_explanation">
</div>
</div>
<div id="QLearnBatch_message"></div>
</div>
<!--END question QLearnBatch -->
<a class="anchor" name="catsoop_section_3"></a><h2>3) NNQ: Using neural networks to store the Q function</h2>
<p>We would like to operate in large or continuous state and/or action
spaces so it is not possible (or effective) to store the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></span> values in
a table as we did with the <tt>TabularQ</tt> class; instead, we will
"store" them by training a neural network to do regression for us,
taking <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo separator="true">,</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">s,a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span></span></span></span></span> as input and generating (an approximation of) <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^*(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span>
as output.</p>
<p>To train the network, we will use <i>squared Bellman error</i> as
the loss function:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mo fence="true">(</mo><mrow><mo fence="true">[</mo><mi>R</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>γ</mi><munder><mi>max</mi><mo>⁡</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup></munder><mi>Q</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">;</mo><mi>θ</mi><mo>)</mo><mo fence="true">]</mo></mrow><mo>−</mo><mi>Q</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">;</mo><mi>θ</mi><mo>)</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\left(\left[R(s_t, a_t) + \gamma \max_{a&amp;#x27;} Q(s_{t+1}, a&amp;#x27;; \theta)\right] - Q(s_t, a_t;\theta) \right)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.09799em; vertical-align: -0.74398em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">[</span></span><span style="margin-right: 0.00773em;" class="mord mathdefault">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05556em;" class="mord mathdefault">γ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em;"><span class="" style="top: -2.05602em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.74398em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">]</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.35401em;"><span class="" style="top: -3.6029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div>
where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span></span></span></span></span> stands for the current weights in the neural network
and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">;</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s, a; \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span></span></span></span></span> stands for the output of the network with
weights <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span></span></span></span></span> when <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> is the input.<p></p>
<p>There are many choices of neural network architecture for storing Q
values.  In this problem, we will:</p>
<ul>
<li> Focus on the case where we have a small set of possible actions,
so make one neural network for each possible action <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">a</span></span></span></span></span>;

</li><li> Design that network with two <b>hidden</b> layers with ReLU units
and a single linear output unit (although a deeper network could be
useful); and

</li><li> Use mean squared error (MSE) as the loss function since, we are
predicting continuous <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></span> values, which is a regression
problem.

</li></ul>
<p>To use a neural net to store Q values, for a given action, we will
need to have a mapping from states to fixed-length vectors.  We will
assume that the <code>MDP</code> class has a <code>state2vec</code>
method that maps states to vectors.  For the simple discrete-state
MDPs we have seen so far, this simply returns a one-hot representation
of the state. For reference, this is our implementation of
<code>state2vec</code> (note the shape of its returned array):
</p><pre>    def state2vec(self, s):
        '''
        Return one-hot encoding of state s; used in neural network agent implementations
        '''
        v = np.zeros((1, len(self.states)))
        v[0,self.states.index(s)] = 1.
        return v
</pre>
<p>Now, all we need to do is write a new class, called <code>NNQ</code>
to implement neural-network version of Q-function storage; then we can
pass an <code>NNQ</code> instance instead of a <code>TabularQ</code> instance
into <code>Q_learn</code> or <code>Q_learn_batch</code>, and
we will automatically have reinforcement learning with neural
networks!</p>
<p>There are three methods to implement in our <code>NNQ</code>
class. Here are some ideas for how to do that:
</p><ul>
<li> <code>__init__</code>: Create one neural network for each action,
and store them in <tt>self.models</tt>. Note that <tt>actions</tt> is
a list that may consist of integers or strings or other objects.  As a
reminder, here's how to make a new feed-forward network using Keras
(you can assume this <code>make_nn</code> procedure exists and can be called
by your code):
<pre>def make_nn(state_dim, num_hidden_layers, num_units):
    '''
    state_dim = (int) number of states
    num_hidden_layers = (int) number of fully connected hidden layers
    num_units = (int) number of dense relu units to use in hidden layers
    '''
    model = Sequential()
    model.add(Dense(num_units, input_dim = state_dim, activation='relu'))
    for i in range(num_hidden_layers-1):
        model.add(Dense(num_units, activation='relu'))
    model.add(Dense(1, activation='linear'))
    model.compile(loss='mse', optimizer=Adam())
    return model
</pre>
</li>
<li> <code>get(self, s, a)</code>: Use the neural network you have
stored for action <code>a</code> to predict a Q value for state
<code>s</code>. Feel free to consult documentation on the 
<a href="https://keras.io/models/model/#predict">Keras model predict</a>
method.</li>
<li> <code>update(self, data, lr, epochs = 1)</code>: As in
<code>TabularQ</code>, <code>data</code> is a list of <code>(s, a,t)</code> 
tuples, where <code>t</code> is a target Q value.  For each
action <code>a</code>, you will need to:

  <ul>
<li> Construct a training set <code>X, Y</code> of data that is
  relevant to action <code>a</code>, where the input values are states
  (encoded as vectors) and the output values are the target Q values;</li>
<p></p><li> Use the Keras method <code>fit(self, X, Y, epochs=epochs)</code> 
  to update the weights in th e associated network.  You can ignore
  the <tt>lr</tt> input parameter, and let Adam in keras manage the
  learning rate.</li>
</ul>
</li>
</ul>
<p>We can use our tiny MDP example above to test the <code>NNQ</code>
class as follows (note: the answers may differ numerically, but you
should get the same structure in terms of data structure and length):</p>
<p></p><pre>def test_NNQ(data):
    tiny = MDP([0, 1, 2, 3, 4], ['a', 'b'], tinyTrans, tinyR, 0.9)
    tiny.terminal = tinyTerminal
    q = NNQ(tiny.states, tiny.actions, tiny.state2vec, 2, 10)
    q.update(data, 1)
    return [q.get(s,a) for s in q.states for a in q.actions]

&gt;&gt;&gt; test_NNQ([(0,'a',0.3),(1,'a',0.1),(0,'a',0.1),(1,'a',0.5)])
[array([[-0.07211456]]), array([[-0.19553234]]), array([[-0.21926211]]), array([[0.01699455]]), array([[-0.26390356]]), array([[0.06374809]]), array([[0.0340214]]), array([[-0.18334733]]), array([[-0.438375]]), array([[-0.13844737]])]
</pre>
<p>
<!--START question NNQ -->
</p><div class="question question-pythoncode" id="cs_qdiv_NNQ" style="position: static">
<div id="NNQ_rendered_question">
<div class="ace_editor_wrapper" id="containerNNQ" style="height: 600px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editorNNQ" name="editorNNQ" style="font-size: 16px; height: 600px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 165.6px; top: 228px; height: 19px; width: 9.63333px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: 0px; height: 624px; width: 46px;"><div class="ace_gutter-cell " style="height: 19px;">1</div><div class="ace_gutter-cell " style="height: 19px;">2</div><div class="ace_gutter-cell " style="height: 19px;">3</div><div class="ace_gutter-cell " style="height: 19px;">4</div><div class="ace_gutter-cell " style="height: 19px;">5</div><div class="ace_gutter-cell " style="height: 19px;">6</div><div class="ace_gutter-cell " style="height: 19px;">7</div><div class="ace_gutter-cell " style="height: 19px;">8</div><div class="ace_gutter-cell " style="height: 19px;">9</div><div class="ace_gutter-cell " style="height: 19px;">10</div><div class="ace_gutter-cell " style="height: 19px;">11</div><div class="ace_gutter-cell " style="height: 19px;">12</div><div class="ace_gutter-cell " style="height: 19px;">13</div></div><div class="ace_gutter-active-line" style="top: 228px; height: 19px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 14px;"><div class="ace_content" style="margin-top: 0px; width: 817px; height: 624px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 774.667px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:228px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">NNQ</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">states</span>, <span class="ace_identifier">actions</span>, <span class="ace_identifier">state2vec</span>, <span class="ace_identifier">num_layers</span>, <span class="ace_identifier">num_units</span>, <span class="ace_identifier">epochs</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">actions</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">actions</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">states</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">states</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">epochs</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">state2vec</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">state2vec</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">models</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language">None</span>              <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">get</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">s</span>, <span class="ace_identifier">a</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">update</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">data</span>, <span class="ace_identifier">lr</span>, <span class="ace_identifier">epochs</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Your code here</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">pass</span></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 119.6px; top: 228px; width: 9.63333px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 19px; bottom: 14px;"><div class="ace_scrollbar-inner" style="width: 19px; height: 247px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="height: 19px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 19px; width: 817px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="NNQ" name="NNQ" type="hidden" value="class NNQ:
    def __init__(self, states, actions, state2vec, num_layers, num_units, epochs=1):
        self.actions = actions
        self.states = states
        self.epochs = epochs
        self.state2vec = state2vec
        self.models = None              # Your code here
    def get(self, s, a):
        # Your code here
        pass
    def update(self, data, lr, epochs=1):
        # Your code here
        pass">
<input id="NNQ_log" name="NNQ_log" type="hidden">
<script type="text/javascript">
    var logNNQ = new Array();
    var editorNNQ = ace.edit("editorNNQ");
    editorNNQ.setTheme("ace/theme/textmate");
    editorNNQ.getSession().setMode("ace/mode/python");
    editorNNQ.setShowFoldWidgets(false);
    editorNNQ.setValue('class NNQ:\n    def __init__(self, states, actions, state2vec, num_layers, num_units, epochs=1):\n        self.actions = actions\n        self.states = states\n        self.epochs = epochs\n        self.state2vec = state2vec\n        self.models = None              # Your code here\n    def get(self, s, a):\n        # Your code here\n        pass\n    def update(self, data, lr, epochs=1):\n        # Your code here\n        pass')
    document.getElementById("NNQ").value = editorNNQ.getValue();
    editorNNQ.on("change",function(e){
        editorNNQ.getSession().setUseSoftTabs(true);
        document.getElementById("NNQ").value = editorNNQ.getValue();
    });
    editorNNQ.clearSelection()
    editorNNQ.getSession().setUseSoftTabs(true);
    editorNNQ.on("paste",function(txt){editorNNQ.getSession().setUseSoftTabs(false);});
    editorNNQ.getSession().setTabSize(4);
    editorNNQ.setFontSize("16px");
    document.getElementById("containerNNQ").style.height = "600px";
    document.getElementById("editorNNQ").style.height = "600px";
    editorNNQ.resize(true);
</script>
</div><div>
<span id="NNQ_buttons">
<button class="check btn btn-catsoop" id="NNQ_check" onclick="catsoop.check('NNQ');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="NNQ_submit" onclick="catsoop.submit('NNQ');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="NNQ_viewanswer" onclick="catsoop.viewanswer('NNQ');" style="margin-top: 10px;">View Answer</button></span><span id="NNQ_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'NNQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'NNQ',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 3',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="NNQ_loading_wrapper">
<span id="NNQ_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="NNQ_score_display"></span>
<div class="nsubmits_left" id="NNQ_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="NNQ_solution_container">
<div id="NNQ_solution">
</div>
<div id="NNQ_solution_explanation">
</div>
</div>
<div id="NNQ_message"></div>
</div>
<!--END question NNQ -->
<a class="anchor" name="catsoop_section_4"></a><h2>4) No Exit</h2>
<p><a class="anchor" name="catsoop_section_4_1"></a></p><h3>4.1) Storing Q vs. Learning Updates</h3>
At this point, we have implemented the following:<p></p>
<ul>
<li>We have two ways of storing Q functions:  TabularQ and NNQ</li>
<li>We have two ways of doing Q-learning updates:  Q_learn and Q_learn_batch</li>
</ul>
<p>When we combine NNQ and Q_learn, we get what people often call "Deep Q
Learning". When we combine NNQ and Q_learn_batch we get what people
often call "Fitted Q learning".</p>
<p>The reason that we use only one epoch in Deep Q is that we, right now,
only have a single training example in our hands; if we used a lot of
epochs, we would be telling the NN to predict that one example
correctly, at the cost of potentially forgetting everything else. That
would result in unstable training.</p>
<p>In Fitted Q, on the other hand, we have a large set of training
examples, for many states, that we think "cover" the state space. We
can train a new NN from scratch with all of this data, just to learn
to approximate the value function.  Fitted Q can be thought of as being a lot
like value iteration: We have a Q function, we use it to compute a
bunch of new target values, then we fit a whole new Q function to
those values, etc.</p>
<p><a class="anchor" name="catsoop_section_4_2"></a></p><h3>4.2) Learning to Play</h3><p></p>
<p>In this part, we are going to test these various methods using a very
simple game we call <i>No Exit</i>, that you experienced in the
lab. It's like Breakout, but you can't break out. There is a purple
ball that bounces around a square environment and a yellow paddle that
can be controlled to move up and down on the rightmost side. If the
ball sails past the paddle then the game is over, and enters a
zero-reward absorbing state.  Otherwise, there is a reward of +1 for
every action taken.  There is a small amount of randomness in the way
the ball bounces, so it's not completely deterministic.</p>
<p>You can see it working by loading <code>code_for_hw10.py</code> and
running <tt>test_solve_play()</tt> and just hitting return to watch a
policy that was found using value iteration and the known
model. <b>But, first, you will need to paste in all the definitions
that are incomplete in <code>mdp10.py</code></b>.</p>
<p>The raw representation of a state, for the purposes of No Exit, is
</p><pre>((ball_row, ball_column), (ball_row_velocity, ball_column_velocity), paddle_row, paddle_row_velocity)
</pre>
with a special state for <tt>game_over</tt>.  There is a method
<tt>state2vec</tt> which will take a state of the game and return a
seven-dimensional numpy row vector (the last feature indicates whether
the game is over) which you can use as an input vector for Keras.
<p>In the code file <code>mdp10.py</code> that we have provided, you will
need to paste in the definitions of functions such as for
<code>value_iteration</code> from HW 09 and <code>Q_learn</code> and
<code>Q_learn_batch</code> from this assignment. In order to implement this we have added an additional <code>interactive_fn</code> argument to both <code>Q_learn</code> and <code>Q_learn_batch</code>.</p>
<p>At the end of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw10/code_for_hw10.zip"><code>code_for_hw10.py<code></code></code></a> file are a set of commented test cases that run the
various approaches for learning the game.
</p><ul>
<li> Value Iteration - using an explicit model of the MDP
</li><li> Q-learning - using a tabular representation in Q_learn
</li><li> Batch Q-learning - using a tabular representation in Q_learn_batch
</li><li> NN Q-learning - using neural nets to approximate Q in Q_learn
</li><li> Fitted Q-learning - using neural nets to approximate Q in Q_learn_batch
</li></ul>
<p><b>For each of the learning method and Q model combinations below,
solve the game so that it reliably gets to reward of 100 (that is, the
learned game reliably plays 100 steps without missing the ball,
earning a score of 100).  During learning, you should see a sequence
of lines like: <code>score (5000, 37.5)</code>, which indicates that
after 5000 iterations the average reward over 10 games is 37.5.  We
are checking whether you reach a solution that gets an average reward
100 at least one time. Try playing around with the number of
iterations (an argument to <code>test_learn_play</code>) until you
achieve this point. Note that we will need fewer iterations for
Q_learn_batch, in general (check yourself: why?). After learning, the
code prints a long "upload string" in HEX code.  Enter the upload
strings in the question boxes below.
</b></p>
<p>If you do not see the <tt>score</tt> printouts it's because you did not
call the <tt>interactive_fn</tt> at every iteration.  Look at the code
for <tt>Q_learn</tt> originally provided in the zip file to see
how this should be done.</p>
<p><b>Optional -- viewing game play:</b> The code is set up so that by
default it doesn't bother displaying the game play after the training
is completed. But if you'd like to see the game play, you can!  First,
if you want to see the optimal policy in action based on the Q from
value iteration, run <code>test_solve_play(draw=True)</code> and you
can watch it go.  Hit 'return' after each step.  Similarly, for the
cases involving Q learning (rather than value iteration), you can pass
the argument <code>draw = True</code> into
<code>test_learn_play()</code>, along with the other arguments that
determine the learning approach. Warning: many people have broken
<tt>matplotlib</tt> installations and will not be able to see the
game. Don't panic; it's purely optional to see the game play.</p>
<p><b>Note on computation time</b>: the training stage can take a relatively long time 
(sometimes tens of minutes) for the
default dimension of the game, <code>d = 6</code>. For debugging, you
might pass smaller values such as <code>d = 4</code> into the
<code>test_solve_play</code> or <code>test_learn_play</code>
functions.</p>
<p>Once submitted, the questions below print the decoded
information in the pasted-in string. This consists of a list
of three elements: boolean (True if TabularQ is used, False if NNQ is used);
boolean (True if batch Q_learn_batch is used, False if Q_learn is used);
a list of (iteration_number, score) tuples resulting during learning. A
successful submission will have a 100.0 score achieved during the learning.</p>
<p><b>4A)</b>
<!--START question q000004 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000004" style="position: static">
<div id="q000004_rendered_question">
Enter the string printed by tabular Q_learn: <input id="q000004" name="q000004" size="50" type="text" value="">
</div><div>
<span id="q000004_buttons">
<button class="submit btn btn-catsoop" id="q000004_submit" onclick="catsoop.submit('q000004');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000004_viewanswer" onclick="catsoop.viewanswer('q000004');" style="margin-top: 10px;">View Answer</button></span><span id="q000004_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000004',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000004_loading_wrapper">
<span id="q000004_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000004_score_display"></span>
<div class="nsubmits_left" id="q000004_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000004_solution_container">
<div id="q000004_solution">
</div>
<div id="q000004_solution_explanation">
</div>
</div>
<div id="q000004_message"></div>
</div>
<!--END question q000004 -->
<p><b>4B)</b>
<!--START question q000005 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000005" style="position: static">
<div id="q000005_rendered_question">
Enter the string printed by tabular Q_learn_batch: <input id="q000005" name="q000005" size="50" type="text" value="">
</div><div>
<span id="q000005_buttons">
<button class="submit btn btn-catsoop" id="q000005_submit" onclick="catsoop.submit('q000005');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000005_viewanswer" onclick="catsoop.viewanswer('q000005');" style="margin-top: 10px;">View Answer</button></span><span id="q000005_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000005',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000005_loading_wrapper">
<span id="q000005_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000005_score_display"></span>
<div class="nsubmits_left" id="q000005_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000005_solution_container">
<div id="q000005_solution">
</div>
<div id="q000005_solution_explanation">
</div>
</div>
<div id="q000005_message"></div>
</div>
<!--END question q000005 -->
<p><b>4C)</b>
<!--START question q000006 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000006" style="position: static">
<div id="q000006_rendered_question">
Enter the string printed by NNQ Q_learn: <input id="q000006" name="q000006" size="50" type="text" value="">
</div><div>
<span id="q000006_buttons">
<button class="submit btn btn-catsoop" id="q000006_submit" onclick="catsoop.submit('q000006');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000006_viewanswer" onclick="catsoop.viewanswer('q000006');" style="margin-top: 10px;">View Answer</button></span><span id="q000006_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000006',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000006_loading_wrapper">
<span id="q000006_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000006_score_display"></span>
<div class="nsubmits_left" id="q000006_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000006_solution_container">
<div id="q000006_solution">
</div>
<div id="q000006_solution_explanation">
</div>
</div>
<div id="q000006_message"></div>
</div>
<!--END question q000006 -->
<p><b>4D)</b>
<!--START question q000007 -->
</p><div class="question question-pythonic" id="cs_qdiv_q000007" style="position: static">
<div id="q000007_rendered_question">
Enter the string printed by Fitted Q_learn (NNQ in Q_learn_batch): <input id="q000007" name="q000007" size="50" type="text" value="">
</div><div>
<span id="q000007_buttons">
<button class="submit btn btn-catsoop" id="q000007_submit" onclick="catsoop.submit('q000007');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000007_viewanswer" onclick="catsoop.viewanswer('q000007');" style="margin-top: 10px;">View Answer</button></span><span id="q000007_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4.2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000007',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 4 in Section 4.2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000007_loading_wrapper">
<span id="q000007_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000007_score_display"></span>
<div class="nsubmits_left" id="q000007_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000007_solution_container">
<div id="q000007_solution">
</div>
<div id="q000007_solution_explanation">
</div>
</div>
<div id="q000007_message"></div>
</div>
<!--END question q000007 -->
<p>With this experience in hand, you might compare how many iterations are
needed to reliably get to something that gets reward of 100, for each
of the learning algorithm (Q_learn and Q_learn_batch) and Q model (TabularQ and
NNQ) combinations. Think about why more or fewer iterations are required
in these different cases.</p>
<a class="anchor" name="catsoop_section_5"></a><h2>5) Optional Challenges</h2>
<p>There are a lot of possible extensions!!!</p>
<ul>
<li> You can try bigger game instances.
</li><li> You can change the ball speed.
</li><li> You can change the game behavior.
</li><li> You can try different network architectures, e.g. one network with multiple outputs, one for each action.
</li><li> You can try to use a CNN using the board directly as an image input.  Talk to a staff member for pointers on how to do this.
</li></ul>
<p><script src="/queue/fall18/js/queue.js"></script>
<script>
    catsoop.plugins.queue = {
        url_root: '/queue/fall18/',
        is_staff: false,
        container: "body",
        view: 'student_popup',
        room: 'default',
    };
    </script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
catsoop.all_questions = ['q000000', 'q000001', 'q000002', 'q000003', 'TabularQ', 'QLearn', 'QLearnBatch', 'NNQ', 'q000004', 'q000005', 'q000006', 'q000007'];
catsoop.username = 'AlexandrParkhomenko';
catsoop.api_token = 'ou3PvadLMR1zwQVIhEQLlWt6elMqlxph2gVU1xhXjyyRUXW4QMJ8O3E5H1HxxhLq0PFguf';
catsoop.this_path = 'https://introml_oll.odl.mit.edu/cat-soop/6.036/homework/hw10';
catsoop.path_info = ['6.036', 'homework', 'hw10'];
catsoop.course = '6.036';
catsoop.url_root = 'https://introml_oll.odl.mit.edu/cat-soop';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";
</script></p>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
      This page was last updated on Wednesday April 24, 2019 at 02:26:39 PM (revision <code>73ed03a</code>).<br>&nbsp;<br>Sec None Release 1900-01-01 00:00:00 Due 9999-12-31 23:59:59<br><script type="text/javascript">document.getElementById("cs_header").style.display="none";</script>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v14.0.0.dev144.<br>
      CAT-SOOP is <a href="http://www.fsf.org/about/what-is-free-software" target="_blank">free/libre software</a>, available under the terms<br>of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://introml_oll.odl.mit.edu/cat-soop/_util/source.zip?course=6.036" target="_blank">Download Source Code</a><br>
<a href="https://introml_oll.odl.mit.edu/cat-soop/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</footer>



<div style="clear: both; display: block;"></div></body></html>


