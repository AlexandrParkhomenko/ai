<html><head>
<!-- This page was generated by CAT-SOOP 14.0.0.dev144.  miau. -->
<meta charset="utf-8">
<title>6.036 Spring 2019</title>
<link href="data:image/gif;base64,R0lGODlhEAAQAKEAAAAAAAAzZv///wAAACH5BAEKAAMALAAAAAAQABAAAAIynI85oL3A3IFARFehlcvW3XyaR5XiJ6Tqmo6sOsZoS2viets0XJ+vzCoFXS8Yw4SkDAoAOw==" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/themes/base.css" rel="stylesheet" type="text/css">
<!-- librejs compatibility -->
<script>
    /*
    @licstart  The following is the entire license notice for the JavaScript
    code in this page.

    The Javascript on this page is part of CAT-SOOP
    Copyright (C) 2011-2019 by The CAT-SOOP Developers <catsoop-dev@mit.edu>

    The Javascript code on this page is free software: you can redistribute it
    and/or modify it under the terms of the GNU Affero General Public License
    as published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.  This code is distributed
    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE.  See the full text of the license for
    more details (https://www.gnu.org/licenses/agpl-3.0.en.html).

    As additional permission under GNU AGPL version 3 section 7, you may
    distribute non-source (e.g., minimized or compacted) forms of that code
    without the copy of the GNU AGPL normally required by section 4, provided
    you include this license notice and a URL through which recipients can
    access the Corresponding Source.

    @licend  The above is the entire license notice for the JavaScript code in
    this page.
    */
    </script>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    document.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });
    </script>
<!-- load in katex and mathjax, and CAT-SOOP-specific math rendering  -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css">
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/mathjax/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/cs_math.js" type="text/javascript"></script>
<!-- Syntax Highlighting -->
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_base/scripts/highlight/cs_highlight.pack.min.js" type="text/javascript"></script>
<script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
<style>
      :root {
        --cs-base-bg-color: #00bfff;
        --cs-light-bg-color: #32cbff;
        --cs-base-font-color: #ffffff;
        --cs-light-font-color: #000;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.3/iframeResizer.contentWindow.min.js" type="text/javascript"></script><link href="/queue/fall18/css/queue.css" rel="stylesheet">
<!--JS for questions-->
<script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/ace.js" type="text/javascript"></script><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style>
<meta content="width=device-width, initial-scale=1" name="viewport">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script src="https://cdn.jsdelivr.net/ace/1.2.4/noconflict/mode-python.js"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body style="margin: 0px;"><div id="MathJax_Message" style="display: none;"></div>
<header id="cs_header" style="display: none;">
<div class="nav-container">
<div class="cs_header_text"><a href="https://introml_oll.odl.mit.edu/cat-soop/6.036"></a></div>
<a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<center><h1></h1></center>
<p>A code and data folder that will be useful for doing this lab can
be found <a href="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw07/code_for_hw7.zip"><strong>here</strong></a>.  Download
this to your computer, or alternatively, use the <a href="https://colab.research.google.com/drive/14pGqETHUQpCCVlkAU4rB_ueh5RjzcqzC"><strong>colab notebook</strong></a>.</p>
<p>This homework continues the exploration and implementation of
<a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week6/neural_networks/1">neural networks</a> as discussed in the notes. </p>
<p>In particular, this homework
considers neural networks with multiple layers. Each layer has
multiple inputs and outputs, and can be broken down into two parts:</p>
<ul>
<li>A <strong>linear</strong> module that implements a linear transformation: <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>)</mo><mo>+</mo><msub><msub><mi>W</mi><mn>0</mn></msub><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">z_j = (\sum^{m}_{i=1} x_i W_{i,j}) + {W_0}_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.104em; vertical-align: -0.29971em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.01914em; vertical-align: -0.335808em;"></span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.261964em;"><span class="" style="top: -2.5003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.335808em;"><span class=""></span></span></span></span></span></span></span></span></span></span> specified by a weight matrix <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span></span></span> and a bias vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">W_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.  The output is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>z</mi><mi>n</mi></msub><msup><mo>]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[z_1, \ldots, z_n]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span>.</li>
<li>An <strong>activation</strong> module that applies an activation function to the outputs of the linear module for some activation function <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span></span></span></span>, such as Tanh or ReLU in the hidden layers or Softmax (see below) at the output layer.  We write the output as: : <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>f</mi><mo>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>f</mi><mo>(</mo><msub><mi>z</mi><mi>m</mi></msub><mo>)</mo><msup><mo>]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[f(z_1), \ldots, f(z_m)]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span>, although technically, for some activation functions such as softmax, each output will depend on all the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, not just one.</li>
</ul>
<p>We will use the following notation for quantities in a network:</p>
<ul>
<li>Inputs to the network are <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">x_1, \ldots, x_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</li>
<li>Number of layers is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span></span></span></span></span></li>
<li>There are <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">m^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> inputs to layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span></li>
<li>There are <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>=</mo><msup><mi>m</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^l = m^{l+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> outputs from layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span></li>
<li>The weight matrix for layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span> is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">W^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span>, an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>×</mo><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">m^l \times n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> matrix, and the bias vector (offset) is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>W</mi><mn>0</mn><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">W_0^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09722em; vertical-align: -0.248108em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.45189em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector</li>
<li>The outputs of the linear module for layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span> are known as <b>pre-activation</b> values and denoted <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">z^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>The activation function at layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span> is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mi>l</mi></msup><mo>(</mo><mo>⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">f^l(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span></li>
<li>Layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span> activations are <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mi>l</mi></msup><mo>=</mo><mo>[</mo><msup><mi>f</mi><mi>l</mi></msup><mo>(</mo><msubsup><mi>z</mi><mn>1</mn><mi>l</mi></msubsup><mo>)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mi>f</mi><mi>l</mi></msup><mo>(</mo><msubsup><mi>z</mi><msup><mi>n</mi><mi>l</mi></msup><mi>l</mi></msubsup><mo>)</mo><msup><mo>]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">a^l = [f^l(z^l_1), \ldots, f^l(z^l_{n^l})]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19353em; vertical-align: -0.34442em;"></span><span class="mopen">[</span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.45189em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.35558em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.782029em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34442em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>The output of the network is the values <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mi>L</mi></msup><mo>=</mo><mo>[</mo><msup><mi>f</mi><mi>L</mi></msup><mo>(</mo><msubsup><mi>z</mi><mn>1</mn><mi>L</mi></msubsup><mo>)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mi>f</mi><mi>L</mi></msup><mo>(</mo><msubsup><mi>z</mi><msup><mi>n</mi><mi>L</mi></msup><mi>L</mi></msubsup><mo>)</mo><msup><mo>]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">a^L = [f^L(z^L_1), \ldots, f^L(z^L_{n^L})]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.1802em; vertical-align: -0.338865em;"></span><span class="mopen">[</span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.45189em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.04398em;" class="mord mathdefault">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.36114em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.774093em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.338865em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>Loss function <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Loss(a, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span><span class="mclose">)</span></span></span></span></span> measures the loss of output values <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">a</span></span></span></span></span> when the target is <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span></span></span></span></span></li>
</ul>
<p>Here is an illustrative picture:
</p><div class="inline_imgs">
<center>
<img src="https://introml_oll.odl.mit.edu/cat-soop/_static/6.036/homework/hw07/nn_notation_new.png" width="100%">
</center>
</div>
<a class="anchor" name="catsoop_section_1"></a><h2>1) Backpropagation</h2>
<p>The materials for week 6 and week 7 will be helpful here, including the
<a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week6/week6_video/1">week6 lecture</a> and
<a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week7/week7_video/1">week7 lecture</a>. </p>
<p>We have seen in the <a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week6/neural_networks/5"> lecture notes </a> how to train multi-layer neural networks as
classifiers using stochastic gradient descent (SGD). One of the key
steps in the SGD method is the evaluation of the gradient of the loss
function with respect to the model parameters.  In this
problem, you will derive the backpropagation method for a general
<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span></span></span></span></span>-layer neural network.  We'll exploit the decomposition of the
network into <em>linear</em> and <em>activation</em> modules that we introduced at
the start of this homework. Remember that we've defined the shapes of the
various quantities at the start of the homework.</p>
<ul>
<li>
<p>Each linear module has a <code>forward</code> method that takes in a column
vector of activations <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span></span> (from the previous layer) and returns a
column vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span></span> of pre-activations; it can also store its input or
output vectors for use by other methods (e.g., for subsequent
backpropagation).</p>
</li>
<li>
<p>Each activation module has a <code>forward</code> method that takes in a column
vector of pre-activations <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span></span> and returns a column vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span></span> of
activations; it can also store its input or output vectors for use by
other methods (e.g., for subsequent backpropagation).</p>
</li>
<li>
<p>Each linear module has a <code>backward</code> method that takes in a
column vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">Z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> and returns a column
vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">A</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>.  This module also computes
and stores <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">W</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial W_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.13889em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>, the gradients with respect to the weights.</p>
</li>
<li>
<p>Each activation module has a <code>backward</code> method that takes in a
column vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">A</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> and returns a column
vector <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">Z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>.</p>
</li>
</ul>
<p>The backpropagation algorithm will consist of:</p>
<ul>
<li>
<p>Calling the <code>forward</code> method of each module in turn, feeding
the output of one module as the input to the next; starting with the
input values of the network.  After this pass, we have a predicted
value for the final network output.</p>
</li>
<li>
<p>Calling the <code>backward</code> method of each module in reverse
order, using the returned value from one module as the input value of
the previous one. The starting value for the backward method is
<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>(</mo><msup><mi>a</mi><mi>L</mi></msup><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><msup><mi>a</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">\partial Loss(a^L, y)/\partial a^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span><span class="mclose">)</span><span class="mord">/</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span></span></span></span></span>, where <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">a^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span></span></span></span></span> is the activation of
the final layer (computed during the forward pass) and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span></span></span></span></span> is the
desired output (the label).</p>
</li>
</ul>
<p><a class="anchor" name="catsoop_section_1_1"></a></p><h3>1.1) Linear Module</h3><p></p>
<p>The <code>forward</code> method, given <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span></span> from the previous layer, implements:
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>=</mo><msup><mi>W</mi><mi>T</mi></msup><mi>A</mi><mo>+</mo><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">Z = W^T A + W_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.974661em; vertical-align: -0.08333em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
and stores the input <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span></span> to be used by the <code>backward</code> method. <p></p>
<p>Recall that there are <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>=</mo><msup><mi>m</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^l = m^{l+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> outputs from layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span>. For layer <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span></span></span> is a <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>×</mo><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">m^l \times n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> matrix, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">W_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is a <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector, and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span></span> from the previous layer is a <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^{l-1} \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> (or <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>) vector. 
Given these shapes, make sure that you understand why the forward equation has <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">W^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span> and not <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span></span></span>. </p>
<p>The following questions ask for a matrix expression involving any of <code>A</code>, <code>Z</code>, <code>dLdA</code>, <code>dLdZ</code>,<code>W</code> and <code>W_0</code>.</p>
<p><strong> Enter your answers as Python expressions.  You can use
  <code>transpose(x)</code> for transpose of an array, and <code>x@y</code> to indicate a
  matrix product of two arrays.  Remember that <code>x*y</code> denotes component-wise multiplication.</strong></p>
<p>The <code>backward</code> method, given <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">Z</mi></mrow><mo>=</mo><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">{\tt dLdZ} = \partial Loss/\partial Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">Z</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord">/</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span></span> (an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector), returns <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">A</mi></mrow><mo>=</mo><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">{\tt dLdA} = \partial Loss/\partial A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">A</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord">/</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span></span></span> (an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector):
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial Loss}{\partial A} = \frac{\partial Z}{\partial A} \frac{\partial Loss}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p></p>
<p><b>1.1.A)</b>
<!--START question q000000 -->
</p><div class="question question-expression" id="cs_qdiv_q000000" style="position: static">
<div id="q000000_rendered_question">
<tt>dLdA</tt>= <input id="q000000" name="q000000" size="50" type="text" value="W@dLdZ">
<span id="imageq000000"></span>
</div><div>
<span id="q000000_buttons">
<button class="check btn btn-catsoop" id="q000000_check" onclick="catsoop.check('q000000');" style="margin-top: 10px;">Check Syntax</button>
<button class="submit btn btn-catsoop" id="q000000_submit" onclick="catsoop.submit('q000000');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000000_viewanswer" onclick="catsoop.viewanswer('q000000');" style="margin-top: 10px;">View Answer</button></span><span id="q000000_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1.1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000000',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 1.1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000000_loading_wrapper">
<span id="q000000_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000000_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000000_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000000_solution_container">
<div id="q000000_solution">
</div>
<div id="q000000_solution_explanation">
</div>
</div>
<div id="q000000_message">
<script type="text/javascript">document.getElementById("q000000_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<script type="text/javascript">document.getElementById('imageq000000').innerHTML = '';</script>
<div id="exprq000000">Your entry was parsed as:<br><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">W</mi><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">L</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">Z</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{W}\mathbf{dLdZ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.01597em;" class="mord mathbf">W</span></span><span class="mord"><span class="mord mathbf">d</span><span class="mord mathbf">L</span><span class="mord mathbf">d</span><span class="mord mathbf">Z</span></span></span></span></span></span></div></div><script type="text/javascript">catsoop.render_all_math(document.getElementById("exprq000000"), true);</script></div>
</div>
<!--END question q000000 -->
<p>The <code>backward</code> method, given <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">Z</mi></mrow><mo>=</mo><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">{\tt dLdZ} = \partial Loss/\partial Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">Z</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord">/</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span></span>, also computes <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">W</mi></mrow><annotation encoding="application/x-tex">{\tt dLdW}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">W</span></span></span></span></span></span></span> (an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>×</mo><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">m^l \times n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> matrix) and <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">W</mi><mn mathvariant="monospace">0</mn></mrow><annotation encoding="application/x-tex">{\tt dLdW0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">W</span><span class="mord mathtt">0</span></span></span></span></span></span></span> (an <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mi>l</mi></msup><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^l \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> vector), and stores them in the module instance.</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">W</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">{\tt dLdW} = \frac{\partial Loss}{\partial W} = \frac{\partial Z}{\partial W} \frac{\partial Loss}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">W</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p></p>
<p><b>1.1.B)</b>
<!--START question q000001 -->
</p><div class="question question-expression" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
<tt>dLdW</tt>= <input id="q000001" name="q000001" size="50" type="text" value="A@transpose(dLdZ)">
<span id="imageq000001"></span>
</div><div>
<span id="q000001_buttons">
<button class="check btn btn-catsoop" id="q000001_check" onclick="catsoop.check('q000001');" style="margin-top: 10px;">Check Syntax</button>
<button class="submit btn btn-catsoop" id="q000001_submit" onclick="catsoop.submit('q000001');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000001_viewanswer" onclick="catsoop.viewanswer('q000001');" style="margin-top: 10px;">View Answer</button></span><span id="q000001_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1.1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000001',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 2 in Section 1.1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000001_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message">
<script type="text/javascript">document.getElementById("q000001_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<script type="text/javascript">document.getElementById('imageq000001').innerHTML = '';</script>
<div id="exprq000001">Your entry was parsed as:<br><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">A</mi><msup><mrow><mo fence="true">(</mo><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">L</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">Z</mi></mrow><mo fence="true">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{A}\left({\mathbf{dLdZ}}\right)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.23123em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbf">A</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">d</span><span class="mord mathbf">L</span><span class="mord mathbf">d</span><span class="mord mathbf">Z</span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></div></div><script type="text/javascript">catsoop.render_all_math(document.getElementById("exprq000001"), true);</script></div>
</div>
<!--END question q000001 -->
<p>and
</p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">W</mi><mn mathvariant="monospace">0</mn></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">{\tt dLdW0} = \frac{\partial Loss}{\partial W_0} = \frac{\partial Loss}{\partial Z} \frac{\partial Z}{\partial W_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">W</span><span class="mord mathtt">0</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.20744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.20744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p></p>
<p><b>1.1.C)</b>
<!--START question q000002 -->
</p><div class="question question-expression" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
<tt>dLdW0</tt>= <input id="q000002" name="q000002" size="50" type="text" value="dLdZ">
<span id="imageq000002"></span>
</div><div>
<span id="q000002_buttons">
<button class="check btn btn-catsoop" id="q000002_check" onclick="catsoop.check('q000002');" style="margin-top: 10px;">Check Syntax</button>
<button class="submit btn btn-catsoop" id="q000002_submit" onclick="catsoop.submit('q000002');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="q000002_viewanswer" onclick="catsoop.viewanswer('q000002');" style="margin-top: 10px;">View Answer</button></span><span id="q000002_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1.1',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'q000002',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 3 in Section 1.1',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="q000002_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message">
<script type="text/javascript">document.getElementById("q000002_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<script type="text/javascript">document.getElementById('imageq000002').innerHTML = '';</script>
<div id="exprq000002">Your entry was parsed as:<br><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">L</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{dLdZ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">d</span><span class="mord mathbf">L</span><span class="mord mathbf">d</span><span class="mord mathbf">Z</span></span></span></span></span></span></div></div><script type="text/javascript">catsoop.render_all_math(document.getElementById("exprq000002"), true);</script></div>
</div>
<!--END question q000002 -->
<p>We will use <code>dLdW</code> and <code>dLdW0</code> as the gradient values in SGD.</p>
<p><a class="anchor" name="catsoop_section_1_2"></a></p><h3>1.2) Activation Module</h3><p></p>
<p>Activation modules don't have any weights and so they are simpler.</p>
<p>The <code>forward</code> method for functions like <em>tanh</em> or <em>sigmoid</em>, given
<span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span></span></span>, return the function on the vector, componentwise.  <em>Softmax</em>
operates on the whole vector, as described earlier, and will need some special treatment.</p>
<p>The <code>backward</code> method, given <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">A</mi></mrow><mo>=</mo><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">{\tt dLdA} = \partial Loss/\partial A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">A</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord">/</span><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span></span></span>,
returns: </p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>L</mi><mi>d</mi><mi>Z</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">dLdZ = \frac{\partial Loss}{\partial Z} = \frac{\partial Loss}{\partial A} \frac{\partial A}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">L</span><span class="mord mathdefault">d</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.05556em;" class="mord">∂</span><span class="mord mathdefault">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>  In this case, <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>l</mi></msup><mo>=</mo><msup><mi>n</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">m^l = n^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.01968em;" class="mord mathdefault mtight">l</span></span></span></span></span></span></span></span></span></span></span></span> and the quantities are column vectors of that size.<p></p>
<p>For Softmax <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mi>S</mi><mi>M</mi><mo>(</mo><mi>Z</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">= SM(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.05764em;" class="mord mathdefault">S</span><span style="margin-right: 0.10903em;" class="mord mathdefault">M</span><span class="mopen">(</span><span style="margin-right: 0.07153em;" class="mord mathdefault">Z</span><span class="mclose">)</span></span></span></span></span> at the output layer and assuming that we are
using <em>NLL</em> as the <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>(</mo><mi>A</mi><mo separator="true">,</mo><mi>Y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Loss(A, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">Y</span><span class="mclose">)</span></span></span></span></span> function, we have seen that there is a
simple form for <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">L</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">Z</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">{\tt dLdZ} = \frac{\partial Loss}{\partial Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">d</span><span class="mord mathtt">L</span><span class="mord mathtt">d</span><span class="mord mathtt">Z</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">Z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05556em;" class="mord mtight">∂</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>;
namely, it is the prediction error <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>−</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">A - Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">Y</span></span></span></span></span>.  A similar result holds
when using <em>NLL</em> with a sigmoid output activation or a quadratic loss
with a linear output activation.  Note that for hinge loss with a
linear activation, the form of <tt>dLdZ</tt> is different (see the
lecture notes on the hinge loss).</p>
<a class="anchor" name="catsoop_section_2"></a><h2>2) Implementing Neural Networks</h2>
<p><strong> Please watch the lecture videos for this week before attempting this problem. </strong> Additionally, please review the <a href="https://openlearninglibrary.mit.edu/courses/course-v1:MITx+6.036+1T2019/courseware/Week4/gradient_descent/5?activate_block_id=block-v1%3AMITx%2B6.036%2B2019_Spring%2Btype%40vertical%2Bblock%40gradient_descent_stochastic_gradient_descent_vert"> SGD notes </a>.</p>
<p>Although for "real" applications you want to use one of the many
packaged implementations of neural networks (we'll start using one of
those soon), there is no substitute for implementing one yourself to
get an in-depth understanding.  Luckily, that is relatively easy to do
if we're not too concerned with maximum efficiency.</p>
<p>We'll use the modular implementation that we guided you through in the previous problem, which leads to
clean code.  The basic framework for SGD training is given
below.  We can construct a network and train it as follows:
</p><pre># build a 3-layer network
net = Sequential([Linear(2,3), Tanh(),
                  Linear(3,3), Tanh(),
    	          Linear(3,2), SoftMax()])
# train the network on data and labels
net.sgd(X, Y)
</pre>
<p>You will need to fill in the missing code.  We encourage you to test in your own Python
environment and then paste your answer and verify the results.  The
test cases are provided in the code distribution linked at the top of the page.  <strong>The code distribution includes additional test methods that
will test each of the methods in turn, so you can debug
incrementally.</strong>  Below are some
hints for some of the methods:</p>
<ul>
<li>
<p><code>Sequential.sgd</code>: Implement SGD.  Randomly pick a data point Xt, Yt by using
  <code>np.random.randint</code> to choose a random index into the data.
  Compute the predicted output Ypred for Xt with the forward method.
  Compute the loss for Ypred relative to Yt.  Use the backward method to
  compute the gradients.  Use the sgd_step method to change the
  weights. Repeat.</p>
</li>
<li>
<p><code>SoftMax.class_fun</code>: Given the column vector of class probabilities
  for each point (computed by Softmax), this returns a vector of the
  classes (integers) with the highest probability for each point.</p>
</li>
<li>
<p>We will (later) be generalizing SGD to operate on a "mini-batch" of
  data points instead of a single point.  You should strive for an
  implementation of the forward, backward, and class_fun methods that
  works with batches of data. Whenever <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span> is mentioned as part of the shape
  of a matrix in the code, this <span class=""><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span> refers to the number of points.</p>
</li>
<li>
<p><strong>A note on debugging.</strong> We have provided you with a file
    <code>code_for_hw7.py</code> (as well as a colab) that has a copy of the template below and a
    detailed set of outputs to check your implementation. <b>Trying to debug directly on MITx will
    not be a good experience; intermediate tests
    for each method are available ONLY in the code file/colab.</b></p>
</li>
</ul>
<p>
<!--START question network -->
</p><div class="question question-pythoncode" id="cs_qdiv_network" style="position: static">
<div id="network_rendered_question">
<div class="ace_editor_wrapper" id="containernetwork" style="height: 1400px;">
<div class="embedded_ace_code ace_editor ace-tm" id="editornetwork" name="editornetwork" style="font-size: 16px; height: 1400px;"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; left: 59px; top: 1369px; height: 19px; width: 9.6px;" wrap="off"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer" style="margin-top: -18px; height: 1426px; width: 55px;"><div class="ace_gutter-cell " style="height: 19px;">74</div><div class="ace_gutter-cell " style="height: 19px;">75</div><div class="ace_gutter-cell " style="height: 19px;">76</div><div class="ace_gutter-cell " style="height: 19px;">77</div><div class="ace_gutter-cell " style="height: 19px;">78</div><div class="ace_gutter-cell " style="height: 19px;">79</div><div class="ace_gutter-cell " style="height: 19px;">80</div><div class="ace_gutter-cell " style="height: 19px;">81</div><div class="ace_gutter-cell " style="height: 19px;">82</div><div class="ace_gutter-cell " style="height: 19px;">83</div><div class="ace_gutter-cell " style="height: 19px;">84</div><div class="ace_gutter-cell " style="height: 19px;">85</div><div class="ace_gutter-cell " style="height: 19px;">86</div><div class="ace_gutter-cell " style="height: 19px;">87</div><div class="ace_gutter-cell " style="height: 19px;">88</div><div class="ace_gutter-cell " style="height: 19px;">89</div><div class="ace_gutter-cell " style="height: 19px;">90</div><div class="ace_gutter-cell " style="height: 19px;">91</div><div class="ace_gutter-cell " style="height: 19px;">92</div><div class="ace_gutter-cell " style="height: 19px;">93</div><div class="ace_gutter-cell " style="height: 19px;">94</div><div class="ace_gutter-cell " style="height: 19px;">95</div><div class="ace_gutter-cell " style="height: 19px;">96</div><div class="ace_gutter-cell " style="height: 19px;">97</div><div class="ace_gutter-cell " style="height: 19px;">98</div><div class="ace_gutter-cell " style="height: 19px;">99</div><div class="ace_gutter-cell " style="height: 19px;">100</div><div class="ace_gutter-cell " style="height: 19px;">101</div><div class="ace_gutter-cell " style="height: 19px;">102</div><div class="ace_gutter-cell " style="height: 19px;">103</div><div class="ace_gutter-cell " style="height: 19px;">104</div><div class="ace_gutter-cell " style="height: 19px;">105</div><div class="ace_gutter-cell " style="height: 19px;">106</div><div class="ace_gutter-cell " style="height: 19px;">107</div><div class="ace_gutter-cell " style="height: 19px;">108</div><div class="ace_gutter-cell " style="height: 19px;">109</div><div class="ace_gutter-cell " style="height: 19px;">110</div><div class="ace_gutter-cell " style="height: 19px;">111</div><div class="ace_gutter-cell " style="height: 19px;">112</div><div class="ace_gutter-cell " style="height: 19px;">113</div><div class="ace_gutter-cell " style="height: 19px;">114</div><div class="ace_gutter-cell " style="height: 19px;">115</div><div class="ace_gutter-cell " style="height: 19px;">116</div><div class="ace_gutter-cell " style="height: 19px;">117</div><div class="ace_gutter-cell " style="height: 19px;">118</div><div class="ace_gutter-cell " style="height: 19px;">119</div><div class="ace_gutter-cell " style="height: 19px;">120</div><div class="ace_gutter-cell " style="height: 19px;">121</div><div class="ace_gutter-cell " style="height: 19px;">122</div><div class="ace_gutter-cell " style="height: 19px;">123</div><div class="ace_gutter-cell " style="height: 19px;">124</div><div class="ace_gutter-cell " style="height: 19px;">125</div><div class="ace_gutter-cell " style="height: 19px;">126</div><div class="ace_gutter-cell " style="height: 19px;">127</div><div class="ace_gutter-cell " style="height: 19px;">128</div><div class="ace_gutter-cell " style="height: 19px;">129</div><div class="ace_gutter-cell " style="height: 19px;">130</div><div class="ace_gutter-cell " style="height: 19px;">131</div><div class="ace_gutter-cell " style="height: 19px;">132</div><div class="ace_gutter-cell " style="height: 19px;">133</div><div class="ace_gutter-cell " style="height: 19px;">134</div><div class="ace_gutter-cell " style="height: 19px;">135</div><div class="ace_gutter-cell " style="height: 19px;">136</div><div class="ace_gutter-cell " style="height: 19px;">137</div><div class="ace_gutter-cell " style="height: 19px;">138</div><div class="ace_gutter-cell " style="height: 19px;">139</div><div class="ace_gutter-cell " style="height: 19px;">140</div><div class="ace_gutter-cell " style="height: 19px;">141</div><div class="ace_gutter-cell " style="height: 19px;">142</div><div class="ace_gutter-cell " style="height: 19px;">143</div><div class="ace_gutter-cell " style="height: 19px;">144</div><div class="ace_gutter-cell " style="height: 19px;">145</div><div class="ace_gutter-cell " style="height: 19px;">146</div><div class="ace_gutter-cell " style="height: 19px;">147</div></div><div class="ace_gutter-active-line" style="top: 1369px; height: 19px;"></div></div><div class="ace_scroller" style="left: 55px; right: 12px; bottom: 12px;"><div class="ace_content" style="margin-top: -18px; width: 834px; height: 1426px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 772px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:19px;top:1387px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">SoftMax</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Module</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Output activation</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">Z</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">exp</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Z</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">np</span>.<span class="ace_identifier">exp</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Z</span><span class="ace_paren ace_rparen">)</span>,<span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span> <span class="ace_comment"># Your code: (n, b)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">dLdZ</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Assume that dLdZ is passed in</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">dLdZ</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">class_fun</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">Ypred</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Return class indices</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">argmax</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Ypred</span>,<span class="ace_identifier">axis</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span>  <span class="ace_comment"># Your code: (1, b)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_comment"># Loss modules</span></div><div class="ace_line" style="height:19px"><span class="ace_comment">#</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># Each loss module has a forward method that takes in a batch of</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># predictions Ypred (from the previous layer) and labels Y and returns</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># a scalar loss value.</span></div><div class="ace_line" style="height:19px"><span class="ace_comment">#</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># The NLL module has a backward method that returns dLdZ, the gradient</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># with respect to the preactivation to SoftMax (note: not the</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># activation!), since we are always pairing SoftMax activation with</span></div><div class="ace_line" style="height:19px"><span class="ace_comment"># NLL loss</span></div><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">NLL</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Module</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Loss</span></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">Ypred</span>, <span class="ace_identifier">Y</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">Ypred</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Ypred</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">Y</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">Y</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_keyword ace_operator">-</span><span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">np</span>.<span class="ace_identifier">log</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Ypred</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">*</span> <span class="ace_identifier">Y</span><span class="ace_paren ace_rparen">)</span>  <span class="ace_comment"># Your code: return loss (scalar)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Use stored self.Ypred, self.Y</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">Ypred</span> <span class="ace_keyword ace_operator">-</span><span class="ace_identifier">self</span>.<span class="ace_identifier">Y</span> <span class="ace_comment"># Your code (n, b)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"><span class="ace_comment"># Neural Network implementation</span></div><div class="ace_line" style="height:19px"><span class="ace_keyword">class</span> <span class="ace_identifier">Sequential</span>:</div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">__init__</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">modules</span>, <span class="ace_identifier">loss</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># List of modules, loss module</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">modules</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">loss</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    </div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">sgd</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">X</span>, <span class="ace_identifier">Y</span>, <span class="ace_identifier">iters</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">100</span>, <span class="ace_identifier">lrate</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.005</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Train</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">D</span>, <span class="ace_identifier">N</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">X</span>.<span class="ace_identifier">shape</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">it</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">iters</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">i</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">randint</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">N</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">X_i</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">cv</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">X</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">i</span><span class="ace_paren ace_rparen">])</span> <span class="ace_comment">#.reshape(-1,1)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">Y_i</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">cv</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Y</span><span class="ace_paren ace_lparen">[</span>:,<span class="ace_identifier">i</span><span class="ace_paren ace_rparen">])</span> <span class="ace_comment">#.reshape(-1,1)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">Ypred</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">self</span>.<span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">X_i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment">#cur_loss=self.loss.forward(Ypred,Y_i)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Ypred</span><span class="ace_keyword ace_operator">-</span><span class="ace_identifier">Y_i</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">self</span>.<span class="ace_identifier">sgd_step</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">lrate</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">Xt</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Compute Ypred</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">m</span> <span class="ace_keyword">in</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span>: <span class="ace_identifier">Xt</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">m</span>.<span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Xt</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">return</span> <span class="ace_identifier">Xt</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">delta</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Update dLdW and dLdW0</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Note reversed list of modules</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">m</span> <span class="ace_keyword">in</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span><span class="ace_paren ace_lparen">[</span>::<span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">]</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Note that delta can refer to dLdA or dLdZ over the</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_comment"># course of the for loop, depending on the module m</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">delta</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">m</span>.<span class="ace_identifier">backward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">delta</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">sgd_step</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">lrate</span><span class="ace_paren ace_rparen">)</span>:  <span class="ace_comment"># Gradient descent step</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">for</span> <span class="ace_identifier">m</span> <span class="ace_keyword">in</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span>: <span class="ace_identifier">m</span>.<span class="ace_identifier">sgd_step</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">lrate</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"></div><div class="ace_line" style="height:19px">    <span class="ace_keyword">def</span> <span class="ace_identifier">print_accuracy</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>, <span class="ace_identifier">it</span>, <span class="ace_identifier">X</span>, <span class="ace_identifier">Y</span>, <span class="ace_identifier">cur_loss</span>, <span class="ace_identifier">every</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">250</span><span class="ace_paren ace_rparen">)</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># Utility method to print accuracy on full dataset, should</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># improve over time when doing SGD. Also prints current loss,</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># which should decrease over time. Call this on each iteration</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_comment"># of SGD!</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">it</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_identifier">every</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">1</span>:</div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">cf</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">self</span>.<span class="ace_identifier">modules</span><span class="ace_paren ace_lparen">[</span><span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">]</span>.<span class="ace_identifier">class_fun</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">acc</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">mean</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">cf</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">self</span>.<span class="ace_identifier">forward</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">X</span><span class="ace_paren ace_rparen">))</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_identifier">cf</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">Y</span><span class="ace_paren ace_rparen">))</span></div><div class="ace_line" style="height:19px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'Iteration ='</span>, <span class="ace_identifier">it</span>, <span class="ace_string">'</span><span class="ace_constant ace_language ace_escape">\t</span><span class="ace_string">Acc ='</span>, <span class="ace_identifier">acc</span>, <span class="ace_string">'</span><span class="ace_constant ace_language ace_escape">\t</span><span class="ace_string">Loss ='</span>, <span class="ace_identifier">cur_loss</span>, <span class="ace_identifier">flush</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span></div><div class="ace_line" style="height:19px"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 1387px; width: 9.6px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 17px; bottom: 12px;"><div class="ace_scrollbar-inner" style="width: 17px; height: 2793px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="height: 17px; left: 55px; right: 12px;"><div class="ace_scrollbar-inner" style="height: 17px; width: 834px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div>
<input id="network" name="network" type="hidden" value="import numpy as np
#import modules_disp as disp
#from expected_results import *

def cv(value_list):
    return np.transpose(rv(value_list))

def rv(value_list):
    return np.array([value_list])



class Module:
    def sgd_step(self, lrate): pass  # For modules w/o weights


# Linear modules
#
# Each linear module has a forward method that takes in a batch of
# activations A (from the previous layer) and returns
# a batch of pre-activations Z.
#
# Each linear module has a backward method that takes in dLdZ and
# returns dLdA. This module also computes and stores dLdW and dLdW0,
# the gradients with respect to the weights.
class Linear(Module):
    def __init__(self, m, n):
        self.m, self.n = (m, n)  # (in size, out size)
        self.W0 = np.zeros([self.n, 1])  # (n x 1)
        self.W = np.random.normal(0, 1.0 * m ** (-.5), [m, n])  # (m x n)

    def forward(self, A):
        self.A = A   # (m x b)  Hint: make sure you understand what b stands for
        return self.W.T@A + self.W0 # Your code (n x b)

    def backward(self, dLdZ):  # dLdZ is (n x b), uses stored self.A
        self.dLdW  =  self.A@dLdZ.T
        self.dLdW0 =  cv(np.sum(dLdZ,axis=1)) #.reshape(-1,1)
        return self.W@dLdZ # return dLdA

    def sgd_step(self, lrate):  # Gradient descent step
        self.W  = self.W  -lrate * self.dLdW
        self.W0 = self.W0 -lrate * self.dLdW0


# Activation modules
#
# Each activation module has a forward method that takes in a batch of
# pre-activations Z and returns a batch of activations A. b is the size of minibatch.
#
# Each activation module has a backward method that takes in dLdA and
# returns dLdZ, with the exception of SoftMax, where we assume dLdZ is
# passed in.
class Tanh(Module):  # Layer activation
    def forward(self, Z):
        self.A = np.tanh(Z)
        self.Z = Z
        return self.A

# https://socratic.org/questions/what-is-the-derivative-of-tanh-x
    def backward(self, dLdA):  # Uses stored self.A
        return dLdA*(1-np.tanh(self.Z)**2) # Your code: return dLdZ (n, b)


class ReLU(Module):  # Layer activation
    def forward(self, Z):
        self.A = np.maximum(0,Z)  # Your code: (n, b)
        return self.A

    def backward(self, dLdA):  # uses stored self.A
        dAdZ=np.where(self.A<=0.,0.,1.)
        return dLdA*dAdZ  # Your code: return dLdZ (n, b)


class SoftMax(Module):  # Output activation
    def forward(self, Z):
        return np.exp(Z)/np.sum(np.exp(Z),axis=0) # Your code: (n, b)

    def backward(self, dLdZ):  # Assume that dLdZ is passed in
        return dLdZ

    def class_fun(self, Ypred):  # Return class indices
        return np.argmax(Ypred,axis=0)  # Your code: (1, b)


# Loss modules
#
# Each loss module has a forward method that takes in a batch of
# predictions Ypred (from the previous layer) and labels Y and returns
# a scalar loss value.
#
# The NLL module has a backward method that returns dLdZ, the gradient
# with respect to the preactivation to SoftMax (note: not the
# activation!), since we are always pairing SoftMax activation with
# NLL loss
class NLL(Module):  # Loss
    def forward(self, Ypred, Y):
        self.Ypred = Ypred
        self.Y = Y
        return -np.sum(np.log(Ypred) * Y)  # Your code: return loss (scalar)

    def backward(self):  # Use stored self.Ypred, self.Y
        return self.Ypred -self.Y # Your code (n, b)


# Neural Network implementation
class Sequential:
    def __init__(self, modules, loss):  # List of modules, loss module
        self.modules = modules
        self.loss = loss
        
    def sgd(self, X, Y, iters=100, lrate=0.005):  # Train
        D, N = X.shape
        for it in range(iters):
            i=np.random.randint(N)
            X_i=cv(X[:,i]) #.reshape(-1,1)
            Y_i=cv(Y[:,i]) #.reshape(-1,1)
            Ypred=self.forward(X_i)
            #cur_loss=self.loss.forward(Ypred,Y_i)
            self.backward(Ypred-Y_i)
            self.sgd_step(lrate)


    def forward(self, Xt):  # Compute Ypred
        for m in self.modules: Xt = m.forward(Xt)
        return Xt

    def backward(self, delta):  # Update dLdW and dLdW0
        # Note reversed list of modules
        for m in self.modules[::-1]:
            # Note that delta can refer to dLdA or dLdZ over the
            # course of the for loop, depending on the module m
            delta = m.backward(delta)

    def sgd_step(self, lrate):  # Gradient descent step
        for m in self.modules: m.sgd_step(lrate)

    def print_accuracy(self, it, X, Y, cur_loss, every=250):
        # Utility method to print accuracy on full dataset, should
        # improve over time when doing SGD. Also prints current loss,
        # which should decrease over time. Call this on each iteration
        # of SGD!
        if it % every == 1:
            cf = self.modules[-1].class_fun
            acc = np.mean(cf(self.forward(X)) == cf(Y))
            print('Iteration =', it, '\tAcc =', acc, '\tLoss =', cur_loss, flush=True)
">
<input id="network_log" name="network_log" type="hidden">
<script type="text/javascript">
    var lognetwork = new Array();
    var editornetwork = ace.edit("editornetwork");
    editornetwork.setTheme("ace/theme/textmate");
    editornetwork.getSession().setMode("ace/mode/python");
    editornetwork.setShowFoldWidgets(false);
    editornetwork.setValue("import numpy as np\n#import modules_disp as disp\n#from expected_results import *\n\ndef cv(value_list):\n    return np.transpose(rv(value_list))\n\ndef rv(value_list):\n    return np.array([value_list])\n\n\n\nclass Module:\n    def sgd_step(self, lrate): pass  # For modules w/o weights\n\n\n# Linear modules\n#\n# Each linear module has a forward method that takes in a batch of\n# activations A (from the previous layer) and returns\n# a batch of pre-activations Z.\n#\n# Each linear module has a backward method that takes in dLdZ and\n# returns dLdA. This module also computes and stores dLdW and dLdW0,\n# the gradients with respect to the weights.\nclass Linear(Module):\n    def __init__(self, m, n):\n        self.m, self.n = (m, n)  # (in size, out size)\n        self.W0 = np.zeros([self.n, 1])  # (n x 1)\n        self.W = np.random.normal(0, 1.0 * m ** (-.5), [m, n])  # (m x n)\n\n    def forward(self, A):\n        self.A = A   # (m x b)  Hint: make sure you understand what b stands for\n        return self.W.T@A + self.W0 # Your code (n x b)\n\n    def backward(self, dLdZ):  # dLdZ is (n x b), uses stored self.A\n        self.dLdW  =  self.A@dLdZ.T\n        self.dLdW0 =  cv(np.sum(dLdZ,axis=1)) #.reshape(-1,1)\n        return self.W@dLdZ # return dLdA\n\n    def sgd_step(self, lrate):  # Gradient descent step\n        self.W  = self.W  -lrate * self.dLdW\n        self.W0 = self.W0 -lrate * self.dLdW0\n\n\n# Activation modules\n#\n# Each activation module has a forward method that takes in a batch of\n# pre-activations Z and returns a batch of activations A. b is the size of minibatch.\n#\n# Each activation module has a backward method that takes in dLdA and\n# returns dLdZ, with the exception of SoftMax, where we assume dLdZ is\n# passed in.\nclass Tanh(Module):  # Layer activation\n    def forward(self, Z):\n        self.A = np.tanh(Z)\n        self.Z = Z\n        return self.A\n\n# https://socratic.org/questions/what-is-the-derivative-of-tanh-x\n    def backward(self, dLdA):  # Uses stored self.A\n        return dLdA*(1-np.tanh(self.Z)**2) # Your code: return dLdZ (n, b)\n\n\nclass ReLU(Module):  # Layer activation\n    def forward(self, Z):\n        self.A = np.maximum(0,Z)  # Your code: (n, b)\n        return self.A\n\n    def backward(self, dLdA):  # uses stored self.A\n        dAdZ=np.where(self.A<=0.,0.,1.)\n        return dLdA*dAdZ  # Your code: return dLdZ (n, b)\n\n\nclass SoftMax(Module):  # Output activation\n    def forward(self, Z):\n        return np.exp(Z)/np.sum(np.exp(Z),axis=0) # Your code: (n, b)\n\n    def backward(self, dLdZ):  # Assume that dLdZ is passed in\n        return dLdZ\n\n    def class_fun(self, Ypred):  # Return class indices\n        return np.argmax(Ypred,axis=0)  # Your code: (1, b)\n\n\n# Loss modules\n#\n# Each loss module has a forward method that takes in a batch of\n# predictions Ypred (from the previous layer) and labels Y and returns\n# a scalar loss value.\n#\n# The NLL module has a backward method that returns dLdZ, the gradient\n# with respect to the preactivation to SoftMax (note: not the\n# activation!), since we are always pairing SoftMax activation with\n# NLL loss\nclass NLL(Module):  # Loss\n    def forward(self, Ypred, Y):\n        self.Ypred = Ypred\n        self.Y = Y\n        return -np.sum(np.log(Ypred) * Y)  # Your code: return loss (scalar)\n\n    def backward(self):  # Use stored self.Ypred, self.Y\n        return self.Ypred -self.Y # Your code (n, b)\n\n\n# Neural Network implementation\nclass Sequential:\n    def __init__(self, modules, loss):  # List of modules, loss module\n        self.modules = modules\n        self.loss = loss\n        \n    def sgd(self, X, Y, iters=100, lrate=0.005):  # Train\n        D, N = X.shape\n        for it in range(iters):\n            i=np.random.randint(N)\n            X_i=cv(X[:,i]) #.reshape(-1,1)\n            Y_i=cv(Y[:,i]) #.reshape(-1,1)\n            Ypred=self.forward(X_i)\n            #cur_loss=self.loss.forward(Ypred,Y_i)\n            self.backward(Ypred-Y_i)\n            self.sgd_step(lrate)\n\n\n    def forward(self, Xt):  # Compute Ypred\n        for m in self.modules: Xt = m.forward(Xt)\n        return Xt\n\n    def backward(self, delta):  # Update dLdW and dLdW0\n        # Note reversed list of modules\n        for m in self.modules[::-1]:\n            # Note that delta can refer to dLdA or dLdZ over the\n            # course of the for loop, depending on the module m\n            delta = m.backward(delta)\n\n    def sgd_step(self, lrate):  # Gradient descent step\n        for m in self.modules: m.sgd_step(lrate)\n\n    def print_accuracy(self, it, X, Y, cur_loss, every=250):\n        # Utility method to print accuracy on full dataset, should\n        # improve over time when doing SGD. Also prints current loss,\n        # which should decrease over time. Call this on each iteration\n        # of SGD!\n        if it % every == 1:\n            cf = self.modules[-1].class_fun\n            acc = np.mean(cf(self.forward(X)) == cf(Y))\n            print('Iteration =', it, '\\tAcc =', acc, '\\tLoss =', cur_loss, flush=True)\n")
    document.getElementById("network").value = editornetwork.getValue();
    editornetwork.on("change",function(e){
        editornetwork.getSession().setUseSoftTabs(true);
        document.getElementById("network").value = editornetwork.getValue();
    });
    editornetwork.clearSelection()
    editornetwork.getSession().setUseSoftTabs(true);
    editornetwork.on("paste",function(txt){editornetwork.getSession().setUseSoftTabs(false);});
    editornetwork.getSession().setTabSize(4);
    editornetwork.setFontSize("16px");
    document.getElementById("containernetwork").style.height = "1400px";
    document.getElementById("editornetwork").style.height = "1400px";
    editornetwork.resize(true);
</script>
</div><div>
<span id="network_buttons">
<button class="check btn btn-catsoop" id="network_check" onclick="catsoop.check('network');" style="margin-top: 10px;">Run Code</button>
<button class="submit btn btn-catsoop" id="network_submit" onclick="catsoop.submit('network');" style="margin-top: 10px;">Submit</button>
<button class="viewanswer btn btn-catsoop" id="network_viewanswer" onclick="catsoop.viewanswer('network');" style="margin-top: 10px;">View Answer</button></span><span id="network_queue_buttons"> <button class="btn btn-catsoop" onclick="!queue.get('location') ?
catsoop.modal(
    &quot;Enter Table Number&quot;,
    &quot;Please enter your table number:&quot;,
    true,
    true).then(function(text) {
        queue.set('location', text);
        queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'network',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2',
  },
})

        queue.set('_visible', true);
    }) : (queue.add('help', {
  location: queue.get('location'),
  assignment: {
    name: 'network',
    page: catsoop.this_path,
    path: catsoop.path_info,
    display_name: 'Tutor Question 1 in Section 2',
  },
})
, queue.set('_visible', true))" style="margin-top: 10px;">Ask for Help</button></span>
<span id="network_loading_wrapper">
<span id="network_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="></span>
</span>
<span id="network_score_display"><span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span></span>
<div class="nsubmits_left" id="network_nsubmits_left"><i>You have infinitely many submissions remaining.</i></div></div>
<div id="network_solution_container">
<div id="network_solution">
</div>
<div id="network_solution_explanation">
</div>
</div>
<div id="network_message">
<script type="text/javascript">document.getElementById("network_score_display").innerHTML = '<span style="color:rgb(0,200,0);font-weight:bolder;">100.00%</span>';</script>
<br>&nbsp;Your score on your most recent submission was: 100.00%
<br><button onclick="if(this.nextSibling.style.display === 'none'){this.nextSibling.style.display = 'block';}else{this.nextSibling.style.display = 'none';}">Show/Hide Detailed Results</button><div class="response" id="network_result_showhide" style="display:none"><h2>Test Results:</h2>
<center><h3>Test 01</h3>
<i></i></center><p></p>
The test case was:<br>
<p><tt>#Your Code Here<br>ans=nn_tanh_test()</tt></p>
<p>Our solution produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2473733761848262, 0.2829538808226157, 0.6924193292712828], [1.5845507770278007, 1.320562932207846, -0.6901721567010647], [-8.47337764291184e-12, 2.6227368810847106e-09, 0.00017353185263155828]], [[0.544808855557535, -0.08366117689965663], [-0.06331837550937104, 0.24078409926389266], [0.08677202043839037, 0.8360167748667923], [-0.0037249480614718, 0.0037249480614718]]]</tt></font></p>
<p>Your submission produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2473733761848262, 0.2829538808226157, 0.6924193292712828], [1.5845507770278007, 1.320562932207846, -0.6901721567010647], [-8.47337764291184e-12, 2.6227368810847106e-09, 0.00017353185263155828]], [[0.544808855557535, -0.08366117689965663], [-0.06331837550937104, 0.24078409926389266], [0.08677202043839037, 0.8360167748667923], [-0.0037249480614718, 0.0037249480614718]]]</tt></font><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAABQVBMVEUAAAAGDQAAAAAAAAAAAAAAAAAAAACGqlBIfBNciiZGeg9Eeg5Feg5Gew9CdgpCdgxDehJvmDN1nj9plTVWhRtOgRlMfxZjkS5Geg9EeA5Geg5HfBBHew5GeQ5Cdg1CeAxDegtHgACVtmV+pURPgBp4oEBEeQx+o0p8oklFeg5YiCJIfRFEdQ5GehBHeg9CdwtEdQxEeg5Fdw5DeQ1Eegs2YQlCdwpCeAxDeQ0PHgBGdA9AdgkAAAAAAAARIgChwGKPs0qjwXKStUyFqD6CqDfJ3p+91Ji00XqlwmypyGihwGiauluWtlicwFKXulGTuEmMr0WOs0OKr0CGrDuEqjrR46zC2Ji+1ZC804640oK1z4CxzHywynqsx3enw3WYuWidvF+fwlqgxFePsFWSs1KIrE2Wu0uOr0qGqkeCpj50nDHRgoCJAAAAP3RSTlMABA0HEgoQ/ff17+jbxi8nDvz39vb29fTy7dPQoJeLVRUJ/f39+vn49/f118jAvrKWcW9jWllJQjkiIRwZFg8RajNxAAAA+klEQVQY06XQ1bLCMBAGYNJCHXfnuLtrFXc5gru+/wMQhhZouWRvMvNt/kx2dbvUC+V/3tY9OhZzX5i0HDqNxn/aRo2aXb/JXtR+p2HjfjUb5xmg1kfyL9v9d76q1UK1kqPaSWAFy1TQVs+zvCci4wd9fA8PE9HM5Rvkg5JlcJ68iuh8OFtkcb/ywrUtlUscUTfniaKQIlaj0AdsoZTuH2aEUsceXM/AuNNcmcsIZW7otWwsIuCacBVJqgycYdWPwx7rWJQKVu0y3n0OUZyemVUIAPp9S8wcIQRBDCgAsqIGBNM/eS/fPr/02KKx5IXDBixsfV2OwCYERebVjyGAvqhE3QAAAABJRU5ErkJggg=="></p>
<p></p><hr><p></p>
<center><h3>Test 02</h3>
<i></i></center><p></p>
The test case was:<br>
<p><tt>#Your Code Here<br>ans=nn_relu_test()</tt></p>
<p>Our solution produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2421914999646917, 0.2851239946607419, 0.6905003767490479], [1.5695659964519526, 1.3273884281993562, -0.6920877418422037], [-0.0027754917572235106, 0.001212351486908601, -0.0005239629389906042]], [[0.501769700845158, -0.040622022187279644], [-0.09260786974986723, 0.27007359350438886], [0.08364438851530624, 0.8391444067898763], [-0.004252310922204504, 0.004252310922204505]]]</tt></font></p>
<p>Your submission produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>[[[1.2421914999646917, 0.2851239946607419, 0.6905003767490479], [1.5695659964519526, 1.3273884281993562, -0.6920877418422037], [-0.0027754917572235106, 0.001212351486908601, -0.0005239629389906042]], [[0.501769700845158, -0.040622022187279644], [-0.09260786974986723, 0.27007359350438886], [0.08364438851530624, 0.8391444067898763], [-0.004252310922204504, 0.004252310922204505]]]</tt></font><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAABQVBMVEUAAAAGDQAAAAAAAAAAAAAAAAAAAACGqlBIfBNciiZGeg9Eeg5Feg5Gew9CdgpCdgxDehJvmDN1nj9plTVWhRtOgRlMfxZjkS5Geg9EeA5Geg5HfBBHew5GeQ5Cdg1CeAxDegtHgACVtmV+pURPgBp4oEBEeQx+o0p8oklFeg5YiCJIfRFEdQ5GehBHeg9CdwtEdQxEeg5Fdw5DeQ1Eegs2YQlCdwpCeAxDeQ0PHgBGdA9AdgkAAAAAAAARIgChwGKPs0qjwXKStUyFqD6CqDfJ3p+91Ji00XqlwmypyGihwGiauluWtlicwFKXulGTuEmMr0WOs0OKr0CGrDuEqjrR46zC2Ji+1ZC804640oK1z4CxzHywynqsx3enw3WYuWidvF+fwlqgxFePsFWSs1KIrE2Wu0uOr0qGqkeCpj50nDHRgoCJAAAAP3RSTlMABA0HEgoQ/ff17+jbxi8nDvz39vb29fTy7dPQoJeLVRUJ/f39+vn49/f118jAvrKWcW9jWllJQjkiIRwZFg8RajNxAAAA+klEQVQY06XQ1bLCMBAGYNJCHXfnuLtrFXc5gru+/wMQhhZouWRvMvNt/kx2dbvUC+V/3tY9OhZzX5i0HDqNxn/aRo2aXb/JXtR+p2HjfjUb5xmg1kfyL9v9d76q1UK1kqPaSWAFy1TQVs+zvCci4wd9fA8PE9HM5Rvkg5JlcJ68iuh8OFtkcb/ywrUtlUscUTfniaKQIlaj0AdsoZTuH2aEUsceXM/AuNNcmcsIZW7otWwsIuCacBVJqgycYdWPwx7rWJQKVu0y3n0OUZyemVUIAPp9S8wcIQRBDCgAsqIGBNM/eS/fPr/02KKx5IXDBixsfV2OwCYERebVjyGAvqhE3QAAAABJRU5ErkJggg=="></p>
<p></p><hr><p></p>
<center><h3>Test 03</h3>
<i></i></center><p></p>
The test case was:<br>
<p><tt>#Your Code Here<br>ans=nn_pred_test()</tt></p>
<p>Our solution produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>([0, 0, 0, 0], [8.56575061835767])</tt></font></p>
<p>Your submission produced the following value for <tt>ans</tt>:
<br><font color="blue"><tt>([0, 0, 0, 0], [8.5657506183576704])</tt></font><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAABQVBMVEUAAAAGDQAAAAAAAAAAAAAAAAAAAACGqlBIfBNciiZGeg9Eeg5Feg5Gew9CdgpCdgxDehJvmDN1nj9plTVWhRtOgRlMfxZjkS5Geg9EeA5Geg5HfBBHew5GeQ5Cdg1CeAxDegtHgACVtmV+pURPgBp4oEBEeQx+o0p8oklFeg5YiCJIfRFEdQ5GehBHeg9CdwtEdQxEeg5Fdw5DeQ1Eegs2YQlCdwpCeAxDeQ0PHgBGdA9AdgkAAAAAAAARIgChwGKPs0qjwXKStUyFqD6CqDfJ3p+91Ji00XqlwmypyGihwGiauluWtlicwFKXulGTuEmMr0WOs0OKr0CGrDuEqjrR46zC2Ji+1ZC804640oK1z4CxzHywynqsx3enw3WYuWidvF+fwlqgxFePsFWSs1KIrE2Wu0uOr0qGqkeCpj50nDHRgoCJAAAAP3RSTlMABA0HEgoQ/ff17+jbxi8nDvz39vb29fTy7dPQoJeLVRUJ/f39+vn49/f118jAvrKWcW9jWllJQjkiIRwZFg8RajNxAAAA+klEQVQY06XQ1bLCMBAGYNJCHXfnuLtrFXc5gru+/wMQhhZouWRvMvNt/kx2dbvUC+V/3tY9OhZzX5i0HDqNxn/aRo2aXb/JXtR+p2HjfjUb5xmg1kfyL9v9d76q1UK1kqPaSWAFy1TQVs+zvCci4wd9fA8PE9HM5Rvkg5JlcJ68iuh8OFtkcb/ywrUtlUscUTfniaKQIlaj0AdsoZTuH2aEUsceXM/AuNNcmcsIZW7otWwsIuCacBVJqgycYdWPwx7rWJQKVu0y3n0OUZyemVUIAPp9S8wcIQRBDCgAsqIGBNM/eS/fPr/02KKx5IXDBixsfV2OwCYERebVjyGAvqhE3QAAAABJRU5ErkJggg=="></p>
</div><br><font color="blue">Hint: these test cases are provided in the code distribution to help you debug</font></div>
</div>
<!--END question network -->
<p><script src="/queue/fall18/js/queue.js"></script>
<script>
    catsoop.plugins.queue = {
        url_root: '/queue/fall18/',
        is_staff: false,
        container: "body",
        view: 'student_popup',
        room: 'default',
    };
    </script>
<script src="https://introml_oll.odl.mit.edu/cat-soop/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
catsoop.all_questions = ['q000000', 'q000001', 'q000002', 'network'];
catsoop.username = 'AlexandrParkhomenko';
catsoop.api_token = 'ou3PvadLMR1zwQVIhEQLlWt6elMqlxph2gVU1xhXjyyRUXW4QMJ8O3E5H1HxxhLq0PFguf';
catsoop.this_path = 'https://introml_oll.odl.mit.edu/cat-soop/6.036/homework/hw07';
catsoop.path_info = ['6.036', 'homework', 'hw07'];
catsoop.course = '6.036';
catsoop.url_root = 'https://introml_oll.odl.mit.edu/cat-soop';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";
</script></p>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
      This page was last updated on Saturday January 18, 2020 at 01:16:11 PM (revision <code>043d9ae</code>).<br>&nbsp;<br>Sec None Release 1900-01-01 00:00:00 Due 9999-12-31 23:59:59<br><script type="text/javascript">document.getElementById("cs_header").style.display="none";</script>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v14.0.0.dev144.<br>
      CAT-SOOP is <a href="http://www.fsf.org/about/what-is-free-software" target="_blank">free/libre software</a>, available under the terms<br>of the <a href="https://introml_oll.odl.mit.edu/cat-soop/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://introml_oll.odl.mit.edu/cat-soop/_util/source.zip?course=6.036" target="_blank">Download Source Code</a><br>
<a href="https://introml_oll.odl.mit.edu/cat-soop/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</footer>



<div style="clear: both; display: block;"></div></body></html>
